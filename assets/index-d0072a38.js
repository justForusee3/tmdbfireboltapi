var Ni=Object.defineProperty;var Mi=(r,t,e)=>t in r?Ni(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var f=(r,t,e)=>(Mi(r,typeof t!="symbol"?t+"":t,e),e);import{a as F,E as et,g as zi,m as fr,b as wt,i as zr,c as Mt,d as Fe,T as Dr,e as Di,f as Pi,h as Oi,j as vn,S as pr,k as Pr,B as Bi,l as $i,n as Yi,o as En,W as gr,p as ji,q as Ui,C as Wi}from"./CoreExtension-3fd98810.js";function tc(){import.meta.url,import("_").catch(()=>1);async function*r(){}}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const Or=(r,t)=>r===t,tn=Symbol("solid-proxy"),Xi=Symbol("solid-track"),nn={equals:Or};let Br=Xr;const Ce=1,rn=2,$r={owned:null,cleanups:null,context:null,owner:null},kn={};var O=null;let Ln=null,$=null,ae=null,Le=null,bn=0;function ht(r,t){const e=$,n=O,i=r.length===0,o=t===void 0?n:t,s=i?$r:{owned:null,cleanups:null,context:o?o.context:null,owner:o},a=i?r:()=>r(()=>ce(()=>_n(s)));O=s,$=null;try{return Ae(a,!0)}finally{$=e,O=n}}function Y(r,t){t=t?Object.assign({},nn,t):nn;const e={value:r,observers:null,observerSlots:null,comparator:t.equals||void 0},n=i=>(typeof i=="function"&&(i=i(e.value)),Wr(e,i));return[Ur.bind(e),n]}function Yn(r,t,e){const n=Dt(r,t,!0,Ce);tt(n)}function Ee(r,t,e){const n=Dt(r,t,!1,Ce);tt(n)}function _e(r,t,e){Br=Zi;const n=Dt(r,t,!1,Ce);(!e||!e.render)&&(n.user=!0),Le?Le.push(n):tt(n)}function ie(r,t,e){e=e?Object.assign({},nn,e):nn;const n=Dt(r,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=e.equals||void 0,tt(n),Ur.bind(n)}function Hi(r){return r&&typeof r=="object"&&"then"in r}function Je(r,t,e){let n,i,o;arguments.length===2&&typeof t=="object"||arguments.length===1?(n=!0,i=r,o=t||{}):(n=r,i=t,o=e||{});let s=null,a=kn,c=!1,u="initialValue"in o,h=typeof n=="function"&&ie(n);const d=new Set,[v,b]=(o.storage||Y)(o.initialValue),[g,x]=Y(void 0),[_,C]=Y(void 0,{equals:!1}),[m,y]=Y(u?"ready":"unresolved");function p(S,w,R,A){return s===S&&(s=null,A!==void 0&&(u=!0),(S===a||w===a)&&o.onHydrated&&queueMicrotask(()=>o.onHydrated(A,{value:w})),a=kn,T(w,R)),w}function T(S,w){Ae(()=>{w===void 0&&b(()=>S),y(w!==void 0?"errored":u?"ready":"unresolved"),x(w);for(const R of d.keys())R.decrement();d.clear()},!1)}function I(){const S=Ji,w=v(),R=g();if(R!==void 0&&!s)throw R;return $&&!$.user&&S&&Yn(()=>{_(),s&&(S.resolved||d.has(S)||(S.increment(),d.add(S)))}),w}function E(S=!0){if(S!==!1&&c)return;c=!1;const w=h?h():n;if(w==null||w===!1){p(s,ce(v));return}const R=a!==kn?a:ce(()=>i(w,{value:v(),refetching:S}));return Hi(R)?(s=R,"value"in R?(R.status==="success"?p(s,R.value,void 0,w):p(s,void 0,void 0,w),R):(c=!0,queueMicrotask(()=>c=!1),Ae(()=>{y(u?"refreshing":"pending"),C()},!1),R.then(A=>p(R,A,void 0,w),A=>p(R,void 0,Gr(A),w)))):(p(s,R,void 0,w),R)}return Object.defineProperties(I,{state:{get:()=>m()},error:{get:()=>g()},loading:{get(){const S=m();return S==="pending"||S==="refreshing"}},latest:{get(){if(!u)return I();const S=g();if(S&&!s)throw S;return v()}}}),h?Yn(()=>E(!1)):E(!1),[I,{refetch:E,mutate:b}]}function Yr(r,t=Or,e){const n=new Map,i=Dt(o=>{const s=r();for(const[a,c]of n.entries())if(t(a,s)!==t(a,o))for(const u of c.values())u.state=Ce,u.pure?ae.push(u):Le.push(u);return s},void 0,!0,Ce);return tt(i),o=>{const s=$;if(s){let a;(a=n.get(o))?a.add(s):n.set(o,a=new Set([s])),ze(()=>{a.delete(s),!a.size&&n.delete(o)})}return t(o,i.value)}}function Gi(r){return Ae(r,!1)}function ce(r){if($===null)return r();const t=$;$=null;try{return r()}finally{$=t}}function Pe(r,t,e){const n=Array.isArray(r);let i,o=e&&e.defer;return s=>{let a;if(n){a=Array(r.length);for(let u=0;u<r.length;u++)a[u]=r[u]()}else a=r();if(o){o=!1;return}const c=ce(()=>t(a,i,s));return i=a,c}}function zt(r){_e(()=>ce(r))}function ze(r){return O===null||(O.cleanups===null?O.cleanups=[r]:O.cleanups.push(r)),r}function wn(){return O}function Vi(r,t){const e=O,n=$;O=r,$=null;try{return Ae(t,!0)}catch(i){ir(i)}finally{O=e,$=n}}function Ki(r){const t=$,e=O;return Promise.resolve().then(()=>{$=t,O=e;let n;return Ae(r,!1),$=O=null,n?n.done:void 0})}function jr(r,t){const e=Symbol("context");return{id:e,Provider:eo(e),defaultValue:r}}function nr(r){return O&&O.context&&O.context[r.id]!==void 0?O.context[r.id]:r.defaultValue}function rr(r){const t=ie(r),e=ie(()=>jn(t()));return e.toArray=()=>{const n=e();return Array.isArray(n)?n:n!=null?[n]:[]},e}let Ji;function Ur(){if(this.sources&&this.state)if(this.state===Ce)tt(this);else{const r=ae;ae=null,Ae(()=>sn(this),!1),ae=r}if($){const r=this.observers?this.observers.length:0;$.sources?($.sources.push(this),$.sourceSlots.push(r)):($.sources=[this],$.sourceSlots=[r]),this.observers?(this.observers.push($),this.observerSlots.push($.sources.length-1)):(this.observers=[$],this.observerSlots=[$.sources.length-1])}return this.value}function Wr(r,t,e){let n=r.value;return(!r.comparator||!r.comparator(n,t))&&(r.value=t,r.observers&&r.observers.length&&Ae(()=>{for(let i=0;i<r.observers.length;i+=1){const o=r.observers[i],s=Ln&&Ln.running;s&&Ln.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?ae.push(o):Le.push(o),o.observers&&Hr(o)),s||(o.state=Ce)}if(ae.length>1e6)throw ae=[],new Error},!1)),t}function tt(r){if(!r.fn)return;_n(r);const t=bn;qi(r,r.value,t)}function qi(r,t,e){let n;const i=O,o=$;$=O=r;try{n=r.fn(t)}catch(s){return r.pure&&(r.state=Ce,r.owned&&r.owned.forEach(_n),r.owned=null),r.updatedAt=e+1,ir(s)}finally{$=o,O=i}(!r.updatedAt||r.updatedAt<=e)&&(r.updatedAt!=null&&"observers"in r?Wr(r,n):r.value=n,r.updatedAt=e)}function Dt(r,t,e,n=Ce,i){const o={fn:r,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:O,context:O?O.context:null,pure:e};return O===null||O!==$r&&(O.owned?O.owned.push(o):O.owned=[o]),o}function on(r){if(r.state===0)return;if(r.state===rn)return sn(r);if(r.suspense&&ce(r.suspense.inFallback))return r.suspense.effects.push(r);const t=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<bn);)r.state&&t.push(r);for(let e=t.length-1;e>=0;e--)if(r=t[e],r.state===Ce)tt(r);else if(r.state===rn){const n=ae;ae=null,Ae(()=>sn(r,t[0]),!1),ae=n}}function Ae(r,t){if(ae)return r();let e=!1;t||(ae=[]),Le?e=!0:Le=[],bn++;try{const n=r();return Qi(e),n}catch(n){e||(Le=null),ae=null,ir(n)}}function Qi(r){if(ae&&(Xr(ae),ae=null),r)return;const t=Le;Le=null,t.length&&Ae(()=>Br(t),!1)}function Xr(r){for(let t=0;t<r.length;t++)on(r[t])}function Zi(r){let t,e=0;for(t=0;t<r.length;t++){const n=r[t];n.user?r[e++]=n:on(n)}for(t=0;t<e;t++)on(r[t])}function sn(r,t){r.state=0;for(let e=0;e<r.sources.length;e+=1){const n=r.sources[e];if(n.sources){const i=n.state;i===Ce?n!==t&&(!n.updatedAt||n.updatedAt<bn)&&on(n):i===rn&&sn(n,t)}}}function Hr(r){for(let t=0;t<r.observers.length;t+=1){const e=r.observers[t];e.state||(e.state=rn,e.pure?ae.push(e):Le.push(e),e.observers&&Hr(e))}}function _n(r){let t;if(r.sources)for(;r.sources.length;){const e=r.sources.pop(),n=r.sourceSlots.pop(),i=e.observers;if(i&&i.length){const o=i.pop(),s=e.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,e.observerSlots[n]=s)}}if(r.owned){for(t=r.owned.length-1;t>=0;t--)_n(r.owned[t]);r.owned=null}if(r.cleanups){for(t=r.cleanups.length-1;t>=0;t--)r.cleanups[t]();r.cleanups=null}r.state=0}function Gr(r){return r instanceof Error?r:new Error(typeof r=="string"?r:"Unknown error",{cause:r})}function ir(r,t=O){throw Gr(r)}function jn(r){if(typeof r=="function"&&!r.length)return jn(r());if(Array.isArray(r)){const t=[];for(let e=0;e<r.length;e++){const n=jn(r[e]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return r}function eo(r,t){return function(n){let i;return Ee(()=>i=ce(()=>(O.context={...O.context,[r]:n.value},rr(()=>n.children))),void 0),i}}const to=Symbol("fallback");function mr(r){for(let t=0;t<r.length;t++)r[t]()}function no(r,t,e={}){let n=[],i=[],o=[],s=0,a=t.length>1?[]:null;return ze(()=>mr(o)),()=>{let c=r()||[],u,h;return c[Xi],ce(()=>{let v=c.length,b,g,x,_,C,m,y,p,T;if(v===0)s!==0&&(mr(o),o=[],n=[],i=[],s=0,a&&(a=[])),e.fallback&&(n=[to],i[0]=ht(I=>(o[0]=I,e.fallback())),s=1);else if(s===0){for(i=new Array(v),h=0;h<v;h++)n[h]=c[h],i[h]=ht(d);s=v}else{for(x=new Array(v),_=new Array(v),a&&(C=new Array(v)),m=0,y=Math.min(s,v);m<y&&n[m]===c[m];m++);for(y=s-1,p=v-1;y>=m&&p>=m&&n[y]===c[p];y--,p--)x[p]=i[y],_[p]=o[y],a&&(C[p]=a[y]);for(b=new Map,g=new Array(p+1),h=p;h>=m;h--)T=c[h],u=b.get(T),g[h]=u===void 0?-1:u,b.set(T,h);for(u=m;u<=y;u++)T=n[u],h=b.get(T),h!==void 0&&h!==-1?(x[h]=i[u],_[h]=o[u],a&&(C[h]=a[u]),h=g[h],b.set(T,h)):o[u]();for(h=m;h<v;h++)h in x?(i[h]=x[h],o[h]=_[h],a&&(a[h]=C[h],a[h](h))):i[h]=ht(d);i=i.slice(0,s=v),n=c.slice(0)}return i});function d(v){if(o[h]=v,a){const[b,g]=Y(h);return a[h]=g,t(c[h],b)}return t(c[h])}}}function Vr(r,t){return ce(()=>r(t||{}))}function jt(){return!0}const Un={get(r,t,e){return t===tn?e:r.get(t)},has(r,t){return t===tn?!0:r.has(t)},set:jt,deleteProperty:jt,getOwnPropertyDescriptor(r,t){return{configurable:!0,enumerable:!0,get(){return r.get(t)},set:jt,deleteProperty:jt}},ownKeys(r){return r.keys()}};function An(r){return(r=typeof r=="function"?r():r)?r:{}}function ro(){for(let r=0,t=this.length;r<t;++r){const e=this[r]();if(e!==void 0)return e}}function or(...r){let t=!1;for(let o=0;o<r.length;o++){const s=r[o];t=t||!!s&&tn in s,r[o]=typeof s=="function"?(t=!0,ie(s)):s}if(t)return new Proxy({get(o){for(let s=r.length-1;s>=0;s--){const a=An(r[s])[o];if(a!==void 0)return a}},has(o){for(let s=r.length-1;s>=0;s--)if(o in An(r[s]))return!0;return!1},keys(){const o=[];for(let s=0;s<r.length;s++)o.push(...Object.keys(An(r[s])));return[...new Set(o)]}},Un);const e={},n={},i=new Set;for(let o=r.length-1;o>=0;o--){const s=r[o];if(!s)continue;const a=Object.getOwnPropertyNames(s);for(let c=0,u=a.length;c<u;c++){const h=a[c];if(h==="__proto__"||h==="constructor")continue;const d=Object.getOwnPropertyDescriptor(s,h);if(!i.has(h))d.get?(i.add(h),Object.defineProperty(e,h,{enumerable:!0,configurable:!0,get:ro.bind(n[h]=[d.get.bind(s)])})):(d.value!==void 0&&i.add(h),e[h]=d.value);else{const v=n[h];v?d.get?v.push(d.get.bind(s)):d.value!==void 0&&v.push(()=>d.value):e[h]===void 0&&(e[h]=d.value)}}}return e}function io(r,...t){if(tn in r){const i=new Set(t.length>1?t.flat():t[0]),o=t.map(s=>new Proxy({get(a){return s.includes(a)?r[a]:void 0},has(a){return s.includes(a)&&a in r},keys(){return s.filter(a=>a in r)}},Un));return o.push(new Proxy({get(s){return i.has(s)?void 0:r[s]},has(s){return i.has(s)?!1:s in r},keys(){return Object.keys(r).filter(s=>!i.has(s))}},Un)),o}const e={},n=t.map(()=>({}));for(const i of Object.getOwnPropertyNames(r)){const o=Object.getOwnPropertyDescriptor(r,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let a=!1,c=0;for(const u of t)u.includes(i)&&(a=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;a||(s?e[i]=o.value:Object.defineProperty(e,i,o))}return[...n,e]}const oo=r=>"Stale read from <".concat(r,">.");function Sn(r){const t="fallback"in r&&{fallback:()=>r.fallback};return ie(no(()=>r.each,r.children,t||void 0))}function De(r){const t=r.keyed,e=ie(()=>r.when,void 0,{equals:(n,i)=>t?n===i:!n==!i});return ie(()=>{const n=e();if(n){const i=r.children;return typeof i=="function"&&i.length>0?ce(()=>i(t?n:()=>{if(!ce(e))throw oo("Show");return r.when})):i}return r.fallback},void 0,void 0)}const so=void 0,[an,Kr]=Y(null);class Jr{constructor(t){f(this,"releaseCallback");this.releaseCallback=t}}class ao extends Jr{constructor(e,n){var i,o;super(e);f(this,"textureMap",new Map);f(this,"zeroReferenceTextureSet",new Set);f(this,"options");this.options={textureCleanupIntervalMs:(i=n.textureCleanupIntervalMs)!=null?i:1e4,textureCleanupAgeThreadholdMs:(o=n.textureCleanupAgeThreadholdMs)!=null?o:6e4},setInterval(()=>{const s=Date.now(),a=this.options.textureCleanupAgeThreadholdMs;for(const c of this.zeroReferenceTextureSet)s-c.lastUpdate>a&&(this.releaseCallback(c.id),this.textureMap.delete(c.id),this.zeroReferenceTextureSet.delete(c))},this.options.textureCleanupIntervalMs)}registerTexture(e){var i;const n=(i=e.options)==null?void 0:i.id;if(F(n,"Texture must have an id to be registered"),!this.textureMap.has(n)){const o={id:n,nodeRefCount:0,lastUpdate:Date.now()};this.textureMap.set(n,o),this.zeroReferenceTextureSet.add(o)}}incrementTextureRefCount(e){var o;const n=(o=e.options)==null?void 0:o.id;F(n,"Texture must have an id to be registered");let i=this.textureMap.get(n);i||(this.registerTexture(e),i=this.textureMap.get(n)),F(i,"Texture must have been registered"),e.txType==="SubTexture"&&this.incrementTextureRefCount(e.props.texture),i.nodeRefCount++,i.lastUpdate=Date.now(),this.zeroReferenceTextureSet.has(i)&&this.zeroReferenceTextureSet.delete(i)}decrementTextureRefCount(e){var o;const n=(o=e.options)==null?void 0:o.id;F(n,"Texture must have an id to be registered");const i=this.textureMap.get(n);F(i,"Texture must have been registered"),i.nodeRefCount--,i.lastUpdate=Date.now(),i.nodeRefCount===0&&this.zeroReferenceTextureSet.add(i),e.txType==="SubTexture"&&this.decrementTextureRefCount(e.props.texture)}}class lo extends Jr{constructor(e){super(e);f(this,"registry");this.registry=new FinalizationRegistry(e)}registerTexture(e){var n,i;F((n=e.options)==null?void 0:n.id,"Texture must have an ID to be registered"),this.registry.register(e,(i=e.options)==null?void 0:i.id)}incrementTextureRefCount(){}decrementTextureRefCount(){}}class co extends et{constructor(e,n,i){var _,C;super();f(this,"root",null);f(this,"driver");f(this,"canvas");f(this,"settings");f(this,"nodes",new Map);f(this,"nextTextureId",1);f(this,"textureTracker");const o={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:(_=e.clearColor)!=null?_:0,coreExtensionModule:e.coreExtensionModule||null,experimental_FinalizationRegistryTextureUsageTracker:(C=e.experimental_FinalizationRegistryTextureUsageTracker)!=null?C:!1,textureCleanupOptions:e.textureCleanupOptions||{},fpsUpdateInterval:e.fpsUpdateInterval||0};this.settings=o;const{appWidth:s,appHeight:a,deviceLogicalPixelRatio:c,devicePhysicalPixelRatio:u}=o,h=m=>{this.driver.releaseTexture(m)},d=o.experimental_FinalizationRegistryTextureUsageTracker&&typeof FinalizationRegistry=="function";this.textureTracker=d?new lo(h):new ao(h,this.settings.textureCleanupOptions);const v=s*c,b=a*c;this.driver=i;const g=document.createElement("canvas");this.canvas=g,g.width=v*u,g.height=b*u,g.style.width="".concat(v,"px"),g.style.height="".concat(b,"px");let x;if(typeof n=="string"?x=document.getElementById(n):x=n,!x)throw new Error("Could not find target element");i.onCreateNode=m=>{this.nodes.set(m.id,m)},i.onBeforeDestroyNode=m=>{this.nodes.delete(m.id)},i.onFpsUpdate=m=>{this.emit("fpsUpdate",m)},x.appendChild(g)}async init(){await this.driver.init(this,this.settings,this.canvas),this.root=this.driver.getRootNode()}createNode(e){return this.driver.createNode(this.resolveNodeDefaults(e))}createTextNode(e){var n,i,o,s,a,c,u,h,d,v,b,g,x,_;return this.driver.createTextNode({...this.resolveNodeDefaults(e),text:(n=e.text)!=null?n:"",textRendererOverride:(i=e.textRendererOverride)!=null?i:null,fontSize:(o=e.fontSize)!=null?o:16,fontFamily:(s=e.fontFamily)!=null?s:"sans-serif",fontStyle:(a=e.fontStyle)!=null?a:"normal",fontWeight:(c=e.fontWeight)!=null?c:"normal",fontStretch:(u=e.fontStretch)!=null?u:"normal",textAlign:(h=e.textAlign)!=null?h:"left",contain:(d=e.contain)!=null?d:"none",scrollable:(v=e.scrollable)!=null?v:!1,scrollY:(b=e.scrollY)!=null?b:0,offsetY:(g=e.offsetY)!=null?g:0,letterSpacing:(x=e.letterSpacing)!=null?x:0,debug:(_=e.debug)!=null?_:{}})}resolveNodeDefaults(e){var c,u,h,d,v,b,g,x,_,C,m,y,p,T,I,E,S,w,R,A,L,M,U,X,oe,te,pe,Se,gt,Ot,Bt,We,Te,me,ne,j,Oe,ue,Be,$t,Yt,Xe,He,Ge,mt;const n=(c=e.color)!=null?c:4294967295,i=(d=(h=(u=e.colorTl)!=null?u:e.colorTop)!=null?h:e.colorLeft)!=null?d:n,o=(g=(b=(v=e.colorTr)!=null?v:e.colorTop)!=null?b:e.colorRight)!=null?g:n,s=(C=(_=(x=e.colorBl)!=null?x:e.colorBottom)!=null?_:e.colorLeft)!=null?C:n,a=(p=(y=(m=e.colorBr)!=null?m:e.colorBottom)!=null?y:e.colorRight)!=null?p:n;return{x:(T=e.x)!=null?T:0,y:(I=e.y)!=null?I:0,width:(E=e.width)!=null?E:0,height:(S=e.height)!=null?S:0,alpha:(w=e.alpha)!=null?w:1,clipping:(R=e.clipping)!=null?R:!1,color:n,colorTop:(A=e.colorTop)!=null?A:n,colorBottom:(L=e.colorBottom)!=null?L:n,colorLeft:(M=e.colorLeft)!=null?M:n,colorRight:(U=e.colorRight)!=null?U:n,colorBl:s,colorBr:a,colorTl:i,colorTr:o,zIndex:(X=e.zIndex)!=null?X:0,zIndexLocked:(oe=e.zIndexLocked)!=null?oe:0,parent:(te=e.parent)!=null?te:null,texture:(pe=e.texture)!=null?pe:null,shader:(Se=e.shader)!=null?Se:null,src:(gt=e.src)!=null?gt:"",scale:(Ot=e.scale)!=null?Ot:null,scaleX:(We=(Bt=e.scaleX)!=null?Bt:e.scale)!=null?We:1,scaleY:(me=(Te=e.scaleY)!=null?Te:e.scale)!=null?me:1,mount:(ne=e.mount)!=null?ne:0,mountX:(Oe=(j=e.mountX)!=null?j:e.mount)!=null?Oe:0,mountY:(Be=(ue=e.mountY)!=null?ue:e.mount)!=null?Be:0,pivot:($t=e.pivot)!=null?$t:.5,pivotX:(Xe=(Yt=e.pivotX)!=null?Yt:e.pivot)!=null?Xe:.5,pivotY:(Ge=(He=e.pivotY)!=null?He:e.pivot)!=null?Ge:.5,rotation:(mt=e.rotation)!=null?mt:0}}destroyNode(e){return this.driver.destroyNode(e)}createTexture(e,n,i){const o=this.nextTextureId++,s={descType:"texture",txType:e,props:n,options:{...i,id:o}};return this.textureTracker.registerTexture(s),s}createShader(e,n){return{descType:"shader",shType:e,props:n}}getNodeById(e){return this.nodes.get(e)||null}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}rerender(){throw new Error("Not implemented")}}class uo extends et{constructor(e,n,i){super();f(this,"node");f(this,"props");f(this,"settings");f(this,"propStartValues",{});f(this,"restoreValues",{});f(this,"progress",0);f(this,"timingFunction");f(this,"propsList");this.node=e,this.props=n,this.settings=i,this.propStartValues={},this.propsList=Object.keys(n),this.propsList.forEach(o=>{this.propStartValues[o]=e[o]}),this.timingFunction=o=>o,i.easing&&typeof i.easing=="string"&&(this.timingFunction=zi(i.easing))}reset(){this.progress=0,this.update(0)}restore(){this.reset(),Object.keys(this.props).forEach(e=>{this.node[e]=this.propStartValues[e]})}reverse(){this.progress=0,Object.keys(this.props).forEach(e=>{const n=this.props[e],i=this.propStartValues[e];this.props[e]=i,this.propStartValues[e]=n}),this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,n,i){return(this.timingFunction(e)||e)*(i-n)+n}update(e){const{duration:n,loop:i,easing:o,stopMethod:s}=this.settings;if(!n){this.emit("finished",{});return}if(this.progress+=e/n,this.progress>1&&(this.progress=i?0:1,s)){this.emit("finished",{});return}for(let a=0;a<this.propsList.length;a++){const c=this.propsList[a],u=this.props[c],h=this.propStartValues[c],d=u;if(c.indexOf("color")!==-1){if(h===d){this.node[c]=h;continue}if(o){const v=this.timingFunction(this.progress)||this.progress,b=fr(h,d,v);this.node[c]=b;continue}this.node[c]=fr(h,d,this.progress);continue}if(o){this.node[c]=this.applyEasing(this.progress,h,d);continue}this.node[c]=h+(d-h)*this.progress}this.progress===1&&this.emit("finished",{})}}class ho{constructor(t,e){f(this,"manager");f(this,"animation");f(this,"stoppedPromise",null);f(this,"stoppedResolve",null);f(this,"state");this.manager=t,this.animation=e,this.state="stopped"}start(){return this.makeStoppedPromise(),this.animation.once("finished",this.finished.bind(this)),this.manager.activeAnimations.has(this.animation)||this.manager.registerAnimation(this.animation),this.state="running",this}stop(){return this.manager.unregisterAnimation(this.animation),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null),this.animation.reset(),this.state="stopped",this}pause(){return this.manager.unregisterAnimation(this.animation),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){this.makeStoppedPromise();const t=this.stoppedPromise;return F(t),t}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(t=>{this.stoppedResolve=t}))}finished(){F(this.stoppedResolve);const{loop:t,stopMethod:e}=this.animation.settings;if(e==="reverse"){this.animation.reverse(),this.start();return}this.stoppedResolve(),this.stoppedResolve=null,!t&&this.manager.unregisterAnimation(this.animation)}}const J=0,q=3,le=6,G=1,Q=4,de=7,xe=2,ye=5,ve=8;class we{constructor(t){f(this,"data");t?(this.data=new Float32Array(9),this.data[J]=t[0],this.data[q]=t[3],this.data[le]=t[6],this.data[G]=t[1],this.data[Q]=t[4],this.data[de]=t[7],this.data[xe]=t[2],this.data[ye]=t[5],this.data[ve]=t[8]):this.data=new Float32Array(9)}static get temp(){return fo}static multiply(t,e,n){const i=t.data[J]*e.data[J]+t.data[q]*e.data[G]+t.data[le]*e.data[xe],o=t.data[J]*e.data[q]+t.data[q]*e.data[Q]+t.data[le]*e.data[ye],s=t.data[J]*e.data[le]+t.data[q]*e.data[de]+t.data[le]*e.data[ve],a=t.data[G]*e.data[J]+t.data[Q]*e.data[G]+t.data[de]*e.data[xe],c=t.data[G]*e.data[q]+t.data[Q]*e.data[Q]+t.data[de]*e.data[ye],u=t.data[G]*e.data[le]+t.data[Q]*e.data[de]+t.data[de]*e.data[ve],h=t.data[xe]*e.data[J]+t.data[ye]*e.data[G]+t.data[ve]*e.data[xe],d=t.data[xe]*e.data[q]+t.data[ye]*e.data[Q]+t.data[ve]*e.data[ye],v=t.data[xe]*e.data[le]+t.data[ye]*e.data[de]+t.data[ve]*e.data[ve];return n||(n=new we),n.data[J]=i,n.data[q]=o,n.data[le]=s,n.data[G]=a,n.data[Q]=c,n.data[de]=u,n.data[xe]=h,n.data[ye]=d,n.data[ve]=v,n}static identity(t){return t||(t=new we),t.data[J]=1,t.data[q]=0,t.data[le]=0,t.data[G]=0,t.data[Q]=1,t.data[de]=0,t.data[xe]=0,t.data[ye]=0,t.data[ve]=1,t}static translate(t,e,n){return n||(n=new we),n.data[J]=1,n.data[q]=0,n.data[le]=t,n.data[G]=0,n.data[Q]=1,n.data[de]=e,n.data[xe]=0,n.data[ye]=0,n.data[ve]=1,n}static scale(t,e,n){return n||(n=new we),n.data[J]=t,n.data[q]=0,n.data[le]=0,n.data[G]=0,n.data[Q]=e,n.data[de]=0,n.data[xe]=0,n.data[ye]=0,n.data[ve]=1,n}static rotate(t,e){const n=Math.cos(t),i=Math.sin(t);return e||(e=new we),e.data[J]=n,e.data[q]=-i,e.data[le]=0,e.data[G]=i,e.data[Q]=n,e.data[de]=0,e.data[xe]=0,e.data[ye]=0,e.data[ve]=1,e}static copy(t,e,n){return e||(e=new we),e.data[0]=t.data[0],e.data[1]=t.data[1],e.data[2]=t.data[2],e.data[3]=t.data[3],e.data[4]=t.data[4],e.data[5]=t.data[5],e.data[6]=t.data[6],e.data[7]=t.data[7],e.data[8]=t.data[8],e}translate(t,e){return this.data[le]=this.data[J]*t+this.data[q]*e+this.data[le],this.data[de]=this.data[G]*t+this.data[Q]*e+this.data[de],this}scale(t,e){return this.data[J]=this.data[J]*t,this.data[q]=this.data[q]*e,this.data[G]=this.data[G]*t,this.data[Q]=this.data[Q]*e,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),n=Math.sin(t),i=this.data[J]*e+this.data[q]*n,o=this.data[q]*e-this.data[J]*n,s=this.data[G]*e+this.data[Q]*n,a=this.data[Q]*e-this.data[G]*n;return this.data[J]=i,this.data[q]=o,this.data[G]=s,this.data[Q]=a,this}multiply(t){return we.multiply(this,t,this)}get tx(){return this.data[le]}get ty(){return this.data[de]}get ta(){return this.data[J]}get tb(){return this.data[q]}get tc(){return this.data[G]}get td(){return this.data[Q]}transformPoint(t,e){return[this.data[J]*t+this.data[q]*e+this.data[le],this.data[G]*t+this.data[Q]*e+this.data[G]]}}const fo=new we;var k;(function(r){r[r.Children=1]="Children",r[r.ScaleRotate=2]="ScaleRotate",r[r.Local=4]="Local",r[r.Global=8]="Global",r[r.Clipping=16]="Clipping",r[r.CalculatedZIndex=32]="CalculatedZIndex",r[r.ZIndexSortedChildren=64]="ZIndexSortedChildren",r[r.PremultipliedColors=128]="PremultipliedColors",r[r.WorldAlpha=256]="WorldAlpha",r[r.None=0]="None",r[r.All=511]="All"})(k||(k={}));class sr extends et{constructor(e,n){super();f(this,"stage");f(this,"children",[]);f(this,"props");f(this,"updateType",k.All);f(this,"globalTransform");f(this,"scaleRotateTransform");f(this,"localTransform");f(this,"clippingRect",null);f(this,"isRenderable",!1);f(this,"parentClippingRect",null);f(this,"worldAlpha",1);f(this,"premultipliedColorTl",0);f(this,"premultipliedColorTr",0);f(this,"premultipliedColorBl",0);f(this,"premultipliedColorBr",0);f(this,"calcZIndex",0);f(this,"isComplex",!1);f(this,"onTextureLoaded",(e,n)=>{this.stage.requestRender(),this.emit("loaded",{type:"texture",dimensions:n})});f(this,"onTextureFailed",(e,n)=>{this.emit("failed",{type:"texture",error:n})});this.stage=e,this.props={...n,parent:null},this.parent=n.parent,this.updateScaleRotateTransform()}loadTexture(e,n,i=null){this.props.texture&&this.unloadTexture();const{txManager:o}=this.stage,s=o.loadTexture(e,n,i);this.props.texture=s,this.props.textureOptions=i,this.checkIsRenderable(),queueMicrotask(()=>{s.state==="loaded"?this.onTextureLoaded(s,s.dimensions):s.state==="failed"&&this.onTextureFailed(s,s.error),s.on("loaded",this.onTextureLoaded),s.on("failed",this.onTextureFailed)})}unloadTexture(){this.props.texture&&(this.props.texture.off("loaded",this.onTextureLoaded),this.props.texture.off("failed",this.onTextureFailed)),this.props.texture=null,this.props.textureOptions=null,this.checkIsRenderable()}loadShader(e,n){const i=this.stage.renderer.getShaderManager();F(i);const{shader:o,props:s}=i.loadShader(e,n);this.props.shader=o,this.props.shaderProps=s,this.checkIsRenderable()}setUpdateType(e){this.updateType|=e;const n=this.props.parent;n&&!(n.updateType&k.Children)&&n.setUpdateType(k.Children)}sortChildren(){this.children.sort((e,n)=>e.calcZIndex-n.calcZIndex)}updateScaleRotateTransform(){this.scaleRotateTransform=we.rotate(this.props.rotation,this.scaleRotateTransform).scale(this.props.scaleX,this.props.scaleY)}updateLocalTransform(){F(this.scaleRotateTransform);const e=this.props.pivotX*this.props.width,n=this.props.pivotY*this.props.height,i=this.props.mountX*this.props.width,o=this.props.mountY*this.props.height;this.localTransform=we.translate(e-i+this.props.x,n-o+this.props.y,this.localTransform).multiply(this.scaleRotateTransform).translate(-e,-n),this.setUpdateType(k.Global)}update(e,n=null){this.updateType&k.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(k.Local)),this.updateType&k.Local&&(this.updateLocalTransform(),this.setUpdateType(k.Global));const i=this.props.parent;let o=k.None;this.updateType&k.Global&&(F(this.localTransform),this.globalTransform=we.copy((i==null?void 0:i.globalTransform)||this.localTransform,this.globalTransform),i&&this.globalTransform.multiply(this.localTransform),this.setUpdateType(k.Clipping|k.Children),o|=k.Global),this.updateType&k.Clipping&&(this.calculateClippingRect(n),this.checkIsRenderable(),this.setUpdateType(k.Children),o|=k.Clipping),this.updateType&k.WorldAlpha&&(i?this.worldAlpha=i.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(k.Children|k.PremultipliedColors),o|=k.WorldAlpha),this.updateType&k.PremultipliedColors&&(this.premultipliedColorTl=wt(this.props.colorTl,this.worldAlpha,!0),this.premultipliedColorTr=wt(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=wt(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=wt(this.props.colorBr,this.worldAlpha,!0),this.checkIsRenderable(),this.setUpdateType(k.Children),o|=k.PremultipliedColors),i&&this.updateType&k.CalculatedZIndex&&(this.calculateZIndex(),i.setUpdateType(k.ZIndexSortedChildren)),this.updateType&k.Children&&this.children.length&&this.children.forEach(s=>{s.setUpdateType(o),s.updateType!==0&&s.update(e,this.clippingRect)}),this.updateType&k.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkIsRenderable(){return this.props.texture?this.isRenderable=!0:this.props.shader?this.isRenderable=!0:this.props.clipping?this.isRenderable=!0:["color","colorTop","colorBottom","colorLeft","colorRight","colorTl","colorTr","colorBl","colorBr"].some(n=>this.props[n]!==0)?this.isRenderable=!0:this.isRenderable=!1}calculateClippingRect(e=null){if(F(this.globalTransform),this.parentClippingRect===e&&this.clippingRect)return;const n=this.globalTransform,i=n.tb!==0||n.tc!==0;let o=this.props.clipping&&!i?{x:n.tx,y:n.ty,width:this.width*n.ta,height:this.height*n.td}:null;e&&o?o=zr(e,o):e&&(o=e),this.parentClippingRect=e,this.clippingRect=o}calculateZIndex(){var s,a;const e=this.props,n=e.zIndex||0,i=((s=e.parent)==null?void 0:s.zIndex)||0;let o=n;(a=e.parent)!=null&&a.zIndexLocked&&(o=n<i?n:i),this.calcZIndex=o}renderQuads(e){const{width:n,height:i,texture:o,textureOptions:s,shader:a,shaderProps:c}=this.props,{premultipliedColorTl:u,premultipliedColorTr:h,premultipliedColorBl:d,premultipliedColorBr:v}=this,{zIndex:b,worldAlpha:g,globalTransform:x,clippingRect:_}=this;F(x),e.addQuad({width:n,height:i,colorTl:u,colorTr:h,colorBl:d,colorBr:v,texture:o,textureOptions:s,zIndex:b,shader:a,shaderProps:c,alpha:g,clippingRect:_,tx:x.tx,ty:x.ty,ta:x.ta,tb:x.tb,tc:x.tc,td:x.td})}get id(){return this.props.id}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(k.Local))}get absX(){var e,n,i;return this.props.x+(((e=this.props.parent)==null?void 0:e.absX)||((i=(n=this.props.parent)==null?void 0:n.globalTransform)==null?void 0:i.tx)||0)}get absY(){var e,n;return this.props.y+((n=(e=this.props.parent)==null?void 0:e.absY)!=null?n:0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(k.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(k.Local))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(k.Local))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(k.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(k.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(k.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(k.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(k.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(k.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(k.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(k.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(k.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(k.PremultipliedColors|k.WorldAlpha)}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(k.Clipping)}get color(){return this.props.color}set color(e){(this.props.colorTl!==e||this.props.colorTr!==e||this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorTl=e,this.colorTr=e,this.colorBl=e,this.colorBr=e),this.props.color=e,this.setUpdateType(k.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(k.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(k.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(k.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(k.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(k.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(k.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(k.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(k.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(k.CalculatedZIndex|k.Children),this.children.forEach(n=>{n.setUpdateType(k.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(k.CalculatedZIndex|k.Children),this.children.forEach(n=>{n.setUpdateType(k.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(e){const n=this.props.parent;if(n!==e){if(this.props.parent=e,n){const i=n.children.indexOf(this);F(i!==-1,"CoreNode.parent: Node not found in old parent's children!"),n.children.splice(i,1)}e&&(e.children.push(this),this.setUpdateType(k.All),e.setUpdateType(k.Children|k.ZIndexSortedChildren)),this.updateScaleRotateTransform()}}}let po=1;function ar(){return po++}class Wn extends et{constructor(e,n,i,o){var s;super();f(this,"rendererMain");f(this,"stage");f(this,"id");f(this,"coreNode");f(this,"_children",[]);f(this,"_src","");f(this,"_parent",null);f(this,"_texture",null);f(this,"_shader",null);f(this,"onTextureLoaded",(e,n)=>{this.emit("loaded",n)});f(this,"onTextureFailed",(e,n)=>{this.emit("failed",n)});this.rendererMain=n,this.stage=i,this.id=(s=o==null?void 0:o.id)!=null?s:ar(),this.coreNode=o||new sr(this.stage,{id:this.id,x:e.x,y:e.y,width:e.width,height:e.height,alpha:e.alpha,clipping:e.clipping,color:e.color,colorTop:e.colorTop,colorBottom:e.colorBottom,colorLeft:e.colorLeft,colorRight:e.colorRight,colorTl:e.colorTl,colorTr:e.colorTr,colorBl:e.colorBl,colorBr:e.colorBr,zIndex:e.zIndex,zIndexLocked:e.zIndexLocked,scaleX:e.scaleX,scaleY:e.scaleY,mountX:e.mountX,mountY:e.mountY,mount:e.mount,pivot:e.pivot,pivotX:e.pivotX,pivotY:e.pivotY,rotation:e.rotation,parent:null,shader:null,shaderProps:null,texture:null,textureOptions:null}),this.coreNode.on("loaded",this.onTextureLoaded),this.coreNode.on("failed",this.onTextureFailed),this.parent=e.parent,this.shader=e.shader,this.texture=e.texture,this.src=e.src}get x(){return this.coreNode.x}set x(e){this.coreNode.x=e}get y(){return this.coreNode.y}set y(e){this.coreNode.y=e}get width(){return this.coreNode.width}set width(e){this.coreNode.width=e}get height(){return this.coreNode.height}set height(e){this.coreNode.height=e}get alpha(){return this.coreNode.alpha}set alpha(e){this.coreNode.alpha=e}get clipping(){return this.coreNode.clipping}set clipping(e){this.coreNode.clipping=e}get color(){return this.coreNode.color}set color(e){this.coreNode.color=e}get colorTop(){return this.coreNode.colorTop}set colorTop(e){this.coreNode.colorTop=e}get colorBottom(){return this.coreNode.colorBottom}set colorBottom(e){this.coreNode.colorBottom=e}get colorLeft(){return this.coreNode.colorLeft}set colorLeft(e){this.coreNode.colorLeft=e}get colorRight(){return this.coreNode.colorRight}set colorRight(e){this.coreNode.colorRight=e}get colorTl(){return this.coreNode.colorTl}set colorTl(e){this.coreNode.colorTl=e}get colorTr(){return this.coreNode.colorTr}set colorTr(e){this.coreNode.colorTr=e}get colorBl(){return this.coreNode.colorBl}set colorBl(e){this.coreNode.colorBl=e}get colorBr(){return this.coreNode.colorBr}set colorBr(e){this.coreNode.colorBr=e}get scale(){return this.scaleX!==this.scaleY?null:this.coreNode.scaleX}set scale(e){e!==null&&(this.coreNode.scaleX=e,this.coreNode.scaleY=e)}get scaleX(){return this.coreNode.scaleX}set scaleX(e){this.coreNode.scaleX=e}get scaleY(){return this.coreNode.scaleY}set scaleY(e){this.coreNode.scaleY=e}get mount(){return this.coreNode.mount}set mount(e){this.coreNode.mount=e}get mountX(){return this.coreNode.mountX}set mountX(e){this.coreNode.mountX=e}get mountY(){return this.coreNode.mountY}set mountY(e){this.coreNode.mountY=e}get pivot(){return this.coreNode.pivot}set pivot(e){this.coreNode.pivot=e}get pivotX(){return this.coreNode.pivotX}set pivotX(e){this.coreNode.pivotX=e}get pivotY(){return this.coreNode.pivotY}set pivotY(e){this.coreNode.pivotY=e}get rotation(){return this.coreNode.rotation}set rotation(e){this.coreNode.rotation=e}get parent(){return this._parent}set parent(e){var i;const n=this._parent;if(this._parent=e,this.coreNode.parent=(i=e==null?void 0:e.coreNode)!=null?i:null,n){const o=n.children.indexOf(this);F(o!==-1,"MainOnlyNode.parent: Node not found in old parent's children!"),n.children.splice(o,1)}e&&e.children.push(this)}get children(){return this._children}get zIndex(){return this.coreNode.zIndex}set zIndex(e){this.coreNode.zIndex=e}get zIndexLocked(){return this.coreNode.zIndexLocked}set zIndexLocked(e){this.coreNode.zIndexLocked=e}get src(){return this._src}set src(e){if(this._src!==e){if(this._src=e,!e){this.texture=null;return}this.texture=this.rendererMain.createTexture("ImageTexture",{src:e})}}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this.rendererMain.textureTracker.decrementTextureRefCount(this._texture),e&&this.rendererMain.textureTracker.incrementTextureRefCount(e),this._texture=e,e?this.coreNode.loadTexture(e.txType,e.props,e.options):this.coreNode.unloadTexture())}get shader(){return this._shader}set shader(e){this._shader!==e&&(this._shader=e,e&&this.coreNode.loadShader(e.shType,e.props))}destroy(){this.emit("beforeDestroy",{}),this.parent=null,this.texture=null,this.emit("afterDestroy",{}),this.removeAllListeners()}flush(){}animate(e,n){const i=new uo(this.coreNode,e,n);return new ho(this.stage.animationManager,i)}}const go=r=>{const t=()=>{if(r.updateAnimations(),!r.hasSceneUpdates()){setTimeout(t,16.666666666666668);return}r.drawFrame(),requestAnimationFrame(t)};requestAnimationFrame(t)},mo=()=>performance?performance.now():Date.now();class qr extends Mt{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{gl:e}=this;e.getParameter(e.TEXTURE_BINDING_2D)!==t[0].ctxTexture&&(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture))}}f(qr,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class Qr extends Mt{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});f(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:n,gl:i}=this;if(e.length>n.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error("DefaultShaderBatched: Cannot bind more than ".concat(n.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS," textures"));e.forEach((s,a)=>{i.activeTexture(i.TEXTURE0+a),i.bindTexture(i.TEXTURE_2D,s.ctxTexture)});const o=Array.from(Array(e.length).keys());this.setUniform("u_textures[0]",o)}}f(Qr,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:e=>"\n      #define txUnits ".concat(e,"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[").concat(e,"], int idx, vec2 uv) {\n        ").concat(Array.from(Array(e).keys()).map(n=>"\n          ".concat(n!==0?"else ":"","if (idx == ").concat(n,") {\n            return texture2D(textures[").concat(n,"], uv);\n          }\n        ")).join(""),"\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    ")});class se{constructor(t){f(this,"priority",1);f(this,"name","");f(this,"ref");f(this,"target");f(this,"passParameters","");f(this,"declaredUniforms","");f(this,"uniformInfo",{});const{ref:e,target:n,props:i={}}=t;this.ref=e,this.target=n;const o={},s=[];let a="";const c=this.constructor.uniforms||{};for(const u in c){const h=c[u],d=h.type,v="".concat(e,"_").concat(u);let b="";h.size&&(b="[".concat(h.size(i),"]")),s.push(v),a+="uniform ".concat(d," ").concat(v).concat(b,";"),o[u]={name:v,uniform:c[u].method}}this.passParameters=s.join(","),this.declaredUniforms=a,this.uniformInfo=o}static getEffectKey(t){return""}static getMethodParameters(t,e){const n=[];for(const i in t){const o=t[i];let s="";o.size&&(s="[".concat(o.size(e),"]")),n.push("".concat(o.type," ").concat(i).concat(s))}return n.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}f(se,"uniforms",{}),f(se,"methods"),f(se,"onShaderMask"),f(se,"onColorize"),f(se,"onEffectMask");const Ne=class Ne extends Mt{constructor(e,n,i){const o=Ne.createShader(n,i);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...o.uniforms],shaderSources:{vertex:o.vertex,fragment:o.fragment}});f(this,"effects",[]);this.effects=o.effects}bindTextures(e){const{gl:n}=this;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,e[0].ctxTexture)}bindProps(e){var i;const n=this.renderer.shManager.getRegisteredEffects();(i=e.effects)==null||i.forEach((o,s)=>{var d;const a=this.effects[s],c=n[a.name],u=(d=o.props)!=null?d:{},h=a.uniformInfo;Object.keys(u).forEach(v=>{const b=c.uniforms[v],g=h[v];let x=b.validator?b.validator(u[v],u):u[v];Array.isArray(x)&&(x=new Float32Array(x)),this.setUniform(g.name,x)})})}static createShader(e,n){const i={},o={};let s="";const a=[],c=[],u=e.effects.map(g=>{const x=n[g.type],_=x.getEffectKey(g.props||{});i[_]=i[_]?++i[_]:1;const C=i[_];C===1&&c.push({key:_,type:g.type,props:g.props});const m=new x({ref:"".concat(_).concat(C===1?"":C),target:_,props:g.props});return s+=m.declaredUniforms,a.push(...Object.values(m.uniformInfo)),m});let h="";c==null||c.forEach(g=>{var E;const x=n[g.type],_=x.resolveDefaults((E=g.props)!=null?E:{}),C=[];for(const S in x.methods){let w=S;const R=x.methods[S];o[S]&&o[S]!==R&&(w=Ne.resolveMethodDuplicate(S,R,o)),o[w]=R.replace("function",w),C.push({m:S,cm:w})}let m=x.onShaderMask instanceof Function?x.onShaderMask(_):x.onShaderMask,y=x.onColorize instanceof Function?x.onColorize(_):x.onColorize,p=x.onEffectMask instanceof Function?x.onEffectMask(_):x.onEffectMask;C.forEach(S=>{const{m:w,cm:R}=S,A=new RegExp("\\$".concat(w),"g");m&&(m=m.replace(A,R)),y&&(y=y.replace(A,R)),p&&(p=p.replace(A,R))});const T=x.getMethodParameters(x.uniforms,_),I=T.length>0?", ".concat(T):"";m&&(h+="\n        float fx_".concat(g.key,"_onShaderMask(float shaderMask ").concat(I,") {\n          ").concat(m,"\n        }\n        ")),y&&(h+="\n          vec4 fx_".concat(g.key,"_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(I,") {\n            ").concat(y,"\n          }\n        ")),p&&(h+="\n          vec4 fx_".concat(g.key,"_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(I,") {\n            ").concat(p,"\n          }\n        "))});let d="";for(const g in o)d+=o[g];let v="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",b="\n\n    ";for(let g=0;g<u.length;g++){const x=u[g],_=x.passParameters.length>0?", ".concat(x.passParameters):"",C=n[x.name];C.onShaderMask&&(b+="\n        shaderMask = fx_".concat(x.target,"_onShaderMask(shaderMask ").concat(_,");\n        ")),C.onColorize&&(b+="\n        maskColor = fx_".concat(x.target,"_onColorize(shaderMask, maskColor, shaderColor").concat(_,");\n        ")),C.onEffectMask&&(v="fx_".concat(x.target,"_onEffectMask(shaderMask, maskColor, shaderColor").concat(_,")"));const m=u[g+1];(m===void 0||n[m.name].onEffectMask)&&(b+="\n          shaderColor = ".concat(v,";\n        "))}return{effects:u,uniforms:a,fragment:Ne.fragment(s,d,h,b),vertex:Ne.vertex()}}static resolveMethodDuplicate(e,n,i,o=0){const s=e+(o>0?o:"");return i[s]&&i[s]!==n?this.resolveMethodDuplicate(e,n,i,++o):s}static resolveDefaults(e,n){var i;return{effects:((i=e.effects)!=null?i:[]).map(o=>({type:o.type,props:n[o.type].resolveDefaults(o.props||{})})),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,n){var o;let i="";return(o=e.effects)==null||o.forEach(s=>{const c=n[s.type].getEffectKey(s.props||{});i+=",".concat(c)}),"DynamicShader".concat(i)}};f(Ne,"z$__type__Props"),f(Ne,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),f(Ne,"fragment",(e,n,i,o)=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ".concat(e,"\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ").concat(n,"\n\n    ").concat(i,"\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ").concat(o,"\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  "));let dt=Ne;class Xn extends Mt{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}bindProps(t){this.setUniform("u_radius",t.radius)}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}f(Xn,"z$__type__Props"),f(Xn,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const xo=new Float32Array([1,0,0,0,1,0,0,0,1]),yn=class yn extends Mt{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}bindProps(t){const e=yn.resolveDefaults(t);for(const n in e)if(n==="transform")this.setUniform("u_transform",!1,e[n]);else if(n==="scrollY")this.setUniform("u_scrollY",e[n]);else if(n==="color"){const i=Fe(e.color);this.setUniform("u_color",i)}else n==="size"?this.setUniform("u_size",e[n]):n==="distanceRange"?this.setUniform("u_distanceRange",e[n]):n==="debug"&&this.setUniform("u_debug",e[n]?1:0)}static resolveDefaults(t={}){var e,n,i,o,s,a;return{transform:(e=t.transform)!=null?e:xo,scrollY:(n=t.scrollY)!=null?n:0,color:(i=t.color)!=null?i:4294967295,size:(o=t.size)!=null?o:16,distanceRange:(s=t.distanceRange)!=null?s:1,debug:(a=t.debug)!=null?a:!1}}};f(yn,"shaderSources",{vertex:"\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n        gl_Position = vec4((transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1), 0, 1);\n        v_texcoord = a_textureCoordinate;\n      }\n    ",fragment:"\n      precision highp float;\n\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});let Hn=yn;class rt extends se{constructor(){super(...arguments);f(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){var n;return{radius:(n=e.radius)!=null?n:10}}}f(rt,"z$__type__Props"),f(rt,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{let n=e;return Array.isArray(n)?n.length===2?n=[n[0],n[1],n[0],n[1]]:n.length===3?n=[n[0],n[1],n[2],n[0]]:n.length!==4&&(n=[n[0],n[0],n[0],n[0]]):typeof n=="number"&&(n=[n,n,n,n]),n}}}),f(rt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),f(rt,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),f(rt,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class _t extends se{constructor(){super(...arguments);f(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){var n,i;return{width:(n=e.width)!=null?n:10,color:(i=e.color)!=null?i:4294967295}}}f(_t,"z$__type__Props"),f(_t,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Fe(e),method:"uniform4fv",type:"vec4"}}),f(_t,"onEffectMask","\n  float mask = clamp(shaderMask + width, 0.0, 1.0) - clamp(shaderMask, 0.0, 1.0);\n  return mix(shaderColor, maskColor, mask);\n  "),f(_t,"onColorize","\n    return color;\n  ");class it extends se{constructor(){super(...arguments);f(this,"name","linearGradient")}static getEffectKey(e){return"linearGradient".concat(e.colors.length)}static resolveDefaults(e){var o,s;const n=(o=e.colors)!=null?o:[4278190080,4294967295];let i=e.stops;if(!i){i=[];const a=n.length-1;for(let c=0;c<n.length;c++)i.push(c*(1/a))}return{colors:n,stops:i,angle:(s=e.angle)!=null?s:0}}}f(it,"z$__type__Props"),f(it,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.map(i=>Fe(i)).reduce((i,o)=>i.concat(o),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(e,n)=>{var a;const i=(a=n.colors)!=null?a:[];let o=e;const s=e;if(o.length===0||o&&o.length!==i.length){for(let c=0;c<i.length;c++)o[c]?(s[c]=o[c],o[c-1]===void 0&&s[c-2]!==void 0&&(s[c-1]=s[c-2]+(o[c]-s[c-2])/2)):s[c]=c*(1/(i.length-1));o=s}return s},size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),f(it,"methods",{fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),f(it,"ColorLoop",e=>{let n="";for(let i=2;i<e;i++)n+="colorOut = mix(colorOut, colors[".concat(i,"], clamp((dist - stops[").concat(i-1,"]) / (stops[").concat(i,"] - stops[").concat(i-1,"]), 0.0, 1.0));");return n}),f(it,"onColorize",e=>{const n=e.colors.length||1;return"\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      for(int i = 1; i < ".concat(n,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});class Zr extends se{constructor(){super(...arguments);f(this,"name","grayscale")}static getEffectKey(){return"grayscale"}}f(Zr,"onColorize","\n    vec3 color = pow(maskColor.rgb, vec3(2.0));\n    float gray = dot(color, vec3(0.2126, 0.7152, 0.0722));\n    float gammaGray = sqrt(gray);\n    return vec4(gammaGray, gammaGray, gammaGray, 1.0);\n  ");class ot extends se{constructor(){super(...arguments);f(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){var n,i;return{width:(n=e.width)!=null?n:10,color:(i=e.color)!=null?i:4294967295}}}f(ot,"z$__type__Props"),f(ot,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Fe(e),method:"uniform4fv",type:"vec4"}}),f(ot,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),f(ot,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),f(ot,"onColorize","\n    return color;\n  ");class st extends se{constructor(){super(...arguments);f(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){var n,i;return{width:(n=e.width)!=null?n:10,color:(i=e.color)!=null?i:4294967295}}}f(st,"z$__type__Props"),f(st,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Fe(e),method:"uniform4fv",type:"vec4"}}),f(st,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),f(st,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),f(st,"onColorize","\n    return color;\n  ");class at extends se{constructor(){super(...arguments);f(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){var n,i;return{width:(n=e.width)!=null?n:10,color:(i=e.color)!=null?i:4294967295}}}f(at,"z$__type__Props"),f(at,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Fe(e),method:"uniform4fv",type:"vec4"}}),f(at,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),f(at,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),f(at,"onColorize","\n    return color;\n  ");class lt extends se{constructor(){super(...arguments);f(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){var n,i;return{width:(n=e.width)!=null?n:10,color:(i=e.color)!=null?i:4294967295}}}f(lt,"z$__type__Props"),f(lt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Fe(e),method:"uniform4fv",type:"vec4"}}),f(lt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),f(lt,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),f(lt,"onColorize","\n    return color;\n  ");class St extends se{constructor(){super(...arguments);f(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){var n,i,o,s,a;return{amplitude:(n=e.amplitude)!=null?n:.2,narrowness:(i=e.narrowness)!=null?i:4,blockiness:(o=e.blockiness)!=null?o:2,minimizer:(s=e.minimizer)!=null?s:8,time:(a=e.time)!=null?a:Date.now()}}}f(St,"z$__type__Props"),f(St,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",validator:e=>(Date.now()-e)%1e3,type:"float"}}),f(St,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),f(St,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class Vt extends se{constructor(){super(...arguments);f(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){var n;return{fade:(n=e.fade)!=null?n:10}}}f(Vt,"z$__type__Props"),f(Vt,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{let n=e;return Array.isArray(n)?n.length===2?n=[n[0],n[1],n[0],n[1]]:n.length===3?n=[n[0],n[1],n[2],n[0]]:n.length!==4&&(n=[n[0],n[0],n[0],n[0]]):typeof n=="number"&&(n=[n,n,n,n]),n}}}),f(Vt,"onColorize","\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class Kt extends se{constructor(){super(...arguments);f(this,"name","radialGradient")}static getEffectKey(e){return"radialGradient".concat(e.colors.length)}static resolveDefaults(e){var o,s,a,c,u;const n=(o=e.colors)!=null?o:[4278190080,4294967295];let i=e.stops;if(!i){i=[];const h=n.length-1;for(let d=0;d<n.length;d++)i.push(d*(1/h))}return{colors:n,stops:i,width:(s=e.width)!=null?s:0,height:(c=(a=e.height)!=null?a:e.width)!=null?c:0,pivot:(u=e.pivot)!=null?u:[.5,.5]}}}f(Kt,"z$__type__Props"),f(Kt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.map(i=>Fe(i)).reduce((i,o)=>i.concat(o),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(e,n)=>{var a;const i=(a=n.colors)!=null?a:[];let o=e;const s=e;if(o.length===0||o&&o.length!==i.length){for(let c=0;c<i.length;c++)o[c]?(s[c]=o[c],o[c-1]===void 0&&s[c-2]!==void 0&&(s[c-1]=s[c-2]+(o[c]-s[c-2])/2)):s[c]=c*(1/(i.length-1));o=s}return s},size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),f(Kt,"onColorize",e=>{const n=e.colors.length||1;return"\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      for(int i = 1; i < ".concat(n,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});class ct extends se{constructor(){super(...arguments);f(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){var n,i,o,s,a,c,u;return{width:(n=e.width)!=null?n:10,progress:(i=e.progress)!=null?i:.5,offset:(o=e.offset)!=null?o:0,range:(s=e.range)!=null?s:Math.PI*2,rounded:(a=e.rounded)!=null?a:!1,radius:(c=e.radius)!=null?c:1,color:(u=e.color)!=null?u:4294967295}}}f(ct,"z$__type__Props"),f(ct,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>Fe(e),method:"uniform4fv",type:"vec4"}}),f(ct,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),f(ct,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),f(ct,"onColorize","\n    return color;\n  ");class yo{constructor(){f(this,"shCache",new Map);f(this,"shConstructors",{});f(this,"attachedShader",null);f(this,"effectConstructors",{});f(this,"renderer");this.registerShaderType("DefaultShader",qr),this.registerShaderType("DefaultShaderBatched",Qr),this.registerShaderType("RoundedRectangle",Xn),this.registerShaderType("DynamicShader",dt),this.registerShaderType("SdfShader",Hn),this.registerEffectType("border",_t),this.registerEffectType("borderBottom",at),this.registerEffectType("borderLeft",lt),this.registerEffectType("borderRight",ot),this.registerEffectType("borderTop",st),this.registerEffectType("fadeOut",Vt),this.registerEffectType("linearGradient",it),this.registerEffectType("radialGradient",Kt),this.registerEffectType("grayscale",Zr),this.registerEffectType("glitch",St),this.registerEffectType("radius",rt),this.registerEffectType("radialProgress",ct)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const n=this.shConstructors[t];if(!n)throw new Error('Shader type "'.concat(t,'" is not registered'));if(t==="DynamicShader")return this.loadDynamicShader(e);const i=n.resolveDefaults(e),o=n.makeCacheKey(i)||n.name;if(o&&this.shCache.has(o))return{shader:this.shCache.get(o),props:i};const s=new n(this.renderer,e);return o&&this.shCache.set(o,s),{shader:s,props:i}}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=dt.resolveDefaults(t,this.effectConstructors),n=dt.makeCacheKey(e,this.effectConstructors);if(n&&this.shCache.has(n))return{shader:this.shCache.get(n),props:e};const i=new dt(this.renderer,t,this.effectConstructors);return n&&this.shCache.set(n,i),{shader:i,props:e}}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}class vo{constructor(){f(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}const Lt=class Lt extends Dr{constructor(e,n){super(e);f(this,"props");this.props=Lt.resolveDefaults(n)}async getTextureData(){const{src:e,premultiplyAlpha:n}=this.props;if(!e)return{data:null};if(e instanceof ImageData)return{data:e,premultiplyAlpha:n};const o=await(await fetch(e)).blob();return{data:await createImageBitmap(o,{premultiplyAlpha:n?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"})}}static makeCacheKey(e){const n=Lt.resolveDefaults(e);return n.src instanceof ImageData?!1:"ImageTexture,".concat(n.src,",").concat(n.premultiplyAlpha)}static resolveDefaults(e){var n,i;return{src:(n=e.src)!=null?n:"",premultiplyAlpha:(i=e.premultiplyAlpha)!=null?i:!0}}};f(Lt,"z$__type__Props");let Gn=Lt;const At=class At extends Dr{constructor(e,n){super(e);f(this,"props");this.props=At.resolveDefaults(n)}async getTextureData(){const{width:e,height:n}=this.props,i=e*n*4,o=new Uint8ClampedArray(i);for(let s=0;s<i;s+=4){const a=Math.floor(Math.random()*256);o[s]=a,o[s+1]=a,o[s+2]=a,o[s+3]=255}return{data:new ImageData(o,e,n)}}static makeCacheKey(e){const n=At.resolveDefaults(e);return"NoiseTexture,".concat(n.width,",").concat(n.height,",").concat(n.cacheId)}static resolveDefaults(e){var n,i,o;return{width:(n=e.width)!=null?n:128,height:(i=e.height)!=null?i:128,cacheId:(o=e.cacheId)!=null?o:0}}};f(At,"z$__type__Props");let Vn=At;class bo{constructor(){f(this,"usedMemory",0);f(this,"txConstructors",{});f(this,"textureKeyCache",new Map);f(this,"textureIdCache",new Map);f(this,"ctxTextureCache",new WeakMap);f(this,"textureRefCountMap",new WeakMap);f(this,"renderer");this.registerTextureType("ImageTexture",Gn),this.registerTextureType("ColorTexture",Di),this.registerTextureType("NoiseTexture",Vn),this.registerTextureType("SubTexture",Pi)}registerTextureType(t,e){this.txConstructors[t]=e}loadTexture(t,e,n=null){var s;const i=this.txConstructors[t];if(!i)throw new Error('Texture type "'.concat(t,'" is not registered'));let o;if((n==null?void 0:n.id)!==void 0&&this.textureIdCache.has(n.id)&&(o=this.textureIdCache.get(n.id)),!o){const a=n==null?void 0:n.id,c=(s=n==null?void 0:n.cacheKey)!=null?s:i.makeCacheKey(e);c&&this.textureKeyCache.has(c)?o=this.textureKeyCache.get(c):o=new i(this,e),a&&this.addTextureIdToCache(a,c,o)}return n!=null&&n.preload&&this.getCtxTexture(o).load(),o}addTextureIdToCache(t,e,n){const{textureIdCache:i,textureRefCountMap:o}=this;i.set(t,n),o.has(n)?o.get(n).count++:(o.set(n,{cacheKey:e,count:1}),e&&this.textureKeyCache.set(e,n))}removeTextureIdFromCache(t){const{textureIdCache:e,textureRefCountMap:n}=this,i=e.get(t);if(i&&(e.delete(t),n.has(i))){const o=n.get(i);F(o),o.count--,o.count===0&&(n.delete(i),o.cacheKey&&this.textureKeyCache.delete(o.cacheKey))}}getDebugInfo(){return{keyCacheSize:this.textureKeyCache.size,idCacheSize:this.textureIdCache.size}}getCtxTexture(t){if(this.ctxTextureCache.has(t))return this.ctxTextureCache.get(t);const e=this.renderer.createCtxTexture(t);return this.ctxTextureCache.set(t,e),e}}class ei{constructor(t){f(this,"textRenderers");this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const n=this.textRenderers[e];n&&n.isFontFaceSupported(t)&&n.addFontFace(t)}}static resolveFontFace(t,e){const n=[];return t.reduce((o,s)=>{if(o)return o;const a=s[e.fontFamily];if(!a)return;const c=new Set(a);for(const u of c)(u.descriptors.stretch!==e.fontStretch||u.descriptors.style!==e.fontStyle||u.descriptors.weight!==e.fontWeight)&&c.delete(u);return c.values().next().value},void 0)||n[0]}}const wo={x:(r,t)=>{r.props.x=t},y:(r,t)=>{r.props.y=t},width:(r,t)=>{r.props.width=t},height:(r,t)=>{r.props.height=t},color:(r,t)=>{r.props.color=t},zIndex:(r,t)=>{r.props.zIndex=t},fontFamily:(r,t)=>{r.props.fontFamily=t},fontWeight:(r,t)=>{r.props.fontWeight=t},fontStyle:(r,t)=>{r.props.fontStyle=t},fontStretch:(r,t)=>{r.props.fontStretch=t},fontSize:(r,t)=>{r.props.fontSize=t},text:(r,t)=>{r.props.text=t},textAlign:(r,t)=>{r.props.textAlign=t},contain:(r,t)=>{r.props.contain=t},offsetY:(r,t)=>{r.props.offsetY=t},scrollable:(r,t)=>{r.props.scrollable=t},scrollY:(r,t)=>{r.props.scrollY=t},letterSpacing:(r,t)=>{r.props.letterSpacing=t},debug:(r,t)=>{r.props.debug=t}};class ti{constructor(t){f(this,"stage");f(this,"set");this.stage=t;const e={...wo,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(e).map(([n,i])=>[n,(o,s)=>{o.props[n]!==s&&i(o,s)}])))}setStatus(t,e,n){t.status!==e&&(t.status=e,t.emitter.emit(e,n))}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.updateScheduled=!1,this.updateState(t)}))}}const _o=24;function So(r,t,e,n,i,o,s){let a=0;i&&(a=Math.min(Math.max(Math.floor(i.y1/r),0),o.length));const c=0,u=t/e+a*n;if(!(s&&u>=s/e))return{x:c,y:u,lineIndex:a}}class Jt{constructor(t,e=0){f(this,"iterator");f(this,"peekBuffer",[]);f(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*qt(r,t=0){let e=t;for(;e<r.length;){const n=r.codePointAt(e);if(n===void 0)throw new Error("Invalid Unicode code point");yield n,e+=n<=65535?1:2}}function Co(r,t,e){const n=e.shapeText(t,new Jt(qt(r,0),0));let i=0;for(const o of n)o.mapped&&(i+=o.xAdvance);return i}function To(r,t,e,n,i,o,s,a,c,u,h,d,v,b,g,x){F(b,"Font face must be loaded"),F(b.loaded,"Font face must be loaded"),F(b.data,"Font face must be loaded"),F(b.shaper,"Font face must be loaded");const _=b.data.info.size,C=a/_,m=o/C,y=c/C,p=d[r],T=(p==null?void 0:p.codepointIndex)||0,I=(p==null?void 0:p.maxX)||0,E=(p==null?void 0:p.maxY)||0;let S=I,w=E,R=t,A=e,L=0;const M={codepointIndex:-1,bufferOffset:-1,xStart:-1},U=b.shaper,X={letterSpacing:y};let oe=U.shapeText(X,new Jt(qt(n,T),T)),te,pe=-1;const Se=[],gt="...",Ot=s/C,Bt=Co(gt,X,U);let We=!0;for(;We;){const Te=h!=="both"||x||A+_+_<=Ot,me=Te?m:m-Bt;let ne=0;for(;(te=oe.next())&&!te.done;){const j=te.value;if(r===d.length)d.push({codepointIndex:j.cluster,maxY:w,maxX:S});else if(r>d.length)throw new Error("Unexpected lineCache length");if(j.codepoint===32||j.codepoint===10?M.codepointIndex!==-1&&(M.codepointIndex=-1,ne=R):M.codepointIndex===-1&&(M.codepointIndex=j.cluster,M.bufferOffset=L,M.xStart=ne),j.mapped){const Oe=R+j.xOffset+j.width;if(h!=="none"&&Oe>=me&&M.codepointIndex!==-1&&M.codepointIndex<j.cluster&&M.xStart>0)if(Te){oe=U.shapeText(X,new Jt(qt(n,M.codepointIndex),M.codepointIndex)),L=M.bufferOffset;break}else oe=U.shapeText(X,new Jt(qt(gt,0),0)),R=M.xStart,L=M.bufferOffset;else{const ue=R+j.xOffset,Be=A+j.yOffset,$t=v?A+_>=v.y1/C:!0,Yt=v?A<=v.y2/C:!0;if($t&&Yt){pe===-1&&(pe=L);const Xe=b.getAtlasEntry(j.glyphId),He=Xe.x/b.data.common.scaleW,Ge=Xe.y/b.data.common.scaleH,mt=Xe.width/b.data.common.scaleW,hr=Xe.height/b.data.common.scaleH;u[L++]=ue,u[L++]=Be,u[L++]=He,u[L++]=Ge,u[L++]=ue+j.width,u[L++]=Be,u[L++]=He+mt,u[L++]=Ge,u[L++]=ue,u[L++]=Be+j.height,u[L++]=He,u[L++]=Ge+hr,u[L++]=ue+j.width,u[L++]=Be+j.height,u[L++]=He+mt,u[L++]=Ge+hr}w=Math.max(w,Be+j.height),R+=j.xAdvance,S=Math.max(S,R)}}else if(j.codepoint===10)break}pe!==-1&&(Se.push({bufferStart:pe,bufferEnd:L}),pe=-1),R=0,A+=_,r++,M.codepointIndex=-1,ne=0,(!g&&h==="both"&&v&&A>v.y2/C||te&&te.done||h==="both"&&!x&&!Te)&&(We=!1)}if(i==="center"){const Te=h==="none"?S:m;for(let me=0;me<Se.length;me++){const ne=Se[me],j=u[ne.bufferEnd-4]-u[ne.bufferStart],Oe=(Te-j)/2;for(let ue=ne.bufferStart;ue<ne.bufferEnd;ue+=4)u[ue]+=Oe}}else if(i==="right"){const Te=h==="none"?S:m;for(let me=0;me<Se.length;me++){const ne=Se[me],j=ne.bufferEnd===ne.bufferStart?0:u[ne.bufferEnd-4]-u[ne.bufferStart],Oe=Te-j;for(let ue=ne.bufferStart;ue<ne.bufferEnd;ue+=4)u[ue]+=Oe}}return F(te),{bufferNumFloats:L,bufferNumQuads:L/16,layoutNumCharacters:te.done?n.length-T:te.value.cluster-T+1,fullyProcessed:!!te.done,maxX:S,maxY:w}}function Ro(r,t,e,n,i,o){const s=n*i,a=o.x1-r,c=o.y1-t;return Oi(o)?{x1:a,y1:c+e-s,x2:a+(o.x2-o.x1),y2:c+e+(o.y2-o.y1)+s}:{x1:0,y1:0,x2:0,y2:0}}const Io=vn(0,0,0,0);class Eo extends ti{constructor(e){super(e);f(this,"ssdfFontFamilies",{});f(this,"msdfFontFamilies",{});f(this,"sdfShader");f(this,"rendererBounds");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,n)=>{e.props.fontFamily=n,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,n)=>{e.props.fontWeight=n,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,n)=>{e.props.fontStyle=n,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,n)=>{e.props.fontStretch=n,e.trFontFace=void 0,this.invalidateLayoutCache(e)},fontSize:(e,n)=>{e.props.fontSize=n,this.invalidateLayoutCache(e)},text:(e,n)=>{e.props.text=n,this.invalidateLayoutCache(e)},textAlign:(e,n)=>{e.props.textAlign=n,this.invalidateLayoutCache(e)},color:(e,n)=>{e.props.color=n},x:(e,n)=>{e.props.x=n,this.invalidateVisibleWindowCache(e)},y:(e,n)=>{e.props.y=n,this.invalidateVisibleWindowCache(e)},contain:(e,n)=>{e.props.contain=n,this.invalidateLayoutCache(e)},width:(e,n)=>{e.props.width=n,this.invalidateLayoutCache(e)},height:(e,n)=>{e.props.height=n,this.invalidateLayoutCache(e)},offsetY:(e,n)=>{e.props.offsetY=n,this.invalidateLayoutCache(e)},scrollable:(e,n)=>{e.props.scrollable=n,this.invalidateLayoutCache(e)},scrollY:(e,n)=>{e.props.scrollY=n,this.scheduleUpdateState(e)},letterSpacing:(e,n)=>{e.props.letterSpacing=n,this.invalidateLayoutCache(e)},debug:(e,n)=>{e.props.debug=n}}}canRenderFont(e){const{fontFamily:n}=e;return n in this.ssdfFontFamilies||n in this.msdfFontFamilies||n==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof pr}addFontFace(e){F(e instanceof pr);const n=e.fontFamily,i=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!i){console.warn("Invalid font face type: ".concat(e.type));return}let o=i[n];o||(o=new Set,i[n]=o),o.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new et,lineCache:[],forceFullLayoutCalc:!1,renderWindow:void 0,visibleWindow:{x1:0,y1:0,x2:0,y2:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:n}=e;const{textH:i,lineCache:o,debugData:s,forceFullLayoutCalc:a}=e;if(s.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),!n&&(n=this.resolveFontFace(e.props),e.trFontFace=n,!n)){const L="SdfTextRenderer: Could not resolve font face for family: '".concat(e.props.fontFamily,"'");console.error(L),this.setStatus(e,"failed",new Error(L));return}if(!n.loaded){n.once("loaded",()=>{this.scheduleUpdateState(e)});return}F(n.data,"Font face data should be loaded");const{text:c,fontSize:u,x:h,y:d,contain:v,width:b,height:g,scrollable:x}=e.props,_=v==="both"&&x?e.props.scrollY:0;let{renderWindow:C}=e;const m=n.data.info.size,y=u/m;e.distanceRange=y*n.data.distanceField.distanceRange;const p=c.length*_o;let T=e.vertexBuffer;(!T||T.length<p)&&(T=new Float32Array(p*2));const I=e.visibleWindow;if(!I.valid){const L=vn(h,d,v!=="none"?h+b:1/0,v==="both"?d+g:1/0,Io);Pr(this.rendererBounds,L,e.visibleWindow),I.valid=!0}if(!a&&C){if(h+C.x1<=I.x1&&h+C.x2>=I.x2&&d-_+C.y1<=I.y1&&d-_+C.y2>=I.y2){this.setStatus(e,"loaded");return}C=e.renderWindow=void 0,this.setStatus(e,"loading")}const{offsetY:E,textAlign:S}=e.props;if(!C){const L=I.y2-I.y1,M=Math.ceil(L/m);C=Ro(h,d,_,m,M,I)}const w=So(u,E,y,m,C,o,i);if(!w){this.setStatus(e,"loaded");return}const{letterSpacing:R}=e.props,A=To(w.lineIndex,w.x,w.y,c,S,b,g,u,R,T,v,o,C,n,a,x);e.bufferUploaded=!1,e.bufferNumFloats=A.bufferNumFloats,e.bufferNumQuads=A.bufferNumQuads,e.vertexBuffer=T,e.renderWindow=C,s.lastLayoutNumCharacters=A.layoutNumCharacters,s.bufferSize=T.byteLength,A.fullyProcessed&&(e.textW=A.maxX*y,e.textH=A.maxY*y),this.setStatus(e,"loaded")}renderQuads(e,n,i,o){var S,w,R;if(!e.vertexBuffer)return;performance.now();const{renderer:s}=this.stage;this.stage.options;const{fontSize:a,color:c,contain:u,scrollable:h,zIndex:d,debug:v}=e.props,b=u==="both"&&h?e.props.scrollY:0,{textW:g=0,textH:x=0,distanceRange:_,vertexBuffer:C,bufferUploaded:m,trFontFace:y}=e;let{webGlBuffers:p}=e;if(!p){const A=s.gl,L=4*Float32Array.BYTES_PER_ELEMENT,M=A.createBuffer();F(M),e.webGlBuffers=new Bi([{buffer:M,attributes:{a_position:{name:"a_position",size:2,type:A.FLOAT,normalized:!1,stride:L,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:A.FLOAT,normalized:!1,stride:L,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,F(e.webGlBuffers),p=e.webGlBuffers}if(!m){const A=s.gl,L=(S=p==null?void 0:p.getBuffer("a_textureCoordinate"))!=null?S:null;A.bindBuffer(A.ARRAY_BUFFER,L),A.bufferData(A.ARRAY_BUFFER,C,A.STATIC_DRAW),e.bufferUploaded=!0}F(y);const T=new $i(s.gl,s.options,p,this.sdfShader,{transform:n.data,color:Yi(c,o),size:a/(((w=y.data)==null?void 0:w.info.size)||0),scrollY:b,distanceRange:_,debug:v.sdfShaderDebug},o,i,{height:x,width:g},0,d),I=(R=e.trFontFace)==null?void 0:R.texture;F(I);const E=this.stage.txManager.getCtxTexture(I);T.addTexture(E),T.length=e.bufferNumFloats,T.numQuads=e.bufferNumQuads,s.addRenderOp(T)}resolveFontFace(e){return ei.resolveFontFace([this.msdfFontFamilies,this.ssdfFontFamilies],e)}invalidateVisibleWindowCache(e){e.visibleWindow.valid=!1,this.scheduleUpdateState(e)}invalidateLayoutCache(e){e.visibleWindow.valid=!1,e.renderWindow=void 0,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}}const xr=2048;class ko{constructor(t,e){f(this,"_canvas");f(this,"_context");f(this,"_settings");f(this,"renderInfo");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFace],e=[];for(let n=0,i=t.length;n<i;n++)t[n]==="serif"||t[n]==="sans-serif"?e.push(t[n]):e.push('"'.concat(t[n],'"'));return"".concat(this._settings.fontStyle," ").concat(this._settings.fontSize*this.getPrecision(),"px ").concat(e.join(","))}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch(e){console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),n=this._settings.paddingLeft*e,i=this._settings.paddingRight*e,o=this._settings.fontSize*e;let s=this._settings.offsetY===null?null:this._settings.offsetY*e,a=(this._settings.lineHeight||o)*e;const c=this._settings.w*e,u=this._settings.h*e;let h=this._settings.wordWrapWidth*e;const d=this._settings.cutSx*e,v=this._settings.cutEx*e,b=this._settings.cutSy*e,g=this._settings.cutEy*e,x=(this._settings.letterSpacing||0)*e,_=this._settings.textIndent*e;this.setFontProperties();let C=c||2048/this.getPrecision(),m=C-n;if(m<10&&(C+=10-m,m=10),h||(h=m),this._settings.textOverflow&&!this._settings.wordWrap){let S;switch(this._settings.textOverflow){case"clip":S="";break;case"ellipsis":S=this._settings.maxLinesSuffix;break;default:S=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,h-_,S)}let y;if(this._settings.wordWrap)y=this.wrapText(this._settings.text,h,x,_);else{y={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const S=y.l.length;for(let w=0;w<S-1;w++)y.n.push(w)}let p=y.l;if(this._settings.maxLines&&p.length>this._settings.maxLines){const S=p.slice(0,this._settings.maxLines);let w=null;if(this._settings.maxLinesSuffix){const U=this._settings.maxLinesSuffix?this.measureText(this._settings.maxLinesSuffix):0,X=this.wrapText(S[S.length-1],h-U,x,_);S[S.length-1]="".concat(X.l[0]).concat(this._settings.maxLinesSuffix),w=[X.l.length>1?X.l[1]:""]}else w=[""];let R;const A=p.length;let L=0;const M=y.n.length;for(R=this._settings.maxLines;R<A;R++)w[L]+="".concat(w[L]?" ":"").concat(p[R]),R+1<M&&y.n[R+1]&&L++;t.remainingText=w.join("\n"),t.moreTextLines=!0,p=S}else t.moreTextLines=!1,t.remainingText="";let T=0;const I=[];for(let S=0;S<p.length;S++){const w=this.measureText(p[S],x)+(S===0?_:0);I.push(w),T=Math.max(T,w)}t.lineWidths=I,c||(C=T+n+i,m=T),a=a||o;let E;if(u)E=u;else{const S=this._settings.textBaseline!="bottom"?.5*o:0;E=a*(p.length-1)+S+Math.max(a,o)+(s||0)}return s===null&&(s=o),t.w=C,t.h=E,t.lines=p,t.precision=e,C||(C=1),E||(E=1),(d||v)&&(C=Math.min(C,v-d)),(b||g)&&(E=Math.min(E,g-b)),t.width=C,t.innerWidth=m,t.height=E,t.fontSize=o,t.cutSx=d,t.cutSy=b,t.cutEx=v,t.cutEy=g,t.lineHeight=a,t.lineWidths=I,t.offsetY=s,t.paddingLeft=n,t.paddingRight=i,t.letterSpacing=x,t.textIndent=_,t}draw(t,e){const n=this.getPrecision(),i=(e==null?void 0:e.lines)||t.lines,o=(e==null?void 0:e.lineWidths)||t.lineWidths,s=e?e.lines.length*t.lineHeight:t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),xr),this._canvas.height=Math.min(Math.ceil(s),xr),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let a,c;const u=[];for(let d=0,v=i.length;d<v;d++)a=d===0?t.textIndent:0,c=d*t.lineHeight+t.offsetY,this._settings.verticalAlign=="middle"?c+=(t.lineHeight-t.fontSize)/2:this._settings.verticalAlign=="bottom"&&(c+=t.lineHeight-t.fontSize),this._settings.textAlign==="right"?a+=t.innerWidth-o[d]:this._settings.textAlign==="center"&&(a+=(t.innerWidth-o[d])/2),a+=t.paddingLeft,u.push({text:i[d],x:a,y:c,w:o[d]});if(this._settings.highlight){const d=this._settings.highlightColor,v=this._settings.highlightHeight*n||t.fontSize*1.5,b=this._settings.highlightOffset*n,g=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*n:t.paddingLeft,x=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*n:t.paddingRight;this._context.fillStyle=En(d);for(let _=0;_<u.length;_++){const C=u[_];this._context.fillRect(C.x-g,C.y-t.offsetY+b,C.w+x+g,v)}}let h=null;this._settings.shadow&&(h=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=En(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*n,this._context.shadowOffsetY=this._settings.shadowOffsetY*n,this._context.shadowBlur=this._settings.shadowBlur*n),this._context.fillStyle=En(this._settings.textColor);for(let d=0,v=u.length;d<v;d++){const b=u[d];if(t.letterSpacing===0)this._context.fillText(b.text,b.x,b.y);else{const g=b.text.split("");let x=b.x;for(let _=0,C=g.length;_<C;_++)this._context.fillText(g[_],x,b.y),x+=this.measureText(g[_],t.letterSpacing)}}h&&(this._context.shadowColor=h[0],this._context.shadowOffsetX=h[1],this._context.shadowOffsetY=h[2],this._context.shadowBlur=h[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy),this.renderInfo=t}wrapWord(t,e,n){const i=this._context.measureText(n).width,o=t.length,s=this._context.measureText(t).width;if(s<=e)return t;let a=Math.floor(e*o/s),c=this._context.measureText(t.substring(0,a)).width+i;if(c>e)for(;a>0&&(c=this._context.measureText(t.substring(0,a)).width+i,c>e);)a-=1;else for(;a<o;)if(c=this._context.measureText(t.substring(0,a)).width+i,c<e)a+=1;else{a-=1;break}return t.substring(0,a)+(e>=i?n:"")}wrapText(t,e,n,i=0){const o=t.split(/\r?\n/g);let s=[];const a=[];for(let c=0;c<o.length;c++){const u=[];let h="",d=e-i;const v=o[c].split(" ");for(let b=0;b<v.length;b++){const g=this.measureText(v[b],n),x=g+this.measureText(" ",n);b===0||x>d?(b>0&&(u.push(h),h=""),h+=v[b],d=e-g-(b===0?i:0)):(d-=x,h+=" ".concat(v[b]))}u.push(h),h="",s=s.concat(u),c<o.length-1&&a.push(s.length)}return{l:s,n:a}}measureText(t,e=0){return e?t.split("").reduce((n,i)=>n+this._context.measureText(i).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxLinesSuffix:"..",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const yr=typeof self>"u"?globalThis:self;var Mr;const vr=((Mr=yr.document)==null?void 0:Mr.fonts)||yr.fonts;function Lo(r){const{fontFamily:t,fontStyle:e,fontWeight:n,fontStretch:i,fontSize:o}=r;return[e,n,i,"".concat(o,"px"),t].join(" ")}const Ao=vn(0,0,0,0);class Fo extends ti{constructor(e){super(e);f(this,"canvas");f(this,"context");f(this,"rendererBounds");typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let n=this.canvas.getContext("2d");n||(this.canvas=document.createElement("canvas"),n=this.canvas.getContext("2d")),F(n),this.context=n,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,n)=>{e.props.fontFamily=n,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,n)=>{e.props.fontWeight=n,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,n)=>{e.props.fontStyle=n,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,n)=>{e.props.fontStretch=n,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,n)=>{e.props.fontSize=n,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,n)=>{e.props.text=n,this.invalidateLayoutCache(e)},textAlign:(e,n)=>{e.props.textAlign=n,this.invalidateLayoutCache(e)},color:(e,n)=>{e.props.color=n,this.invalidateLayoutCache(e)},x:(e,n)=>{e.props.x=n,this.invalidateVisibleWindowCache(e)},y:(e,n)=>{e.props.y=n,this.invalidateVisibleWindowCache(e)},contain:(e,n)=>{e.props.contain=n,this.invalidateLayoutCache(e)},width:(e,n)=>{e.props.width=n,this.invalidateLayoutCache(e)},height:(e,n)=>{e.props.height=n,this.invalidateLayoutCache(e)},offsetY:(e,n)=>{e.props.offsetY=n,this.invalidateLayoutCache(e)},scrollY:(e,n)=>{e.props.scrollY=n},letterSpacing:(e,n)=>{e.props.letterSpacing=n,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof gr}addFontFace(e){F(e instanceof gr),vr.add(e.fontFace)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new et,canvasPages:void 0,lightning2TextRenderer:new ko(this.canvas,this.context),renderWindow:void 0,visibleWindow:{x1:0,y1:0,x2:0,y2:0,valid:!1},renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,fontFaceLoadedHandler:void 0,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),!e.fontInfo){const g=Lo(e.props);if(e.fontInfo={cssString:g,loaded:!1},!e.fontInfo.loaded){vr.load(g).then(this.onFontLoaded.bind(this,e,g)).catch(this.onFontLoadError.bind(this,e,g));return}}if(!e.fontInfo.loaded)return;e.renderInfo||(e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFace:e.props.fontFamily,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:Fe(e.props.color),offsetY:e.props.fontSize+e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,e.renderWindow=void 0);const{x:n,y:i,width:o,height:s,scrollY:a,contain:c}=e.props,{visibleWindow:u}=e;let{renderWindow:h,canvasPages:d}=e;if(!u.valid){const g=vn(n,i,c!=="none"?n+o:1/0,c==="both"?i+s:1/0,Ao);Pr(this.rendererBounds,g,u),u.valid=!0}const v=u.y2-u.y1,b=Math.ceil(v/e.renderInfo.lineHeight);if(v===0){d=void 0,h=void 0,this.setStatus(e,"loaded");return}else if(h&&d){const g=n+h.x1,x=i-a+h.y1,_=n+h.x2,C=i-a+h.y2;if(g<=u.x1&&_>=u.x2&&x<=u.y1&&C>=u.y2){this.setStatus(e,"loaded");return}C<u.y2?(h.y1+=b*e.renderInfo.lineHeight,h.y2+=b*e.renderInfo.lineHeight,d.push(d.shift()),d[2].lineNumStart=d[1].lineNumStart+b,d[2].lineNumEnd=d[2].lineNumStart+b,d[2].valid=!1):x>u.y1&&(h.y1-=b*e.renderInfo.lineHeight,h.y2-=b*e.renderInfo.lineHeight,d.unshift(d.pop()),d[0].lineNumStart=d[1].lineNumStart-b,d[0].lineNumEnd=d[0].lineNumStart+b,d[0].valid=!1)}else{const g=e.renderInfo.lineHeight*b,x=Math.ceil(a/g),_=x*b,C=_-b,m=_+b;d=[{texture:d==null?void 0:d[0].texture,lineNumStart:C,lineNumEnd:C+b,valid:!1},{texture:d==null?void 0:d[1].texture,lineNumStart:_,lineNumEnd:_+b,valid:!1},{texture:d==null?void 0:d[2].texture,lineNumStart:m,lineNumEnd:m+b,valid:!1}],e.canvasPages=d;const y=x*g;h={x1:0,y1:y-g,x2:o,y2:y+g*2}}e.renderWindow=h,performance.now();for(const g of d)if(!g.valid){if(g.lineNumStart<0){g.texture=this.stage.txManager.loadTexture("ImageTexture",{src:""}),g.valid=!0;continue}e.lightning2TextRenderer.draw(e.renderInfo,{lines:e.renderInfo.lines.slice(g.lineNumStart,g.lineNumEnd),lineWidths:e.renderInfo.lineWidths.slice(g.lineNumStart,g.lineNumEnd)}),this.canvas.width===0||this.canvas.height===0||(g.texture=this.stage.txManager.loadTexture("ImageTexture",{src:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},{preload:!0})),g.valid=!0}this.setStatus(e,"loaded")}renderQuads(e,n,i,o){var S,w,R,A,L,M,U,X,oe,te,pe,Se;const{stage:s}=this,{canvasPages:a,textW:c=0,textH:u=0,renderWindow:h}=e;if(!a||!h)return;const{x:d,y:v,scrollY:b,contain:g,width:x,height:_}=e.props,C={x:d,y:v,width:g!=="none"?x:c,height:g==="both"?_:u};zr({x:0,y:0,width:s.options.appWidth,height:s.options.appHeight},C),F(a,"canvasPages is not defined"),F(h,"renderWindow is not defined");const y=(h.y2-h.y1)/3,{zIndex:p,color:T}=e.props,I=o*ji(T),E=wt(4294967295,I);a[0].valid&&this.stage.renderer.addQuad({alpha:I,clippingRect:i,colorBl:E,colorBr:E,colorTl:E,colorTr:E,width:((w=(S=a[0].texture)==null?void 0:S.dimensions)==null?void 0:w.width)||0,height:((A=(R=a[0].texture)==null?void 0:R.dimensions)==null?void 0:A.height)||0,texture:a[0].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:p,tx:n.tx,ty:n.ty-b+h.y1,ta:n.ta,tb:n.tb,tc:n.tc,td:n.td}),a[1].valid&&this.stage.renderer.addQuad({alpha:I,clippingRect:i,colorBl:E,colorBr:E,colorTl:E,colorTr:E,width:((M=(L=a[1].texture)==null?void 0:L.dimensions)==null?void 0:M.width)||0,height:((X=(U=a[1].texture)==null?void 0:U.dimensions)==null?void 0:X.height)||0,texture:a[1].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:p,tx:n.tx,ty:n.ty-b+h.y1+y,ta:n.ta,tb:n.tb,tc:n.tc,td:n.td}),a[2].valid&&this.stage.renderer.addQuad({alpha:I,clippingRect:i,colorBl:E,colorBr:E,colorTl:E,colorTr:E,width:((te=(oe=a[2].texture)==null?void 0:oe.dimensions)==null?void 0:te.width)||0,height:((Se=(pe=a[2].texture)==null?void 0:pe.dimensions)==null?void 0:Se.height)||0,texture:a[2].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:p,tx:n.tx,ty:n.ty-b+h.y1+y+y,ta:n.ta,tb:n.tb,tc:n.tc,td:n.td})}invalidateVisibleWindowCache(e){e.visibleWindow.valid=!1,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,n){var i;n!==((i=e.fontInfo)==null?void 0:i.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,n,i){var o;n!==((o=e.fontInfo)==null?void 0:o.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error("CanvasTextRenderer: Error loading font '".concat(e.fontInfo.cssString,"'"),i),this.scheduleUpdateState(e))}}const No=2e6;class Mo extends et{constructor(e){super();f(this,"options");f(this,"animationManager");f(this,"txManager");f(this,"fontManager");f(this,"textRenderers");f(this,"shManager");f(this,"renderer");f(this,"root");f(this,"deltaTime",0);f(this,"lastFrameTime",0);f(this,"currentFrameTime",0);f(this,"fpsNumFrames",0);f(this,"fpsElapsedTime",0);f(this,"renderRequested",!1);this.options=e;const{canvas:n,clearColor:i,rootId:o,debug:s,appWidth:a,appHeight:c}=e;this.txManager=new bo,this.shManager=new yo,this.animationManager=new vo,s!=null&&s.monitorTextureCache&&setInterval(()=>{F(this.txManager);const h=this.txManager.getDebugInfo();console.log("Texture ID Cache Size: ",h.idCacheSize),console.log("Texture Key Cache Size: ",h.keyCacheSize)},1e3),this.renderer=new Ui({stage:this,canvas:n,pixelRatio:e.devicePhysicalPixelRatio*e.deviceLogicalPixelRatio,clearColor:i!=null?i:4278190080,bufferMemory:No,txManager:this.txManager,shManager:this.shManager}),this.txManager.renderer=this.renderer,this.textRenderers={canvas:new Fo(this),sdf:new Eo(this)},this.fontManager=new ei(this.textRenderers);const u=new sr(this,{id:o,x:0,y:0,width:a,height:c,alpha:1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null});this.root=u,go(this)}updateAnimations(){const{animationManager:e}=this;this.root&&(this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=mo(),this.deltaTime=this.lastFrameTime?this.currentFrameTime-this.lastFrameTime:100/6,e.update(this.deltaTime))}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:e,renderRequested:n}=this;this.root.updateType!==0&&this.root.update(this.deltaTime),e==null||e.reset(),this.addQuads(this.root),e==null||e.render(),n&&(this.renderRequested=!1);const{fpsUpdateInterval:i}=this.options;if(i&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=i)){const o=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.emit("fpsUpdate",o)}}addQuads(e){F(this.renderer&&e.globalTransform),e.isRenderable&&e.renderQuads(this.renderer);for(let n=0;n<e.children.length;n++){const i=e.children[n];i&&(i==null?void 0:i.worldAlpha)!==0&&this.addQuads(i)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(e,n=null){let i=n,o=!1;if(i){const a=this.textRenderers[i];a?a.canRenderFont(e)||(console.warn("Cannot use override text renderer '".concat(i,"' for font"),e),i=null,o=!0):(console.warn("Text renderer override '".concat(i,"' not found.")),i=null,o=!0)}if(!i){for(const[a,c]of Object.entries(this.textRenderers))if(a!=="canvas"&&c.canRenderFont(e)){i=a;break}i||(i="canvas")}o&&console.warn("Falling back to text renderer ".concat(String(i)));const s=this.textRenderers[i];return F(s,"resolvedTextRenderer undefined"),s}}class zo extends sr{constructor(e,n){super(e,n);f(this,"textRenderer");f(this,"trState");f(this,"_textRendererOverride",null);f(this,"onTextLoaded",()=>{const{contain:e}=this,n=this.trState.props.width,i=this.trState.props.height,o=this.trState.textW||0,s=this.trState.textH||0;e==="both"?(this.props.width=n,this.props.height=i):e==="width"?(this.props.width=n,this.props.height=s):e==="none"&&(this.props.width=o,this.props.height=s),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});f(this,"onTextFailed",(e,n)=>{this.emit("failed",{type:"text",error:n})});this._textRendererOverride=n.textRendererOverride;const{resolvedTextRenderer:i,textRendererState:o}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:n.width,height:n.height,textAlign:n.textAlign,color:n.color,zIndex:n.zIndex,contain:n.contain,scrollable:n.scrollable,scrollY:n.scrollY,offsetY:n.offsetY,letterSpacing:n.letterSpacing,debug:n.debug,fontFamily:n.fontFamily,fontSize:n.fontSize,fontStretch:n.fontStretch,fontStyle:n.fontStyle,fontWeight:n.fontWeight,text:n.text},void 0);this.textRenderer=i,this.trState=o}get width(){return this.trState.props.width}set width(e){this.textRenderer.set.width(this.trState,e)}get height(){return this.trState.props.height}set height(e){this.textRenderer.set.height(this.trState,e)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e),this.checkIsRenderable()}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e;const{resolvedTextRenderer:n,textRendererState:i}=this.resolveTextRendererAndState(this.trState.props,this.trState);this.textRenderer=n,this.trState=i}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,n=null){super.update(e,n),F(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkIsRenderable(){return super.checkIsRenderable()?!0:this.trState.props.text!==""?this.isRenderable=!0:this.isRenderable=!1}renderQuads(e){F(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha)}resolveTextRendererAndState(e,n){const i=this.stage.resolveTextRenderer(e,this._textRendererOverride),o=i.createState(e);return n&&["loading","loaded","failed"].forEach(a=>{n.emitter.off(a)}),o.emitter.on("loaded",this.onTextLoaded),o.emitter.on("failed",this.onTextFailed),i.scheduleUpdateState(o),{resolvedTextRenderer:i,textRendererState:o}}}class Do extends Wn{constructor(t,e,n){super(t,e,n,new zo(n,{id:ar(),x:t.x,y:t.y,width:t.width,height:t.height,alpha:t.alpha,clipping:t.clipping,color:t.color,colorTop:t.colorTop,colorBottom:t.colorBottom,colorLeft:t.colorLeft,colorRight:t.colorRight,colorTl:t.colorTl,colorTr:t.colorTr,colorBl:t.colorBl,colorBr:t.colorBr,zIndex:t.zIndex,zIndexLocked:t.zIndexLocked,scaleX:t.scaleX,scaleY:t.scaleY,mountX:t.mountX,mountY:t.mountY,mount:t.mount,pivot:t.pivot,pivotX:t.pivotX,pivotY:t.pivotY,rotation:t.rotation,text:t.text,fontSize:t.fontSize,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontStretch:t.fontStretch,fontStyle:t.fontStyle,contain:t.contain,scrollable:t.scrollable,letterSpacing:t.letterSpacing,textAlign:t.textAlign,scrollY:t.scrollY,offsetY:t.offsetY,textRendererOverride:t.textRendererOverride,debug:t.debug,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null}))}get text(){return this.coreNode.text}set text(t){this.coreNode.text=t}get textRendererOverride(){return this.coreNode.textRendererOverride}set textRendererOverride(t){this.coreNode.textRendererOverride=t}get fontSize(){return this.coreNode.fontSize}set fontSize(t){this.coreNode.fontSize=t}get fontFamily(){return this.coreNode.fontFamily}set fontFamily(t){this.coreNode.fontFamily=t}get fontWeight(){return this.coreNode.fontWeight}set fontWeight(t){this.coreNode.fontWeight=t}get fontStretch(){return this.coreNode.fontStretch}set fontStretch(t){this.coreNode.fontStretch=t}get fontStyle(){return this.coreNode.fontStyle}set fontStyle(t){this.coreNode.fontStyle=t}get textAlign(){return this.coreNode.textAlign}set textAlign(t){this.coreNode.textAlign=t}get contain(){return this.coreNode.contain}set contain(t){this.coreNode.contain=t}get scrollable(){return this.coreNode.scrollable}set scrollable(t){this.coreNode.scrollable=t}get scrollY(){return this.coreNode.scrollY}set scrollY(t){this.coreNode.scrollY=t}get offsetY(){return this.coreNode.offsetY}set offsetY(t){this.coreNode.offsetY=t}get letterSpacing(){return this.coreNode.letterSpacing}set letterSpacing(t){this.coreNode.letterSpacing=t}get debug(){return this.coreNode.debug}set debug(t){this.coreNode.debug=t}}const Po="modulepreload",Oo=function(r){return"/solid-demo-app/"+r},br={},Bo=function(t,e,n){if(!e||e.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(e.map(o=>{if(o=Oo(o),o in br)return;br[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!n)for(let h=i.length-1;h>=0;h--){const d=i[h];if(d.href===o&&(!s||d.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(o,'"]').concat(a)))return;const u=document.createElement("link");if(u.rel=s?"stylesheet":Po,s||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),s)return new Promise((h,d)=>{u.addEventListener("load",h),u.addEventListener("error",()=>d(new Error("Unable to preload CSS for ".concat(o))))})})).then(()=>t()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})};function $o(r){return r.prototype instanceof Wi}async function Yo(r,t){let e;try{console.log("Loading core extension",r),e=await Bo(()=>import(r),[])}catch(i){console.error("The core extension module at '".concat(r,"' could not be loaded.")),console.error(i);return}if(!e.default){console.error("The core extension module at '".concat(r,"' does not have a default export."));return}const n=e.default;if($o(n)){const i=new n;try{await i.run(t)}catch(o){console.error("The core extension at '".concat(r,"' threw an error.")),console.error(o)}}else console.error("The core extension at '".concat(r,"' does not extend CoreExtension."))}class jo{constructor(){f(this,"root",null);f(this,"stage",null);f(this,"rendererMain",null)}async init(t,e,n){this.stage=new Mo({rootId:ar(),appWidth:e.appWidth,appHeight:e.appHeight,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio,clearColor:e.clearColor,canvas:n,fpsUpdateInterval:e.fpsUpdateInterval,debug:{monitorTextureCache:!1}}),this.rendererMain=t,F(this.stage.root);const i=new Wn(t.resolveNodeDefaults({}),this.rendererMain,this.stage,this.stage.root);this.root=i,i.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,i)),this.onCreateNode(i),e.coreExtensionModule&&await Yo(e.coreExtensionModule,this.stage),this.stage.on("fpsUpdate",(o,s)=>{this.onFpsUpdate(s)})}createNode(t){F(this.rendererMain),F(this.stage);const e=new Wn(t,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}createTextNode(t){F(this.rendererMain),F(this.stage);const e=new Do(t,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}destroyNode(t){t.destroy()}releaseTexture(t){const{stage:e}=this;F(e),e.txManager.removeTextureIdFromCache(t)}getRootNode(){return F(this.root),this.root}onCreateNode(t){throw new Error("Method not implemented.")}onBeforeDestroyNode(t){throw new Error("Method not implemented.")}onFpsUpdate(t){throw new Error("Method not implemented.")}}let ke,lr;function Uo(r={}){const t=new jo;return ke=new co(r,r.rootId||"app",t),lr=ke.createShader.bind(ke),ke}class Wo extends Array{constructor(t){super(),this._parent=t}get selected(){return this[this._parent.selected||0]}get firstChild(){return this[0]}insert(t,e){if(e){const n=this.indexOf(e);this.splice(n,0,t)}else this.push(t);t.parent=this._parent,this._parent._isDirty=!0}remove(t){const e=this.indexOf(t);e>=0&&this.splice(e,1)}}import.meta.env={BASE_URL:"/solid-demo-app/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1};const Me={debug:!1,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100}};function Xo(r,t,...e){}function ut(r){return typeof r=="function"}function Tt(r){return Array.isArray(r)}function Ho(r){return typeof r=="string"}function Go(r){return typeof r=="number"}function Vo(r){return Number.isInteger(r)}function Ko(r,t){for(const e of t)if(e in r)return!0;return!1}function Jo(r){return Tt(r)?r[0]:r}class wr extends Array{constructor(t,e={}){var n=(...i)=>{super(...i)};return Tt(e)?n(...e):Ho(e)?n(e):n(...Object.entries(e).filter(([i,o])=>o).map(([i])=>i)),this.onChange=t,this}has(t){return this.indexOf(t)>=0}is(t){return this.indexOf(t)>=0}add(t){this.push(t),this.onChange()}toggle(t){this.has(t)?this.remove(t):this.add(t)}remove(t){const e=this.indexOf(t);e>=0&&(this.splice(e,1),this.onChange())}}function qo(r){const t=[];for(let m=0;m<r.children.length;m++){const y=r.children[m];if(y.name!=="TextNode"){if(y.name==="text"&&!(y.width||y.height))return!1;t.push(y)}}const e=t.length,i=(r.flexDirection||"row")==="row",o=i?"width":"height",s=i?"height":"width",a=i?"marginLeft":"marginTop",c=i?"marginRight":"marginBottom",u=i?"x":"y",h=i?"y":"x",d=r[o]||0,v=r[s]||0,b=r.gap||0,g=r.justifyContent||"flexStart",x=r.alignItems;let _=0;["center","spaceBetween","spaceEvenly"].includes(g)&&(_=t.reduce((m,y)=>m+(y[o]||0),0));const C=v&&x?m=>{x==="flexStart"?m[h]=0:x==="center"?m[h]=(v-(m[s]||0))/2:x==="flexEnd"&&(m[h]=v-(m[s]||0))}:m=>m;if(g==="flexStart"){let m=0;if(t.forEach(y=>{y[u]=m+(y[a]||0),m+=(y[o]||0)+b+(y[a]||0)+(y[c]||0),C(y)}),r._autosized){const y=m-b;if(y!==r[o])return r[o]=y,!0}}else if(g==="flexEnd"){let m=d;for(let y=e-1;y>=0;y--){const p=t[y];F(p),p[u]=m-(p[o]||0)-(p[c]||0),m-=(p[o]||0)+b+(p[a]||0)+(p[c]||0),C(p)}}else if(g==="center"){let m=(d-(_+b*(e-1)))/2;t.forEach(y=>{y[u]=m,m+=(y[o]||0)+b,C(y)})}else if(g==="spaceBetween"){const m=(d-_)/(e-1);let y=0;t.forEach(p=>{p[u]=y,y+=(p[o]||0)+m,C(p)})}else if(g==="spaceEvenly"){const m=(d-_)/(e+1);let y=m;t.forEach(p=>{p[u]=y,y+=(p[o]||0)+m,C(p)})}return!1}const{animationSettings:Qo}=Me;function Zo(r){const t=[];for(const[e,n]of Object.entries(r))t.push({type:e,props:n});return lr("DynamicShader",{effects:t})}function xt(r=""){return{set(t){Go(t)&&(t={width:t,color:255}),this.effects={...this.effects||{},["border".concat(r)]:t},this["_border".concat(r)]=t},get(){return this["_border".concat(r)]}}}const es=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"],ts=["clipping","contain","fontFamily","src","text","textAlign","texture","maxLines","maxLinesSuffix","textBaseline","textOverflow","verticalAlign","wordWrap"];class Qe extends Object{constructor(t){super(),this.lng=null,this._parent=null,this.name=t,this.rendered=!1,this.autofocus=!1,this._renderProps={x:0,y:0},this.children=new Wo(this);for(const e of es)Object.defineProperty(this,e,{get(){return this["_".concat(e)]||this.lng&&this.lng[e]},set(n){this["_".concat(e)]=Jo(n),this._sendToLightningAnimatable(e,n)}});for(const e of ts)Object.defineProperty(this,e,{get(){return this["_".concat(e)]||this.lng&&this.lng[e]},set(n){this["_".concat(e)]=n,this._sendToLightning(e,n)}});Object.defineProperties(this,{borderRadius:{set(e){this._borderRadius=e,this.effects={...this.effects||{},radius:{radius:e}}},get(){return this._borderRadius}},border:xt(),borderLeft:xt("Left"),borderRight:xt("Right"),borderTop:xt("Top"),borderBottom:xt("Bottom")}),Object.defineProperties(this,{linearGradient:{set(e={}){this._linearGradient=e,this.effects={...this.effects||{},linearGradient:e}},get(){return this._linearGradient}}})}get effects(){return this._effects}set effects(t){this._effects=t,this.shader=Zo(t)}get parent(){return this._parent}set parent(t){var e;this._parent=t,this.rendered&&this.lng&&(this.lng.parent=(e=t==null?void 0:t.lng)!=null?e:null)}get shader(){return this._shader}set shader(t){Tt(t)?this._shader=lr(...t):this._shader=t,this._sendToLightning("shader",this._shader)}_sendToLightningAnimatable(t,e){if(this.rendered&&this.lng){if(Tt(e))return this.createAnimation({[t]:e[0]},e[1]).start();if(this._animate)return this.createAnimation({[t]:e}).start();this.lng[t]=e}else Tt(e)&&(e=e[0]),this._renderProps[t]=e}_sendToLightning(t,e){this.rendered&&this.lng?this.lng[t]=e:this._renderProps[t]=e}createAnimation(t,e){return F(this.lng,"Node must be rendered before animating"),this.lng.animate(t,e||this.animationSettings)}setFocus(){this.rendered?queueMicrotask(()=>Kr(this)):this.autofocus=!0}isTextNode(){return this.name==="text"}_resizeOnTextLoad(){this.lng.once("loaded",(t,e)=>{if(e.type==="text"){const{dimensions:n}=e;this.width=n.width,this.height=n.height,this.parent.updateLayout(this,n)}})}getText(){return this.children.map(t=>t.text).join("")}destroy(){this.lng&&ke.destroyNode(this.lng)}set style(t){for(let e in t)e==="animate"&&(e="_animate"),this[e]||(this[e]=t[e]);this._style=t}get style(){return this._style}get hasChildren(){return this.children.length>0}set states(t){this._states=new wr(this._stateChanged.bind(this),t),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new wr(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||Qo}set animationSettings(t){this._animationSettings=t}updateLayout(t,e){var n;this.hasChildren&&(ut(this.onBeforeLayout)&&this.onBeforeLayout.call(this,t,e),this.display==="flex"&&qo(this)&&((n=this.parent)==null||n.updateLayout()),ut(this.onLayout)&&this.onLayout.call(this,t,e))}_stateChanged(){var e;if(Xo("State Changed: ",this,this.states),this.forwardStates){const n=this.states.slice();this.children.forEach(i=>i.states=n)}const t=((e=Me.stateMapperHook)==null?void 0:e.call(Me,this,this.states))||this.states;if(this._undoStates||this.style&&Ko(this.style,t)){this._undoStates=this._undoStates||{};let n={};for(const[o,s]of Object.entries(this._undoStates))t.includes(o)||(n={...n,...s});const i=t.reduce((o,s)=>{const a=this.style[s];return a&&(o={...o,...a},this._undoStates&&!this._undoStates[s]&&(this._undoStates[s]={},Object.keys(a).forEach(c=>{this._undoStates[s][c]=this[c]}))),o},{});Object.assign(this,{...n,...i})}}render(){const t=this,e=this.parent;e._isDirty&&(e.updateLayout(),e._isDirty=!1),t.updateLayout(),this.states.length&&this._stateChanged();let n=t._renderProps;e.lng&&(n.parent=e.lng),t.isTextNode()?(n={...Me.fontSettings,...n,text:t.getText()},n.contain&&(n.width||(n.width=(e.width||0)-n.x-(n.marginRight||0),t._width=n.width,t._autosized=!0),!n.height&&n.contain==="both"&&(n.height=(e.height||0)-n.y-(n.marginBottom||0),t._height=n.height,t._autosized=!0)),t.lng=ke.createTextNode(n),ut(this.onCreate)&&this.onCreate.call(this,t),ut(t.onLoad)&&t.lng.on("loaded",t.onLoad),(!t.width||!t.height)&&(t._autosized=!0,t._resizeOnTextLoad())):(n.src||n.texture||(isNaN(n.width)&&(n.width=(e.width||0)-n.x,t._width=n.width,t._autosized=!0),isNaN(n.height)&&(n.height=(e.height||0)-n.y,t._height=n.height,t._autosized=!0),n.color||(t._color=n.color=0)),t.lng=ke.createNode(n),t.onFail&&t.lng.on("failed",t.onFail),t.onLoad&&t.lng.on("loaded",t.onLoad),ut(this.onCreate)&&this.onCreate.call(this,t)),t.rendered=!0,t.autofocus&&t.setFocus(),delete this._renderProps}}const N=r=>(()=>{const t=Ye("text");return ft(t,r,!1),t})(),z=r=>(()=>{const t=Ye("node");return ft(t,r,!1),t})();function ni(r){r.name!=="TextNode"&&(F(r instanceof Qe),r.render(),r.children.forEach(t=>ni(t)))}const ns=r=>{const t=Uo(r.options),e=t.init();let n;return _e(()=>{e.then(()=>{F(n),n.lng=t.root,n.children.forEach(ni),ut(r.onFirstRender)&&r.onFirstRender(n)}).catch(console.error)}),(()=>{const i=Ye("canvas"),o=n;return typeof o=="function"?cr(o,i):n=i,Pt(i,()=>r.children),i})()};function rs({createElement:r,createTextNode:t,isTextNode:e,replaceText:n,insertNode:i,removeNode:o,setProperty:s,getParentNode:a,getFirstChild:c,getNextSibling:u}){function h(m,y,p,T){if(p!==void 0&&!T&&(T=[]),typeof y!="function")return d(m,y,T,p);Ee(I=>d(m,y(),I,p),T)}function d(m,y,p,T,I){for(;typeof p=="function";)p=p();if(y===p)return p;const E=typeof y,S=T!==void 0;if(E==="string"||E==="number")if(E==="number"&&(y=y.toString()),S){let w=p[0];w&&e(w)?n(w,y):w=t(y),p=g(m,p,T,w)}else p!==""&&typeof p=="string"?n(c(m),p=y):(g(m,p,T,t(y)),p=y);else if(y==null||E==="boolean")p=g(m,p,T);else{if(E==="function")return Ee(()=>{let w=y();for(;typeof w=="function";)w=w();p=d(m,w,p,T)}),()=>p;if(Array.isArray(y)){const w=[];if(v(w,y,I))return Ee(()=>p=d(m,w,p,T,!0)),()=>p;if(w.length===0){const R=g(m,p,T);if(S)return p=R}else Array.isArray(p)?p.length===0?x(m,w,T):b(m,p,w):p==null||p===""?x(m,w):b(m,S&&p||[c(m)],w);p=w}else{if(Array.isArray(p)){if(S)return p=g(m,p,T,y);g(m,p,null,y)}else p==null||p===""||!c(m)?i(m,y):_(m,y,c(m));p=y}}return p}function v(m,y,p){let T=!1;for(let I=0,E=y.length;I<E;I++){let S=y[I],w;if(!(S==null||S===!0||S===!1))if(Array.isArray(S))T=v(m,S)||T;else if((w=typeof S)=="string"||w==="number")m.push(t(S));else if(w==="function")if(p){for(;typeof S=="function";)S=S();T=v(m,Array.isArray(S)?S:[S])||T}else m.push(S),T=!0;else m.push(S)}return T}function b(m,y,p){let T=p.length,I=y.length,E=T,S=0,w=0,R=u(y[I-1]),A=null;for(;S<I||w<E;){if(y[S]===p[w]){S++,w++;continue}for(;y[I-1]===p[E-1];)I--,E--;if(I===S){const L=E<T?w?u(p[w-1]):p[E-w]:R;for(;w<E;)i(m,p[w++],L)}else if(E===w)for(;S<I;)(!A||!A.has(y[S]))&&o(m,y[S]),S++;else if(y[S]===p[E-1]&&p[w]===y[I-1]){const L=u(y[--I]);i(m,p[w++],u(y[S++])),i(m,p[--E],L),y[I]=p[E]}else{if(!A){A=new Map;let M=w;for(;M<E;)A.set(p[M],M++)}const L=A.get(y[S]);if(L!=null)if(w<L&&L<E){let M=S,U=1,X;for(;++M<I&&M<E&&!((X=A.get(y[M]))==null||X!==L+U);)U++;if(U>L-w){const oe=y[S];for(;w<L;)i(m,p[w++],oe)}else _(m,p[w++],y[S++])}else S++;else o(m,y[S++])}}}function g(m,y,p,T){if(p===void 0){let E;for(;E=c(m);)o(m,E);return T&&i(m,T),""}const I=T||t("");if(y.length){let E=!1;for(let S=y.length-1;S>=0;S--){const w=y[S];if(I!==w){const R=a(w)===m;!E&&!S?R?_(m,I,w):i(m,I,p):R&&o(m,w)}else E=!0}}else i(m,I,p);return[I]}function x(m,y,p){for(let T=0,I=y.length;T<I;T++)i(m,y[T],p)}function _(m,y,p){i(m,y,p),o(m,p)}function C(m,y,p={},T){return y||(y={}),T||Ee(()=>p.children=d(m,y.children,p.children)),Ee(()=>y.ref&&y.ref(m)),Ee(()=>{for(const I in y){if(I==="children"||I==="ref")continue;const E=y[I];E!==p[I]&&(s(m,I,E,p[I]),p[I]=E)}}),p}return{render(m,y){let p;return ht(T=>{p=T,h(y,m())}),p},insert:h,spread(m,y,p){typeof y=="function"?Ee(T=>C(m,y(),T,p)):C(m,y,void 0,p)},createElement:r,createTextNode:t,insertNode:i,setProp(m,y,p,T){return s(m,y,p,T),p},mergeProps:or,effect:Ee,memo:ie,createComponent:Vr,use(m,y,p){return ce(()=>m(y,p))}}}function is(r){const t=rs(r);return t.mergeProps=or,t}const os={createElement(r){const t=new Qe(r);return ke.root&&_e(()=>t.render()),t},createTextNode(r){return{name:"TextNode",text:r,parent:null}},replaceText(r,t){r.text=t;const e=r.parent;F(e),e._autosized&&e._resizeOnTextLoad(),e.text=e.getText()},setProperty(r,t,e=!0){if(t==="animate"){r._animate=e;return}r[t]=e},insertNode(r,t,e){r&&(r.children.insert(t,e),t.name==="TextNode"&&r.isTextNode()&&(r._autosized&&r._resizeOnTextLoad(),r.text=r.getText()))},isTextNode(r){return r.isTextNode()},removeNode(r,t){r.children.remove(t),t instanceof Qe&&t.destroy()},getParentNode(r){var t;return(t=r.parent)!=null?t:void 0},getFirstChild(r){return r.children[0]},getNextSibling(r){if(r.parent){const t=r.parent.children||[],e=t.indexOf(r)+1;if(e<t.length)return t[e]}}},ri=is(os),ss=ri.render,{effect:rc,memo:Rt,createComponent:l,createElement:Ye,createTextNode:ic,insertNode:oc,insert:Pt,spread:ft,setProp:Ft,mergeProps:W,use:cr}=ri;function D(r=""){return Vo(r)?r:typeof r=="string"?r.startsWith("#")?+(r.replace("#","0x")+(r.length===7?"ff":"")):r.startsWith("0x")?Number(r):+("0x"+(r.length===6?r+"ff":r)):0}function as(r){return r*Math.PI/180}const _r="_$DX_DELEGATE";function ls(r,t=window.document){const e=t[_r]||(t[_r]=new Set);for(let n=0,i=r.length;n<i;n++){const o=r[n];e.has(o)||(e.add(o),t.addEventListener(o,cs))}}function cs(r){const t="$$".concat(r.type);let e=r.composedPath&&r.composedPath()[0]||r.target;for(r.target!==e&&Object.defineProperty(r,"target",{configurable:!0,value:e}),Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return e||document}});e;){const n=e[t];if(n&&!e.disabled){const i=e["".concat(t,"Data")];if(i!==void 0?n.call(e,i,r):n.call(e,r),r.cancelBubble)return}e=e._$host||e.parentNode||e.host}}const us=!1;function ds(){let r=new Set;function t(i){return r.add(i),()=>r.delete(i)}let e=!1;function n(i,o){if(e)return!(e=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const a of r)a.listener({...s,from:a.location,retry:c=>{c&&(e=!0),a.navigate(i,o)}});return!s.defaultPrevented}return{subscribe:t,confirm:n}}const hs=/^(?:[a-z0-9]+:)?\/\//i,fs=/^\/+|(\/)\/+$/g;function It(r,t=!1){const e=r.replace(fs,"$1");return e?t||/^[?#]/.test(e)?e:"/"+e:""}function Qt(r,t,e){if(hs.test(t))return;const n=It(r),i=e&&It(e);let o="";return!i||t.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+It(t,!o)}function ps(r,t){if(r==null)throw new Error(t);return r}function gs(r,t){return It(r).replace(/\/*(\*.*)?$/g,"")+It(t)}function ii(r){const t={};return r.searchParams.forEach((e,n)=>{t[n]=e}),t}function ms(r,t,e){const[n,i]=r.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return a=>{const c=a.split("/").filter(Boolean),u=c.length-s;if(u<0||u>0&&i===void 0&&!t)return null;const h={path:s?"":"/",params:{}},d=v=>e===void 0?void 0:e[v];for(let v=0;v<s;v++){const b=o[v],g=c[v],x=b[0]===":",_=x?b.slice(1):b;if(x&&Fn(g,d(_)))h.params[_]=g;else if(x||!Fn(g,b))return null;h.path+="/".concat(g)}if(i){const v=u?c.slice(-u).join("/"):"";if(Fn(v,d(i)))h.params[i]=v;else return null}return h}}function Fn(r,t){const e=n=>n.localeCompare(r,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?e(t):typeof t=="function"?t(r):Array.isArray(t)?t.some(e):t instanceof RegExp?t.test(r):!1}function xs(r){const[t,e]=r.pattern.split("/*",2),n=t.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(e===void 0?0:1))}function oi(r){const t=new Map,e=wn();return new Proxy({},{get(n,i){return t.has(i)||Vi(e,()=>t.set(i,ie(()=>r()[i]))),t.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(r())}})}function si(r){let t=/(\/?\:[^\/]+)\?/.exec(r);if(!t)return[r];let e=r.slice(0,t.index),n=r.slice(t.index+t[0].length);const i=[e,e+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(n);)i.push(e+=t[1]),n=n.slice(t[0].length);return si(n).reduce((o,s)=>[...o,...i.map(a=>a+s)],[])}const ys=100,ai=jr(),Cn=jr(),li=()=>ps(nr(ai),"Make sure your app is wrapped in a <Router />"),vs=()=>nr(Cn)||li().base,pt=()=>li().navigatorFactory(),ur=()=>vs().params;function bs(r,t=""){const{component:e,load:n,children:i,metadata:o}=r,s=!i||Array.isArray(i)&&!i.length,a={key:r,component:e,load:n,metadata:o};return ci(r.path).reduce((c,u)=>{for(const h of si(u)){const d=gs(t,h),v=s?d:d.split("/*",1)[0];c.push({...a,originalPath:h,pattern:v,matcher:ms(v,!s,r.matchFilters)})}return c},[])}function ws(r,t=0){return{routes:r,score:xs(r[r.length-1])*1e4-t,matcher(e){const n=[];for(let i=r.length-1;i>=0;i--){const o=r[i],s=o.matcher(e);if(!s)return null;n.unshift({...s,route:o})}return n}}}function ci(r){return Array.isArray(r)?r:[r]}function ui(r,t="",e=[],n=[]){const i=ci(r);for(let o=0,s=i.length;o<s;o++){const a=i[o];if(a&&typeof a=="object"){a.hasOwnProperty("path")||(a.path="");const c=bs(a,t);for(const u of c){e.push(u);const h=Array.isArray(a.children)&&a.children.length===0;if(a.children&&!h)ui(a.children,u.pattern,e,n);else{const d=ws([...e],n.length);n.push(d)}e.pop()}}}return e.length?n:n.sort((o,s)=>s.score-o.score)}function di(r,t){for(let e=0,n=r.length;e<n;e++){const i=r[e].matcher(t);if(i)return i}return[]}function _s(r,t){const e=new URL("http://sar"),n=ie(c=>{const u=r();try{return new URL(u,e)}catch(h){return console.error("Invalid path ".concat(u)),c}},e,{equals:(c,u)=>c.href===u.href}),i=ie(()=>n().pathname),o=ie(()=>n().search,!0),s=ie(()=>n().hash),a=()=>"";return{get pathname(){return i()},get search(){return o()},get hash(){return s()},get state(){return t()},get key(){return a()},query:oi(Pe(o,()=>ii(n())))}}let $e;function Ss(r,t,e={}){const{signal:[n,i],utils:o={}}=r,s=o.parsePath||(w=>w),a=o.renderPath||(w=>w),c=o.beforeLeave||ds(),u=Qt("",e.base||"");if(u===void 0)throw new Error("".concat(u," is not a valid base path"));u&&!n().value&&i({value:u,replace:!0,scroll:!1});const[h,d]=Y(!1),v=async w=>{d(!0);try{await Ki(w)}finally{d(!1)}},[b,g]=Y(n().value),[x,_]=Y(n().state),C=_s(b,x),m=[],y=Y([]),p={pattern:u,params:{},path:()=>u,outlet:()=>null,resolvePath(w){return Qt(u,w)}};return Ee(()=>{const{value:w,state:R}=n();ce(()=>{w!==b()&&v(()=>{$e="native",g(w),_(R),y[1]([])}).then(()=>{$e=void 0})})}),{base:p,location:C,isRouting:h,renderPath:a,parsePath:s,navigatorFactory:I,beforeLeave:c,preloadRoute:S,submissions:y};function T(w,R,A){ce(()=>{if(typeof R=="number"){R&&(o.go?c.confirm(R,A)&&o.go(R):console.warn("Router integration does not support relative routing"));return}const{replace:L,resolve:M,scroll:U,state:X}={replace:!1,resolve:!0,scroll:!0,...A},oe=M?w.resolvePath(R):Qt("",R);if(oe===void 0)throw new Error("Path '".concat(R,"' is not a routable path"));if(m.length>=ys)throw new Error("Too many redirects");const te=b();if((oe!==te||X!==x())&&!us){if(c.confirm(oe,A)){const pe=m.push({value:te,replace:L,scroll:U,state:x()});v(()=>{$e="navigate",g(oe),_(X),y[1]([])}).then(()=>{m.length===pe&&($e=void 0,E({value:oe,state:X}))})}}})}function I(w){return w=w||nr(Cn)||p,(R,A)=>T(w,R,A)}function E(w){const R=m[0];R&&((w.value!==R.value||w.state!==R.state)&&i({...w,replace:R.replace,scroll:R.scroll}),m.length=0)}function S(w,R){const A=di(t(),w.pathname),L=$e;$e="preload";for(let M in A){const{route:U,params:X}=A[M];U.component&&U.component.preload&&U.component.preload(),R&&U.load&&U.load({params:X,location:{pathname:w.pathname,search:w.search,hash:w.hash,query:ii(w),state:null,key:""},intent:"preload"})}$e=L}}function Cs(r,t,e,n,i){const{base:o,location:s}=r,{pattern:a,component:c,load:u}=n().route,h=ie(()=>n().path);c&&c.preload&&c.preload();const d=u?u({params:i,location:s,intent:$e||"initial"}):void 0;return{parent:t,pattern:a,path:h,params:i,outlet:()=>c?Vr(c,{params:i,location:s,data:d,get children(){return e()}}):e(),resolvePath(b){return Qt(o.path(),b,h())}}}const Ts=r=>t=>{const{base:e}=t,n=rr(()=>t.children),i=ie(()=>ui(t.root?{component:t.root,children:n()}:n(),t.base||"")),o=Ss(r,i,{base:e});return r.create&&r.create(o),l(ai.Provider,{value:o,get children(){return l(Rs,{routerState:o,get branches(){return i()}})}})};function Rs(r){const t=ie(()=>di(r.branches,r.routerState.location.pathname)),e=oi(()=>{const s=t(),a={};for(let c=0;c<s.length;c++)Object.assign(a,s[c].params);return a}),n=[];let i;const o=ie(Pe(t,(s,a,c)=>{let u=a&&s.length===a.length;const h=[];for(let d=0,v=s.length;d<v;d++){const b=a&&a[d],g=s[d];c&&b&&g.route.key===b.route.key?h[d]=c[d]:(u=!1,n[d]&&n[d](),ht(x=>{n[d]=x,h[d]=Cs(r.routerState,h[d-1]||r.routerState.base,Is(()=>o()[d+1]),()=>t()[d],e)}))}return n.splice(s.length).forEach(d=>d()),c&&u?c:(i=h[0],h)}));return l(De,{get when(){return o()&&i},keyed:!0,children:s=>l(Cn.Provider,{value:s,get children(){return s.outlet()}})})}const Is=r=>()=>l(De,{get when(){return r()},keyed:!0,children:t=>l(Cn.Provider,{value:t,get children(){return t.outlet()}})}),ge=r=>{const t=rr(()=>r.children);return or(r,{get children(){return t()}})};function Es([r,t],e,n){return[e?()=>e(r()):r,n?i=>t(n(i)):t]}function ks(r){if(r==="#")return null;try{return document.querySelector(r)}catch(t){return null}}function Ls(r){let t=!1;const e=i=>typeof i=="string"?{value:i}:i,n=Es(Y(e(r.get()),{equals:(i,o)=>i.value===o.value}),void 0,i=>(!t&&r.set(i),i));return r.init&&ze(r.init((i=r.get())=>{t=!0,n[1](e(i)),t=!1})),Ts({signal:n,create:r.create,utils:r.utils})}function As(r,t,e){return r.addEventListener(t,e),()=>r.removeEventListener(t,e)}function Fs(r,t){const e=ks("#".concat(r));e?e.scrollIntoView():t&&window.scrollTo(0,0)}const Ns=new Map;function Ms(r=!0,t=!1,e="/_server"){return n=>{const i=n.base.path(),o=n.navigatorFactory(n.base);let s={};function a(g){return g.namespaceURI==="http://www.w3.org/2000/svg"}function c(g){if(g.defaultPrevented||g.button!==0||g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)return;const x=g.composedPath().find(T=>T instanceof Node&&T.nodeName.toUpperCase()==="A");if(!x||t&&!x.getAttribute("link"))return;const _=a(x),C=_?x.href.baseVal:x.href;if((_?x.target.baseVal:x.target)||!C&&!x.hasAttribute("state"))return;const y=(x.getAttribute("rel")||"").split(/\s+/);if(x.hasAttribute("download")||y&&y.includes("external"))return;const p=_?new URL(C,document.baseURI):new URL(C);if(!(p.origin!==window.location.origin||i&&p.pathname&&!p.pathname.toLowerCase().startsWith(i.toLowerCase())))return[x,p]}function u(g){const x=c(g);if(!x)return;const[_,C]=x,m=n.parsePath(C.pathname+C.search+C.hash),y=_.getAttribute("state");g.preventDefault(),o(m,{resolve:!1,replace:_.hasAttribute("replace"),scroll:!_.hasAttribute("noscroll"),state:y&&JSON.parse(y)})}function h(g){const x=c(g);if(!x)return;const[_,C]=x;s[C.pathname]||n.preloadRoute(C,_.getAttribute("preload")!=="false")}function d(g){const x=c(g);if(!x)return;const[_,C]=x;s[C.pathname]||(s[C.pathname]=setTimeout(()=>{n.preloadRoute(C,_.getAttribute("preload")!=="false"),delete s[C.pathname]},200))}function v(g){const x=c(g);if(!x)return;const[,_]=x;s[_.pathname]&&(clearTimeout(s[_.pathname]),delete s[_.pathname])}function b(g){let x=g.submitter&&g.submitter.hasAttribute("formaction")?g.submitter.formAction:g.target.action;if(!x)return;if(!x.startsWith("action:")){const C=new URL(x);if(x=n.parsePath(C.pathname+C.search),!x.startsWith(e))return}if(g.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const _=Ns.get(x);if(_){g.preventDefault();const C=new FormData(g.target);_.call(n,C)}}ls(["click","submit"]),document.addEventListener("click",u),r&&(document.addEventListener("mouseover",d),document.addEventListener("mouseout",v),document.addEventListener("focusin",h),document.addEventListener("touchstart",h)),document.addEventListener("submit",b),ze(()=>{document.removeEventListener("click",u),r&&(document.removeEventListener("mouseover",d),document.removeEventListener("mouseout",v),document.removeEventListener("focusin",h),document.removeEventListener("touchstart",h)),document.removeEventListener("submit",b)})}}function zs(r){const t=r.replace(/^.*?#/,"");if(!t.startsWith("/")){const[,e="/"]=window.location.hash.split("#",2);return"".concat(e,"#").concat(t)}return t}function Ds(r){return Ls({get:()=>window.location.hash.slice(1),set({value:t,replace:e,scroll:n,state:i}){e?window.history.replaceState(i,"","#"+t):window.location.hash=t;const o=t.indexOf("#"),s=o>=0?t.slice(o+1):"";Fs(s,n)},init:t=>As(window,"hashchange",()=>t()),create:Ms(r.preload,r.explicitLinks,r.actionBase),utils:{go:t=>window.history.go(t),renderPath:t=>"#".concat(t),parsePath:zs}})(r)}var Ps=!!so,Os=Ps?r=>wn()?ze(r):r:ze;function Bs(r,t,e,n){return r.addEventListener(t,e,n),Os(r.removeEventListener.bind(r,t,e,n))}function $s(r,t=wn()){let e=0,n,i;return()=>(e++,ze(()=>{e--,queueMicrotask(()=>{!e&&i&&(i(),i=n=void 0)})}),i||ht(o=>n=r(i=o),t),n)}var Ys=$s(()=>{const[r,t]=Y(null);return Bs(window,"keydown",e=>{t(e),setTimeout(()=>t(null))}),r});function Ut(r){return typeof r=="function"}function Sr(r,t){if(!r)throw new Error(t||"Assertion failed")}let Nn={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Enter:"Enter",Last:"l"};const[ln,js]=Y([]),Us=(r={})=>{const t=Ys();Nn={...Nn,...r};const e=Object.entries(Nn);return _e(Pe(an,(n,i,o=[])=>{var c;let s=n;const a=[];for(;s;)s.states.has("focus")||(s.states.add("focus"),Ut(s.onFocus)&&s.onFocus.call(s,n,i!=null?i:null)),a.push(s),s=(c=s.parent)!=null?c:null;return o.forEach(u=>{a.includes(u)||(u.states.remove("focus"),Ut(u.onBlur)&&u.onBlur.call(u,n,i!=null?i:null))}),js(a),a},{defer:!0})),_e(()=>{const n=t();if(n){const i=e.find(([o,s])=>s===n.key);ce(()=>{const o=ln();for(const s of o){const a=i?i[0]:void 0;if(a){const c=s["on".concat(a)];if(Ut(c)&&c.call(s,n,s)===!0)break}else console.log("Unhandled key event: ".concat(n.key));if(Ut(s.onKeyPress)&&s.onKeyPress.call(s,n,a,s)===!0)break}return!1})}}),ln};function hi(r,t){const e=t();let n,i,o,s;Array.isArray(e)?e.length===2?(n=s=e[0],i=o=e[1]):e.length===3?(n=e[0],i=o=e[1],s=e[2]):[n,o,s,i]=e:n=o=s=i=e,r.onBeforeLayout=(a,c)=>{if(c){r.width=r.children.reduce((d,v)=>d+(v.width||0),0)+i+o;const u=r.children[0];u&&(u.x=i,u.marginLeft=i);let h=0;r.children.forEach(d=>{d.y=(d.y||0)+n,d.marginTop=n,h=Math.max(h,d.height||0)}),r.height=h+n+s}}}function Ws(r=[]){const t=[];let e;for(e=0;e<r.length;e++){const n=r[e];if(typeof n=="string"&&!n.includes("PAUSE-"))t.push(r[e]);else break}return[t.join(",\b ")].concat(r.slice(e))}function Cr(r){return new Promise(t=>{setTimeout(t,r)})}function Xs(r,t,e="en-US"){const n=window.speechSynthesis;return new Promise((i,o)=>{const s=new SpeechSynthesisUtterance(r);s.lang=e,s.onend=()=>{i()},s.onerror=a=>{o(a)},t.push(s),n.speak(s)})}function Kn(r,t,e=!0){const n=window.speechSynthesis,i=Ws(Array.isArray(r)?r:[r]),o=[],s=[];let a=!0;return{series:(async()=>{try{for(;a&&i.length;){const u=await Promise.resolve(i.shift());if(a){if(typeof u=="string"&&u.includes("PAUSE-")){let h=Number(u.split("PAUSE-")[1])*1e3;isNaN(h)&&(h=0),await Cr(h)}else if(typeof u=="string"&&u.length){let d=3;for(;a&&d>0;)try{await Xs(u,s,t),d=0}catch(v){if(v instanceof SpeechSynthesisErrorEvent)if(v.error==="network")d--,console.warn("Speech synthesis network error. Retries left: ".concat(d)),await Cr(500*(3-d));else if(v.error==="canceled"||v.error==="interrupted")d=0;else throw new Error("SpeechSynthesisErrorEvent: ".concat(v.error));else throw v}}else if(typeof u=="function"){const h=Kn(u(),t,!1);o.push(h),await h.series}else if(Array.isArray(u)){const h=Kn(u,t,!1);o.push(h),await h.series}}else break}}finally{a=!1}})(),get active(){return a},append:u=>{i.push(u)},cancel:()=>{a&&(e&&n.cancel(),o.forEach(u=>{u.cancel()}),a=!1)}}}let Wt;function Hs(r,t="en-US"){return Wt&&Wt.cancel(),Wt=Kn(r,t),Wt}var Gs=(r,t)=>{let e;const n=()=>clearTimeout(e);return wn()&&ze(n),Object.assign((...o)=>{e!==void 0&&n(),e=setTimeout(()=>r(...o),t)},{clear:n})};let Jn,Et=[],Ie,qn=!1;const Vs=3e5;function Tr(r,t){const e=Gs(r,t);let n;const i=o=>{n=o,e(o)};return i.flush=()=>{e.clear(),r(n)},i.clear=e.clear,i}function yt(r){return r.id||r.name}function Ks(r=[]){if(!re.onFocusChange||!re.enabled)return;const t=r.every(o=>!o.loading),e=r.filter(o=>!Et.includes(o));if(Jn(),!t&&re.onFocusChange){re.onFocusChange([]);return}Et=r.slice(0);const n=[],i=e.reduce((o,s)=>(s.announce?(o.push([yt(s),"Announce",s.announce]),n.push(s.announce)):s.title?(o.push([yt(s),"Title",s.title]),n.push(s.title)):o.push([yt(s),"No Announce",""]),o),[]);if(e.reverse().reduce((o,s)=>(s.announceContext?(o.push([yt(s),"Context",s.announceContext]),n.push(s.announceContext)):o.push([yt(s),"No Context",""]),o),i),re.debug&&console.table(i),n.length)return re.speak(n.reduce((o,s)=>o.concat(s),[]))}function Js(r){if(!qn)return Ie=Hs(r)}const re={debug:!1,enabled:!0,cancel:function(){Ie&&Ie.cancel()},clearPrevFocus:function(r=0){Et=Et.slice(0,r),Jn()},speak:function(r,{append:t=!1,notification:e=!1}={}){return re.onFocusChange&&re.enabled&&(re.onFocusChange.flush(),t&&Ie&&Ie.active?Ie.append(r):(re.cancel(),Js(r)),e&&(qn=!0,Ie==null||Ie.series.finally(()=>{qn=!1,re.refresh()}).catch(console.error))),Ie},refresh:function(r=0){re.clearPrevFocus(r),re.onFocusChange&&re.onFocusChange(ce(()=>ln()))},setupTimers:function({focusDebounce:r=400,focusChangeTimeout:t=Vs}={}){re.onFocusChange=Tr(Ks,r),Jn=Tr(()=>{Et=[]},t)}},qs=()=>(re.setupTimers(),_e(Pe(ln,re.onFocusChange,{defer:!0})),re);function cn(r){return function(){var o,s;const t=this.children.length,e=this.wrap,n=this.selected;if(r==="right"||r==="down")do if(this.selected=(this.selected||0)%t+1,this.selected>=t){if(!e){this.selected=null;break}this.selected=0}while((o=this.children[this.selected])!=null&&o.skipFocus);else if(r==="left"||r==="up")do if(this.selected=(this.selected||0)%t-1,this.selected<0){if(!e){this.selected=null;break}this.selected=t-1}while((s=this.children[this.selected])!=null&&s.skipFocus);if(this.selected===null)return this.selected=n,!1;const i=this.children[this.selected];if(Sr(i instanceof Qe),this.onSelectedChanged&&this.onSelectedChanged.call(this,this,i,this.selected,n),this.plinko&&n!==null){const a=this.children[n];Sr(a instanceof Qe);const c=a.selected;i.selected=c}return Kr(i),!0}}function V(r){const t=cn("left"),e=cn("right"),n={display:"flex",justifyContent:"flexStart"};return(()=>{const i=Ye("node");return Ft(i,"onLeft",t),Ft(i,"onRight",e),ft(i,W({get selected(){return r.selected||0},get onFocus(){return r.onFocus||(o=>{if(!o||o.selected===null)return;let s=o.children[o.selected];for(;s!=null&&s.skipFocus;)o.selected++,s=o.children[o.selected];s instanceof Qe&&s.setFocus()})},get style(){return r.style||n}},r),!0),Pt(i,()=>r.children),i})()}function Z(r){const t=cn("up"),e=cn("down"),n={display:"flex",flexDirection:"column",justifyContent:"flexStart"};return(()=>{const i=Ye("node");return Ft(i,"onUp",t),Ft(i,"onDown",e),ft(i,W({get onFocus(){return r.onFocus||(o=>{if(!o||o.selected===null)return;let s=o.children[o.selected];for(;s!=null&&s.skipFocus;)o.selected++,s=o.children[o.selected];s instanceof Qe&&s.setFocus()})},get selected(){return r.selected||0},get style(){return r.style||n}},r),!0),Pt(i,()=>r.children),i})()}function Qs(r,t){const e=ke.createTexture("ImageTexture",{src:r});return t.reduce((n,i)=>{const{x:o,y:s,width:a,height:c}=i;return n[i.name]=ke.createTexture("SubTexture",{texture:e,x:o,y:s,width:a,height:c}),n},{})}const[Zs,je]=Y(""),ea={display:"flex",flexDirection:"row",justifyContent:"flexStart"},ta={display:"flex",flexDirection:"column",justifyContent:"flexStart"},na={screenW:1920,screenH:1080,marginX:120,marginY:120,gutterX:24,gutterY:72,focusScale:1.1},ra={primary:"#00315c",focus:"#bdbdbd",container:"#004882"},ia={display1:{fontFamily:"Ubuntu",fontSize:72,lineHeight:88,fontStyle:"600",verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},display2:{fontFamily:"Ubuntu",fontSize:56,lineHeight:72},headline1:{fontFamily:"Ubuntu",fontSize:36,fontStyle:"600",lineHeight:48,verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},headline2:{fontFamily:"Ubuntu",fontSize:32,lineHeight:44},headline3:{fontFamily:"Ubuntu",fontSize:28,lineHeight:40},body1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40},body2:{fontFamily:"Ubuntu",fontSize:28,lineHeight:34},button1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40}},ee={flexRow:ea,flexColumn:ta,layout:na,color:ra,typography:ia};function oa(){let r,t,e=0;const n=1,i={alpha:n,color:4294967295},o={duration:1e3,easing:"ease-in-out"};return _e(Pe(Zs,s=>{if(s.startsWith("#")){r.color=s,r.src="",r.alpha=1,e=1,t.alpha=0;return}else r.color=4294967295;if(e===0){r.src=s,e=1;return}if(e===1){t.src=s,e=2,t.alpha=[n],r.alpha=[0];return}e===2&&(r.src=s,e=1,r.alpha=n,t.alpha=0)},{defer:!0})),l(z,{width:1920,height:1080,zIndex:-5,get children(){return[l(z,{ref(s){const a=r;typeof a=="function"?a(s):r=s},animate:!0,animationSettings:o,style:i}),l(z,{ref(s){const a=t;typeof a=="function"?a(s):t=s},animate:!0,animationSettings:o,style:i,alpha:0}),l(z,{get effects(){return{radialGradient:{colors:[124,124,D(ee.color.container)],stops:[0,.4,.9],height:800,width:1920,pivot:[.8,0]}}}})]}})}const Qn={Column:{...ee.flexColumn,width:320,height:600,y:360,gap:20,zIndex:101,x:[8,{duration:250,easing:"ease-in-out"}],focus:{x:[ee.layout.marginX,{duration:250,easing:"ease-in-out"}]}},Gradient:{zIndex:99,linearGradient:{angle:as(270),stops:[0,.4,.8],colors:[D(ee.color.primary),D(ee.color.primary),D("#00000000")]},alpha:[0],focus:{width:1600,alpha:[1]},width:100,height:1080},NavButton:{zIndex:102,height:70,width:100,borderRadius:8,focus:{color:D(ee.color.container)},active:{width:328,height:70}}},sa="/solid-demo-app/",aa=[{name:"experiment",width:81,height:100,x:0,y:0},{name:"trending",width:100,height:56,x:81,y:0},{name:"tv",width:100,height:68,x:181,y:0},{name:"movie",width:94,height:100,x:282,y:0}];function la(r){const t=Qs(sa+"assets/icons_white.png",aa);return l(z,W(r,{get texture(){return t[r.name]},get width(){return t[r.name].props.width},get height(){return t[r.name].props.height},get x(){return(100-(t[r.name].props.width||0))/2},get y(){return(100-(t[r.name].props.height||0))/2}}))}function Xt(r){return l(z,W(r,{forwardStates:!0,get style(){return Qn.NavButton},get children(){return[l(z,{y:-16,get children(){return l(la,{scale:.5,get name(){return r.icon}})}}),l(N,{get style(){return{...ee.typography.button1,fontSize:38,x:116,y:16,height:50,alpha:0,active:{alpha:1}}},get children(){return r.children}})]}}))}function ca(r){let t;const e=pt();function n(){t.states.add("focus"),this.children.forEach(o=>o.states.add("active")),this.children.selected.setFocus()}function i(){t.states.remove("focus"),this.selected=0,this.children.forEach(o=>o.states.remove("active"))}return[l(Z,W(r,{onFocus:n,onBlur:i,get style(){return Qn.Column},animate:!0,get children(){return[l(Xt,{onEnter:()=>e("/browse/all"),icon:"trending",children:"Trending"}),l(Xt,{icon:"movie",onEnter:()=>e("/browse/movie"),children:"Movies"}),l(Xt,{icon:"tv",onEnter:()=>e("/browse/tv"),children:"TV"}),l(Xt,{icon:"experiment",onEnter:()=>e("/examples"),children:"Examples"})]}})),l(z,{ref(o){const s=t;typeof s=="function"?s(o):t=o},get style(){return Qn.Gradient}})]}const he={Page:{width:1920,height:1080},headlineText:{width:1200,height:240,x:360,y:455,contain:"both",fontSize:66,textAlign:"center"},headlineSubText:{width:960,height:170,x:530,y:655,contain:"both",fontSize:48,textAlign:"center"},itemsContainer:{width:ee.layout.screenW,height:600,y:560,x:0,zIndex:2},Thumbnail:{borderRadius:16,width:185,height:278,scale:1,zIndex:2,focus:{scale:1.1}},FocusRing:{borderRadius:16,width:194,height:286,y:-5,x:-5,zIndex:-1},showHeadline:{x:70,y:20},headlineBlur:{width:1920,height:150,x:0,y:0,zIndex:14,alpha:.9,color:D("#000000")},RowTitle:{height:60,width:300,marginTop:20,fontSize:36,color:D("#f0f0f0"),zIndex:2},Row:{display:"flex",justifyContent:"spaceBetween",height:300},Column:{display:"flex",flexDirection:"column",justifyContent:"flexStart",gap:20,width:ee.layout.screenW-2*ee.layout.marginX,x:ee.layout.marginX+ee.layout.gutterX,y:48,zIndex:2},Rect:{width:250,height:100,y:10,x:300,color:D("#0000ff")},peopleBio:{...ee.typography.body1,contain:"both",width:1500,height:400}},un={width:120,height:40,color:D("#000000"),borderRadius:8,border:{width:2,color:D("#3333ff")},scale:1,focus:{scale:1.1,border:{width:5,color:D("#333333")}}},ua={color:D("#00A699"),height:8,y:2,x:-4,width:un.width+8},da={fontSize:12,y:12,contain:"width",textAlign:"center",color:D("#F6F6F9"),height:un.height,width:un.width},dn={container:un,topBar:ua,text:da},Rr={width:386,height:136,color:D("#715cab"),focus:{color:D("#5a39a2")},disabled:{color:D("#291d43")}},ha={fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:D("#FFFFFF"),height:Rr.height,width:Rr.width,focus:{fontSize:40},disabled:{color:D("#909090")}};function fa(r){return l(z,W(r,{animate:!0,get style(){return he.Thumbnail}}))}function pa(r){return l(z,W(r,{get style(){return he.FocusRing}}))}function hn(r){const[t,e]=io(r,["items"]);return l(V,W(e,{get style(){return he.Row},get children(){return l(Sn,{get each(){return t.items},children:n=>l(fa,n)})}}))}function ga(r){return l(z,W(r,{forwardStates:!0,animate:!0,get style(){return dn.container},get children(){return l(N,{get style(){return dn.text},get children(){return r.children}})}}))}const Mn=typeof window<"u"?window:{};let fi;const ma=r=>{fi=r};let dr;const Zn=[],Ct={};let fn,qe;Mn.__firebolt&&Mn.__firebolt.testHarness&&(qe=Mn.__firebolt.testHarness);function pi(r){console.debug("Sending message to transport: "+r);let t=JSON.parse(r);if(Array.isArray(t)){t.forEach(i=>pi(JSON.stringify(i)));return}let[e,n]=t.method.split(".");qe&&qe.onSend&&qe.onSend(e,n,t.params,t.id),n.match(/^on[A-Z]/)&&(t.params.listen?Ct[t.id]=e.toLowerCase()+"."+n[2].toLowerCase()+n.substr(3):Object.keys(Ct).forEach(i=>{Ct[i]===e.toLowerCase()+"."+n[2].toLowerCase()+n.substr(3)&&delete Ct[i]})),dr?gi(t):Zn.push(t)}function gi(r){let t;try{t=va(r.method,r.params)}catch(e){setTimeout(()=>fn(JSON.stringify({jsonrpc:"2.0",error:{code:-32602,message:"Invalid params (this is a mock error from the mock transport layer)"},id:r.id})))}setTimeout(()=>fn(JSON.stringify({jsonrpc:"2.0",result:t,id:r.id})))}function xa(r){fn=r,qe&&typeof qe.initialize=="function"&&qe.initialize({emit:mi,listen:function(...t){fi(...t)}})}function mi(r,t,e){const n=Object.entries(Ct).find(([i,o])=>o.toLowerCase()===r.toLowerCase()+"."+t.toLowerCase());if(n){let i=JSON.stringify({jsonrpc:"2.0",id:parseInt(n[0]),result:e});fn(i)}}function ya(r={},t){const e=t.split(".");let n=r;for(let i=0;i<e.length;i++)n=(Object.entries(n).find(([o,s])=>o.toLowerCase()===e[i].toLowerCase())||[null,{}])[1];return n}function va(r,t){let e=ya(dr,r);return r.match(/^[a-zA-Z]+\.on[A-Za-z]+$/)&&(e={event:r,listening:!0}),typeof e=="function"?t==null?e():e(t):e}function ba(r){dr=r,Zn.forEach(t=>gi(t)),Zn.length=0}const pn={send:pi,receive:xa,event:mi};function xi(r,t,e){const n=r?Object.values(r).length:0;return n===e&&t===void 0?"getter":n===e&&typeof t=="function"?"subscriber":n===e&&t!==void 0?"setter":null}const zn={};function wa(r,t,e,n,i,o){const s=xi(e,n,i),a=i?"."+Object.keys(e).filter(u=>u!=="value").map(u=>e[u]).join("."):"",c="".concat(r,".").concat(t).concat(a);if(s==="getter")return zn.hasOwnProperty(c)?zn[c]:o;if(s!=="subscriber"){if(s==="setter")return zn[c]=n,pn.event(r,"".concat(t,"Changed"),{value:n}),null}}const B={mock:wa},yi={closedCaptions:{enabled:!0,styles:{fontFamily:"monospaced_sanserif",fontSize:1,fontColor:"#ffffff",fontEdge:"none",fontEdgeColor:"#7F7F7F",fontOpacity:100,backgroundColor:"#000000",backgroundOpacity:100,textAlign:"center",textAlignVertical:"middle",windowColor:"white",windowOpacity:50},preferredLanguages:["eng","spa"]},closedCaptionsSettings:function(r){return B.mock("Accessibility","closedCaptionsSettings",r,void 0,0,{enabled:!0,styles:{fontFamily:"monospaced_sanserif",fontSize:1,fontColor:"#ffffff",fontEdge:"none",fontEdgeColor:"#7F7F7F",fontOpacity:100,backgroundColor:"#000000",backgroundOpacity:100,textAlign:"center",textAlignVertical:"middle",windowColor:"white",windowOpacity:50},preferredLanguages:["eng","spa"]})},voiceGuidance:{enabled:!0,speed:2},voiceGuidanceSettings:function(r){return B.mock("Accessibility","voiceGuidanceSettings",r,void 0,0,{enabled:!0,speed:2})},audioDescriptionSettings:function(r){return B.mock("Accessibility","audioDescriptionSettings",r,void 0,0,{enabled:!0})}},_a={id:function(r){return B.mock("Account","id",r,void 0,0,"123")},uid:function(r){return B.mock("Account","uid",r,void 0,0,"ee6723b8-7ab3-462c-8d93-dbf61227998e")}},Sa={config:{adServerUrl:"https://demo.v.fwmrm.net/ad/p/1",adServerUrlTemplate:"https://demo.v.fwmrm.net/ad/p/1?flag=+sltp+exvt+slcb+emcr+amcb+aeti&prof=12345:caf_allinone_profile &nw=12345&mode=live&vdur=123&caid=a110523018&asnw=372464&csid=gmott_ios_tablet_watch_live_ESPNU&ssnw=372464&vip=198.205.92.1&resp=vmap1&metr=1031&pvrn=12345&vprn=12345&vcid=1X0Ce7L3xRWlTeNhc7br8Q%3D%3D",adNetworkId:"519178",adProfileId:"12345:caf_allinone_profile",adSiteSectionId:"caf_allinone_profile_section",adOptOut:!0,privacyData:"ew0KICAicGR0IjogImdkcDp2MSIsDQogICJ1c19wcml2YWN5IjogIjEtTi0iLA0KICAibG10IjogIjEiIA0KfQ0K",ifaValue:"01234567-89AB-CDEF-GH01-23456789ABCD",ifa:"ewogICJ2YWx1ZSI6ICIwMTIzNDU2Ny04OUFCLUNERUYtR0gwMS0yMzQ1Njc4OUFCQ0QiLAogICJpZmFfdHlwZSI6ICJzc3BpZCIsCiAgImxtdCI6ICIwIgp9Cg==",appName:"FutureToday",appBundleId:"FutureToday.comcast",distributorAppId:"1001",deviceAdAttributes:"ewogICJib0F0dHJpYnV0ZXNGb3JSZXZTaGFyZUlkIjogIjEyMzQiCn0=",coppa:0,authenticationEntity:"60f72475281cfba3852413bd53e957f6"},policy:function(r){return B.mock("Advertising","policy",r,void 0,0,{skipRestriction:"adsUnwatched",limitAdTracking:!1})},advertisingId:{ifa:"01234567-89AB-CDEF-GH01-23456789ABCD",ifa_type:"idfa",lmt:"0"},deviceAttributes:{},appBundleId:"operator.app"},Ca={token:{value:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",expires:"2022-04-23T18:25:43.511Z",type:"platform"},device:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",session:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",root:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"},Ta={supported:!0,available:!0,permitted:!0,granted:!0,info:[{capability:"xrn:firebolt:capability:device:model",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}},{capability:"xrn:firebolt:capability:input:keyboard",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}},{capability:"xrn:firebolt:capability:protocol:bluetoothle",supported:!1,available:!1,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["unsupported"]},{capability:"xrn:firebolt:capability:token:device",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}},{capability:"xrn:firebolt:capability:token:platform",supported:!0,available:!1,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["unavailable"]},{capability:"xrn:firebolt:capability:protocol:moca",supported:!0,available:!1,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["disabled","unavailable"]},{capability:"xrn:firebolt:capability:wifi:scan",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["unpermitted"]},{capability:"xrn:firebolt:capability:localization:postal-code",supported:!0,available:!0,use:{permitted:!0,granted:null},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["ungranted"]},{capability:"xrn:firebolt:capability:localization:postal-code",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["ungranted"]},{capability:"xrn:firebolt:capability:localization:locality",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["grantDenied","ungranted"]}],request:[{capability:"xrn:firebolt:capability:commerce:purchase",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}}]},vi={id:function(r){return B.mock("Device","id",r,void 0,0,"123")},distributor:function(r){return B.mock("Device","distributor",r,void 0,0,"Company")},platform:function(r){return B.mock("Device","platform",r,void 0,0,"WPE")},uid:function(r){return B.mock("Device","uid",r,void 0,0,"ee6723b8-7ab3-462c-8d93-dbf61227998e")},type:function(r){return B.mock("Device","type",r,void 0,0,"STB")},model:function(r){return B.mock("Device","model",r,void 0,0,"xi6")},sku:function(r){return B.mock("Device","sku",r,void 0,0,"AX061AEI")},make:function(r){return B.mock("Device","make",r,void 0,0,"Arris")},version:function(r){return B.mock("Device","version",r,void 0,0,{sdk:{major:0,minor:8,patch:0,readable:"Firebolt JS SDK v0.8.0"},api:{major:0,minor:8,patch:0,readable:"Firebolt API v0.8.0"},firmware:{major:1,minor:2,patch:3,readable:"Device Firmware v1.2.3"},os:{major:0,minor:1,patch:0,readable:"Firebolt OS v0.1.0"},debug:"Non-parsable build info for error logging only."})},hdcp:function(r){return B.mock("Device","hdcp",r,void 0,0,{"hdcp1.4":!0,"hdcp2.2":!0})},hdr:function(r){return B.mock("Device","hdr",r,void 0,0,{hdr10:!0,hdr10Plus:!0,dolbyVision:!0,hlg:!0})},audio:function(r){return B.mock("Device","audio",r,void 0,0,{stereo:!0,"dolbyDigital5.1":!0,"dolbyDigital5.1+":!0,dolbyAtmos:!0})},screenResolution:function(r){return B.mock("Device","screenResolution",r,void 0,0,[1920,1080])},videoResolution:function(r){return B.mock("Device","videoResolution",r,void 0,0,[1920,1080])},name:function(r){return B.mock("Device","name",r,void 0,0,"Living Room")},network:function(r){return B.mock("Device","network",r,void 0,0,{state:"connected",type:"wifi"})}},Ra={policy:function(r){return B.mock("Discovery","policy",r,void 0,0,{enableRecommendations:!0,shareWatchHistory:!0,rememberWatchedPrograms:!0})},entityInfo:!0,purchasedContent:!0,watched:!0,watchNext:!0,entitlements:!0,contentAccess:null,clearContentAccess:null,launch:!0,signIn:!0,signOut:!0},Ia={email:"user@domain.com",password:"abc123",standard:"Living Room"};let nt={state:"inactive",previous:"initializing"},Ir={state:"foreground",previous:"inactive"},Er={state:"unloading",previous:"inactive"};const vt=r=>{pn.event("Lifecycle",r.state,r)},gn=typeof window<"u"?window:{},bt=gn.__firebolt?!!gn.__firebolt.automation:!1,Ea={ready:function(){nt.previous="initializing",setTimeout(()=>vt(nt),bt?1:500),Ir.previous="inactive",setTimeout(()=>vt(Ir),bt?2:1e3)},close:function(r){let t=r.reason;if(t==="remoteButton")nt.previous="foreground",setTimeout(()=>vt(nt),bt?1:500);else if(["userExit","error"].includes(t))nt.previous="foreground",Er.previous="inactive",setTimeout(()=>vt(nt),bt?1:500),setTimeout(()=>vt(Er),bt?2:1e3);else throw"Invalid close reason"},finished:function(){gn.location&&(gn.location.href="about:blank")}},bi={locality:function(r){return B.mock("Localization","locality",r,void 0,0,"Philadelphia")},postalCode:function(r){return B.mock("Localization","postalCode",r,void 0,0,"19103")},countryCode:function(r){return B.mock("Localization","countryCode",r,void 0,0,"US")},language:function(r){return B.mock("Localization","language",r,void 0,0,"en")},preferredAudioLanguages:function(r){return B.mock("Localization","preferredAudioLanguages",r,void 0,0,["spa","eng"])},locale:function(r){return B.mock("Localization","locale",r,void 0,0,"en-US")},latlon:[39.9549,75.1699],additionalInfo:{}},ka={ready:!0,signIn:!0,signOut:!0,startContent:!0,stopContent:!0,page:!0,action:!0,error:!0,mediaLoadStart:!0,mediaPlay:!0,mediaPlaying:!0,mediaPause:!0,mediaWaiting:!0,mediaProgress:!0,mediaSeeking:!0,mediaSeeked:!0,mediaRateChange:!0,mediaRenditionChange:!0,mediaEnded:!0},La={initialization:{lmt:0,us_privacy:"1-Y-",discovery:{navigateTo:{action:"entity",data:{entityId:"abc",entityType:"program",programType:"movie"},context:{source:"voice"}}}}},Aa={approveContentRating:!1,approvePurchase:!1,flags:{userExperience:"1000"}},Fa={protocols:{"dial1.7":!0},device:"device-id",friendlyName:function(r){return B.mock("SecondScreen","friendlyName",r,void 0,0,"Living Room")}},Na={get:"VGhpcyBub3QgYSByZWFsIHRva2VuLgo=",set:null,remove:null,clear:null},Ma={localization:bi,device:vi,accessibility:yi};class za{constructor(){this._callback=null,this._queue=[]}send(t){this._queue.push(t)}receive(t){this._callback=t}flush(t){t.receive(this._callback),this._queue.forEach(e=>t.send(e))}}const Ke={},be={},Da=(r,t)=>{Ke.app=r,Ke.platform={logLevel:"WARN",...t},Ke.user={}},Pa=(r,t)=>{be[r]&&be[r].forEach(e=>e(t))},Oa=(r={},t)=>{const e=t.split(".");for(let n=0;n<e.length;n++)r=r[e[n]]=r[e[n]]!==void 0?r[e[n]]:{};return typeof r=="object"?Object.keys(r).length?r:void 0:r},Dn={get(r,t,e=void 0){const n=Oa(Ke[r],t);return n!==void 0?n:e},has(r,t){return!!this.get(r,t)},set(r,t){Ke.user[r]=t,Pa(r,t)},subscribe(r,t){be[r]=be[r]||[],be[r].push(t)},unsubscribe(r,t){if(t){const e=be[r]&&be[r].findIndex(n=>n===t);e>-1&&be[r].splice(e,1)}else r in be&&(be[r]=[])},clearSubscribers(){for(const r of Object.getOwnPropertyNames(be))delete be[r]},setLogLevel(r){Ke.platform.logLevel=r},getLogLevel(){return Ke.platform.logLevel}},Re=typeof window<"u"?window:{};class mn{constructor(t){this.bridge=t}send(t){this.bridge.JSMessageChanged(t,()=>{})}receive(t){Re.$badger=Re.$badger||{};const e=Re.$badger.callback?Re.$badger.callback.bind(Re.$badger):null,n=Re.$badger.event?Re.$badger.event.bind(Re.$badger):null;Re.$badger.callback=(i,o,s)=>{s.jsonrpc?t(JSON.stringify(s)):e&&e(i,o,s)},Re.$badger.event=(i,o)=>{o.jsonrpc?t(JSON.stringify(o)):n&&n(i,o)}}static isLegacy(t){return mn.isXREProxy(t)||t.send===void 0&&t.JSMessageChanged}static isXREProxy(t){return t.proxyObjectTest!==void 0}}const Ba=100;class $a{constructor(t){this._endpoint=t,this._ws=null,this._connected=!1,this._queue=[],this._callbacks=[]}send(t){this._connect(),this._connected?this._ws.send(t):this._queue.length<Ba&&this._queue.push(t)}receive(t){t&&(this._connect(),this._callbacks.push(t))}_notifyCallbacks(t){for(let e=0;e<this._callbacks.length;e++)setTimeout(()=>this._callbacks[e](t),1)}_connect(){this._ws||(this._ws=new WebSocket(this._endpoint,["jsonrpc"]),this._ws.addEventListener("message",t=>{this._notifyCallbacks(t.data)}),this._ws.addEventListener("error",t=>{}),this._ws.addEventListener("close",t=>{this._ws=null,this._connected=!1}),this._ws.addEventListener("open",t=>{this._connected=!0;for(let e=0;e<this._queue.length;e++)this._ws.send(this._queue[e]);this._queue=[]}))}}function Ya(r,t){if(!t||!t.methods)return r;const{methods:e}=t,n=JSON.parse(JSON.stringify(r));return Object.keys(e).forEach(i=>{const o=e[i],s=o["x-method"],[a,c]=s.split("."),u={};u[o["x-this-param"]]=n,n[i]=(...h)=>{for(var d=0;d<h.length;d++)u[o["x-additional-params"][d]]=h[d];return K.send(a.toLowerCase(),c,u)}}),n}const kr={transform:Ya},ja="com.comcast.BridgeObject_1";let Pn=null;const Ua=r=>r&&typeof r.event=="string"&&typeof r.listening=="boolean",H=typeof window<"u"?window:{};class K{constructor(){this._promises=[],this._transport=null,this._id=1,this._eventEmitters=[],this._eventIds=[],this._queue=new za,this._deprecated={},this.isMock=!1}static addEventEmitter(t){K.get()._eventEmitters.push(t)}static registerDeprecatedMethod(t,e,n){K.get()._deprecated[t.toLowerCase()+"."+e.toLowerCase()]={alternative:n||""}}_endpoint(){return H.__firebolt&&H.__firebolt.endpoint?H.__firebolt.endpoint:null}constructTransportLayer(){let t;const e=this._endpoint();return e&&(e.startsWith("ws://")||e.startsWith("wss://"))?(t=new $a(e),t.receive(this.receiveHandler.bind(this))):typeof H.ServiceManager<"u"&&H.ServiceManager&&H.ServiceManager.version?(t=this._queue,H.ServiceManager.getServiceForJavaScript(ja,n=>{mn.isLegacy(n)?t=new mn(n):t=n,this.setTransportLayer(t)})):(this.isMock=!0,t=pn,t.receive(this.receiveHandler.bind(this))),t}setTransportLayer(t){this._transport=t,this._queue.flush(t)}static send(t,e,n,i){return K.get()._send(t,e,n,i)}static listen(t,e,n,i){return K.get()._sendAndGetId(t,e,n,i)}_send(t,e,n,i){return Array.isArray(t)&&!e&&!n?this._batch(t):this._sendAndGetId(t,e,n,i).promise}_sendAndGetId(t,e,n,i){const{promise:o,json:s,id:a}=this._processRequest(t,e,n,i),c=JSON.stringify(s);return Dn.getLogLevel()==="DEBUG"&&console.debug("Sending message to transport: "+c),this._transport.send(c),{id:a,promise:o}}_batch(t){const e=[],n=[];t.forEach(({module:o,method:s,params:a,transforms:c})=>{const u=this._processRequest(o,s,a,c);e.push({promise:u.promise,id:u.id}),n.push(u.json)});const i=JSON.stringify(n);return Dn.getLogLevel()==="DEBUG"&&console.debug("Sending message to transport: "+i),this._transport.send(i),e}_processRequest(t,e,n,i){const o=this._addPromiseToQueue(t,e,n,i),s=this._createRequestJSON(t,e,n),a={promise:o,json:s,id:this._id};return this._id++,a}_createRequestJSON(t,e,n){return{jsonrpc:"2.0",method:t.toLowerCase()+"."+e,params:n,id:this._id}}_addPromiseToQueue(t,e,n,i){return new Promise((o,s)=>{this._promises[this._id]={},this._promises[this._id].promise=this,this._promises[this._id].resolve=o,this._promises[this._id].reject=s,this._promises[this._id].transforms=i;const a=this._deprecated[t.toLowerCase()+"."+e.toLowerCase()];a&&console.warn("WARNING: ".concat(t,".").concat(e,"() is deprecated. ")+a.alternative),e.match(/^on[A-Z]/)&&(n.listen?this._eventIds.push(this._id):this._eventIds=this._eventIds.filter(c=>c!==this._id))})}static get(){if(H.__firebolt=H.__firebolt||{},H.__firebolt.transport==null&&Pn==null){const t=new K;t.init(),t.isMock?Pn=t:(H.__firebolt=H.__firebolt||{},H.__firebolt.transport=t),H.__firebolt.setTransportLayer=t.setTransportLayer.bind(t)}return H.__firebolt.transport?H.__firebolt.transport:Pn}receiveHandler(t){Dn.getLogLevel()==="DEBUG"&&console.debug("Received message from transport: "+t);const e=JSON.parse(t),n=this._promises[e.id];if(n){if(e.error)n.reject(e.error);else{let i=e.result;n.transforms&&(Array.isArray(e.result)?i=i.map(o=>kr.transform(o,n.transforms)):i=kr.transform(i,n.transforms)),n.resolve(i)}delete this._promises[e.id]}this._eventIds.includes(e.id)&&!Ua(e.result)&&this._eventEmitters.forEach(i=>{i(e.id,e.result)})}init(){Da({},{log:!0}),this._queue.receive(this.receiveHandler.bind(this)),H.__firebolt&&(H.__firebolt.mockTransportLayer===!0?(this.isMock=!0,this.setTransportLayer(pn)):H.__firebolt.getTransportLayer&&this.setTransportLayer(H.__firebolt.getTransportLayer())),this._transport==null&&(this._transport=this.constructTransportLayer())}}H.__firebolt=H.__firebolt||{};H.__firebolt.setTransportLayer=r=>{K.get().setTransportLayer(r)};let Ve=0;const P={internal:{},external:{},get:r=>Object.assign(Object.assign({},P.internal[r]),P.external[r]),set:(r,t,e)=>{P.external[r]=P.external[r]||{},P.external[r][t]=e},setInternal:(r,t,e)=>{P.internal[r]=P.internal[r]||{},P.internal[r][t]=e},find:r=>{let t;return[P.internal,P.external].find(e=>{if(t=Object.keys(e).find(n=>e[n][r]),t)return!0}),t},remove:r=>{[P.internal,P.external].forEach(t=>{Object.keys(t).forEach(e=>{t[e]&&t[e][r]&&(delete t[e][r],Object.values(t[e]).length===0&&delete t[e])})})},removeKey:(r,t=!1)=>{t&&P.internal[r]&&delete P.internal[r],P.external[r]&&delete P.external[r]},keys:()=>Array.from(new Set(Object.keys(P.internal).concat(Object.keys(P.external)))),count:r=>Object.values(P.get(r)).length},xn={},Zt=[],wi={},en={};let Lr=!1;const _i=(r,t)=>{Ar(P.internal[xn[r]],[t]),Ar(P.external[xn[r]],[t])},Ue=(r,t)=>{wi[r.toLowerCase()]=t.concat()},Tn=(r,t,e)=>{en[r.toLowerCase()]=en[r.toLowerCase()]||{},en[r.toLowerCase()][t]=e.concat()},Ar=(r,t)=>{r&&Object.keys(r).forEach(e=>{let n=r[e];Zt.indexOf(parseInt(e))>=0&&(Zt.splice(Zt.indexOf(parseInt(e)),1),delete r[e]),n.apply(null,t)})},Si=function(r,t,e,n,i,o=!1){if(Ha(),typeof e!="function")return Promise.reject("No valid callback function provided.");{if(r==="*")return Promise.reject("No valid module name provided");const s=t==="*",a=s?wi[r]:[t],c=[],u=Object.values(n).length>0,h=Object.keys(n).sort().map(g=>g+"="+JSON.stringify(n[g])).join("&");Ve++,i&&Zt.push(Ve),a.forEach(g=>{const x=r+"."+g+(u?".".concat(h):"");if(Object.values(P.get(x)).length===0){const C=Object.assign({listen:!0},n),{id:m,promise:y}=K.listen(r,"on"+g[0].toUpperCase()+g.substring(1),C);xn[m]=x,c.push(y)}const _=o?P.setInternal:P.set;s?_(x,""+Ve,C=>e(g,C)):_(x,""+Ve,e)});let d,v,b=new Promise((g,x)=>{d=g,v=x});return c.length?Promise.all(c).then(g=>{d(Ve)}).catch(g=>{t==="*"?d(Ve):v(g)}):d(Ve),b}},Ci=function(...r){const t=r.pop(),[e,n,i]=Ti(...r);return[e,n,t,i]},Ti=function(...r){const t=(r.shift()||"*").toLowerCase(),e=r.shift()||"*",n={};for(let i=0;r.length;i++)n[en[t][e][i]]=r.shift();return[t,e,n]},Wa=function(...r){const[t,e,n,i]=Ci(...r);return Si(t,e,n,i,!0)},Ri=function(...r){const[t,e,n,i]=Ci(...r);return Si(t,e,n,i,!1)},Xa=function(...r){if(r&&r.length&&typeof r[0]=="number")return On(r[0]);if(r&&r.length&&typeof r[1]=="number")return On(r[1]);{const[t,e,n]=Ti(...r);return On(t,e,n)}},Ht=(r,t)=>{const[e,n]=r.split(".").slice(0,2),i=Object.assign({listen:!1},t);K.send(e,"on"+n[0].toUpperCase()+n.substr(1),i)},On=function(r=!1,t=!1,e){if(t==="*"&&(t=!1),typeof r=="number"){const n=r.toString(),i=P.find(n);return i?(P.remove(n),P.count(i)===0&&Ht(i),!0):!1}else if(!r&&!t)P.keys().forEach(n=>{P.removeKey(n),Ht(n)});else if(!t)P.keys().forEach(n=>{n.indexOf(r.toLowerCase())===0&&(P.removeKey(n),Ht(n))});else{const n=Object.values(e).length>0,i=Object.keys(e).sort().map(s=>s+"="+JSON.stringify(e[s])).join("&"),o=r+"."+t+(n?".".concat(i):"");P.removeKey(o),Ht(o,e)}},Ha=()=>{Lr||(K.addEventEmitter(_i),ma(Ri),Lr=!0)},Rn={listen:Ri,once:Wa,clear:Xa,broadcast(r,t){_i(Object.entries(xn).find(([e,n])=>n==="app."+r)[0],t)}};function Ga(r,t,e,n=void 0,i,o,s){const a=Object.values(e).length,c=xi(e,n,s);if(c==="getter")return K.send(r,t,e);if(c==="subscriber"){if(i)throw new Error("Cannot subscribe to an immutable property");return Rn.listen(r,t+"Changed",...Object.values(e),n)}else if(c==="setter"){if(i)throw new Error("Cannot set a value to an immutable property");if(o)throw new Error("Cannot set a value to a readonly property");return K.send(r,"set"+t[0].toUpperCase()+t.substring(1),Object.assign({value:n},e))}else throw a<s?new Error("Cannot get a value without all required context parameters."):new Error("Property accessed with unexpected number of parameters.")}const fe={prop:Ga};Ue("Accessibility",["audioDescriptionSettingsChanged","closedCaptionsSettingsChanged","voiceGuidanceSettingsChanged"]);K.registerDeprecatedMethod("Accessibility","closedCaptions","Use Accessibility.closedCaptionsSettings() instead.");K.registerDeprecatedMethod("Accessibility","voiceGuidance","Use Accessibility.voiceGuidanceSettings() instead.");Ue("Advertising",["policyChanged"]);K.registerDeprecatedMethod("Authentication","token","Use Authentication module has individual methods for each token type. instead.");Ue("Capabilities",["available","granted","revoked","unavailable"]);Tn("Capabilities","available",["capability"]);Tn("Capabilities","granted",["role","capability"]);Tn("Capabilities","revoked",["role","capability"]);Tn("Capabilities","unavailable",["capability"]);Ue("Device",["audioChanged","deviceNameChanged","hdcpChanged","hdrChanged","nameChanged","networkChanged","screenResolutionChanged","videoResolutionChanged"]);K.registerDeprecatedMethod("Device","onDeviceNameChanged","Use Device.name() instead.");function Va(){return new Promise((r,t)=>{K.send("device","version").then(e=>{e=e||{},e.sdk=e.sdk||{},e.sdk.major=parseInt("1"),e.sdk.minor=parseInt("0"),e.sdk.patch=parseInt("0"),e.sdk.readable="Firebolt Core SDK 1.0.0",r(e)}).catch(e=>{t(e)})})}function Ka(){const r=arguments[0];return fe.prop("Device","audio",{},r,!1,!0,0)}function Ja(...r){return Rn.clear("Device",...r)}function qa(){const r=arguments[0];return fe.prop("Device","distributor",{},r,!0,!0,0)}function Qa(){const r=arguments[0];return fe.prop("Device","hdcp",{},r,!1,!0,0)}function Za(){const r=arguments[0];return fe.prop("Device","hdr",{},r,!1,!0,0)}function el(){const r=arguments[0];return fe.prop("Device","id",{},r,!0,!0,0)}function tl(...r){return Rn.listen("Device",...r)}function nl(){const r=arguments[0];return fe.prop("Device","make",{},r,!0,!0,0)}function rl(){const r=arguments[0];return fe.prop("Device","model",{},r,!0,!0,0)}function il(){const r=arguments[0];return fe.prop("Device","name",{},r,!1,!0,0)}function ol(){const r=arguments[0];return fe.prop("Device","network",{},r,!1,!0,0)}function sl(...r){return Rn.once("Device",...r)}function al(){const r=arguments[0];return fe.prop("Device","platform",{},r,!0,!0,0)}function ll(){const r=arguments[0];return fe.prop("Device","screenResolution",{},r,!1,!0,0)}function cl(){const r=arguments[0];return fe.prop("Device","sku",{},r,!0,!0,0)}function ul(){const r=arguments[0];return fe.prop("Device","type",{},r,!0,!0,0)}function dl(){const r=arguments[0];return fe.prop("Device","uid",{},r,!0,!0,0)}function hl(){const r=arguments[0];return fe.prop("Device","videoResolution",{},r,!1,!0,0)}const Bn={events:{DEVICE_NAME_CHANGED:"deviceNameChanged",NAME_CHANGED:"nameChanged",HDCP_CHANGED:"hdcpChanged",HDR_CHANGED:"hdrChanged",AUDIO_CHANGED:"audioChanged",SCREEN_RESOLUTION_CHANGED:"screenResolutionChanged",VIDEO_RESOLUTION_CHANGED:"videoResolutionChanged",NETWORK_CHANGED:"networkChanged"},NetworkState:{CONNECTED:"connected",DISCONNECTED:"disconnected"},NetworkType:{WIFI:"wifi",ETHERNET:"ethernet",HYBRID:"hybrid"},AudioProfile:{STEREO:"stereo",DOLBY_DIGITAL_5_1:"dolbyDigital5.1",DOLBY_DIGITAL_7_1:"dolbyDigital7.1",DOLBY_DIGITAL_5_1_PLUS:"dolbyDigital5.1+",DOLBY_DIGITAL_7_1_PLUS:"dolbyDigital7.1+",DOLBY_ATMOS:"dolbyAtmos"},version:Va,audio:Ka,clear:Ja,distributor:qa,hdcp:Qa,hdr:Za,id:el,listen:tl,make:nl,model:rl,name:il,network:ol,once:sl,platform:al,screenResolution:ll,sku:cl,type:ul,uid:dl,videoResolution:hl};Ue("Discovery",["navigateTo","policyChanged"]);K.registerDeprecatedMethod("Discovery","entitlements","Use Discovery.contentAccess() instead.");Ue("Lifecycle",["background","foreground","inactive","suspended","unloading"]);Ue("Localization",["countryCodeChanged","languageChanged","localeChanged","localityChanged","postalCodeChanged","preferredAudioLanguagesChanged"]);K.registerDeprecatedMethod("Localization","language","Use Localization.locale instead.");K.registerDeprecatedMethod("Localization","onLanguageChanged","Use language instead.");Ue("SecondScreen",["closeRequest","friendlyNameChanged","launchRequest"]);ba({Accessibility:yi,Account:_a,Advertising:Sa,Authentication:Ca,Capabilities:Ta,Device:vi,Discovery:Ra,Keyboard:Ia,Lifecycle:Ea,Localization:bi,Metrics:ka,Parameters:La,Profile:Aa,SecondScreen:Fa,SecureStorage:Na,Platform:Ma});const fl=r=>{Us({Menu:"m",Escape:"Escape"});const t=qs();t.enabled=!1;const e=pt();let n,i,o;const[s,a]=Y(""),[c,u]=Y({});_e(Pe(an,d=>{F(d),setTimeout(()=>{d.heroContent?(n.parent=d.parent,n.alpha=1,n.scale=1,n.x=d.x-5,n.y=d.y-5,n.width=d.width+10,n.height=d.height+10,n.createAnimation({scale:1.1}).start()):n.alpha=0},10)},{defer:!0})),_e(()=>{Bn.name().then(d=>a(d)).catch(d=>console.error("Error fetching device name:",d)),Bn.network(d=>u(d)).then(d=>{console.log("Network listener registered with ID:",d),ze(()=>Bn.clear(d))}).catch(d=>console.error("Error listening for network changes:",d))});const h={fontSize:42,color:4143380991};return l(z,{ref(d){const v=window.APP;typeof v=="function"?v(d):window.APP=d},onLast:()=>history.back(),onMenu:()=>e("/"),style:{width:1920,height:1080},onLeft:()=>{if(i.states.has("focus"))return!1;o=an(),i.setFocus()},onRight:()=>i.states.has("focus")&&o.setFocus(),get children(){return[l(oa,{}),l(pa,{get color(){return D(ee.color.focus)},ref(d){const v=n;typeof v=="function"?v(d):n=d}}),Rt(()=>r.children),l(ca,{ref(d){const v=i;typeof v=="function"?v(d):i=d}}),l(z,{get children(){return[l(N,{get children(){return["Device Name: ",Rt(()=>s())]}}),l(N,{style:h,y:90,get children(){return["Network Info: ",Rt(()=>JSON.stringify(c()))]}})]}})]}})},pl="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJmNDc3OGZmYTlmYzcyZTljMWZhN2I4YWZjNzc0NDNmYSIsInN1YiI6IjY0YjYzM2Y5MGJiMDc2MDBjYWZhMzVjYiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Gm7j2OKNUa6u-19ecoLfHUT-54D3IvhREQXS_IsoM5Y",gl="https://api.themoviedb.org/3";let Ii,Ei;const ml="w185",xl={headers:{"Content-Type":"application/json",Authorization:"Bearer "+pl}};function kt(r,t=ml){return Ei+t+r}function yl(r,t={}){return Ii?er(r,t):ki().then(()=>er(r,t))}function er(r,t={}){return fetch(gl+r,{...xl,...t}).then(e=>e.json())}function ki(){return er("/configuration").then(r=>{var t;return Ii=r,Ei=(t=r.images)==null?void 0:t.secure_base_url,r})}const Ze={get:yl,loadConfig:ki};function vl(r,t){return r.length>t?r.substring(0,t-3)+"...":r}function bl(r,t=7){let e=[];for(let n=0,i=r.length;n<i;n+=t)e.push(r.slice(n,n+t));return e}function Nt(r=[]){return r.map(t=>({src:kt(t.poster_path||t.profile_path),tileSrc:kt(t.backdrop_path||t.profile_path,"w300"),backdrop:kt(t.backdrop_path,"w1280"),href:"/entity/".concat(t.media_type||"people","/").concat(t.id),shortTitle:vl(t.title||t.name,30),title:t.title||t.name,data:t,entityInfo:{type:t.media_type||"people",id:t.id},heroContent:{title:t.title||t.name,description:t.overview}}))}let $n=new Map;const Gt=new Map;function wl(r){return t=>{const e="/trending/".concat(r,"/week?page=").concat(t);if($n.has(e))return $n.get(e);let n=Ze.get(e).then(i=>{let o=i.results.filter(c=>!c.adult),s=(Gt.has(r)?Gt.get(r):[]).concat(Nt(o)),a=bl(s);return a[a.length-1].length<7?Gt.set(r,a.pop()):Gt.delete(r),a});return $n.set(e,n),n}}function _l(r){const[t,e]=Y([]),[n,i]=Y(1),[o,s]=Y(!1),[a]=Je(n,r);return Yn(()=>{const c=a();c&&Gi(()=>{c.length===0&&s(!0),e(u=>[...u,...c])})}),{pages:t,page:n,setPage:i,setPages:e,end:o,setEnd:s}}const In=1100,Sl={...ee.typography.display2,width:In,height:58,contain:"both"},Cl=r=>l(N,W(r,{style:Sl,get children(){return r.children}})),Tl={...ee.typography.body1,width:In,height:72,contain:"both"},Rl={fontSize:20,lineHeight:20},Il=r=>l(N,W(r,{style:Tl,get children(){return r.children}}));function El(r){return[l(De,{get when(){return(r==null?void 0:r.rtCrit)&&(r==null?void 0:r.rtCrit)!=="0"},get children(){return[l(z,{src:"https://upload.wikimedia.org/wikipedia/commons/b/b6/Tomato-Torrent-Icon.png",title:"Rotten Tomatoes Rating",style:{width:30,height:30,marginRight:-6}}),l(N,{style:tr,get children(){return r.rtCrit+"%"}})]}}),l(De,{get when(){return(r==null?void 0:r.rtFan)&&(r==null?void 0:r.rtFan)!=="0"},get children(){return[l(z,{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Rotten_Tomatoes_positive_audience.svg/80px-Rotten_Tomatoes_positive_audience.svg.png",title:"Rotten Tomatoes Rating",style:{width:24,height:30,marginRight:-6}}),l(N,{style:tr,get children(){return r.rtFan+"%"}})]}})]}const kl=r=>(()=>{const t=Ye("node");return cr(hi,t,()=>[8,15,13,15]),ft(t,W(r,{style:{color:"0x00000099",borderRadius:8,border:{width:3,color:"0xffffffff"}}}),!0),Pt(t,l(N,{style:Rl,get children(){return r.children}})),t})(),tr=ee.typography.body2,Ll=r=>l(z,{get style(){return{...ee.flexRow,gap:12,width:In,height:48}},get children(){return[l(N,{style:tr,get children(){return r.metaText}}),l(Sn,{get each(){return r.badges},children:t=>l(kl,{y:-5,children:t})}),Rt(()=>El(r.reviews))]}}),Li=r=>l(z,W(r,{get style(){return{...ee.flexColumn,width:In,height:160,gap:16}},get children(){return[l(Cl,{get children(){return r.title}}),l(Il,{get children(){return r.description}}),l(Ll,{get metaText(){return r.metaText},get badges(){return r.badges},get reviews(){return r.reviews}})]}}));function Al(r){const t=Math.floor(r/60),e=r%60;return t+"h "+(e<10?"0":"")+e+"m"}function Fr(r){return r.split("-")[0]}function Fl({type:r,id:t}){return Ze.get("/".concat(r,"/").concat(t,"/recommendations")).then(({results:e})=>e.length?Nt(e.slice(0,7)):Ze.get("/trending/".concat(r,"/week?page=1")).then(({results:n})=>Nt(n.slice(0,7))))}function Nl({type:r,id:t}){return Ze.get("/".concat(r,"/").concat(t,"/credits")).then(({cast:e})=>Nt(e.slice(0,7)))}function Ai({type:r,id:t}){let e=r==="movie"?{rtCrit:86,rtFan:92}:{};return Ze.get("/".concat(r,"/").concat(t)).then(n=>({backgroundImage:kt(n.backdrop_path,"original"),heroContent:{title:n.title||n.name,description:n.overview,badges:["HD"],metaText:r==="movie"?Al(n.runtime)+" - "+n.release_date:"".concat(Fr(n.first_air_date)," - ").concat(Fr(n.last_air_date)),reviews:e},...n}))}const Nr=()=>{const r=ur(),[t,e]=Y(0),[n,i]=Y();Je(n,Ai);const[o,s]=Y({}),a=pt(),c=Yr(()=>0),u=ie(()=>_l(wl(r.filter||"all")));_e(Pe(an,v=>{v.backdrop&&je(v.backdrop),v.heroContent&&s(v.heroContent)},{defer:!0}));function h(){var b;(b=this.children.selected)==null||b.setFocus(),e((this.y||0)*-1+24);let v=u().pages().length;(v===0||this.parent.selected&&this.parent.selected>=v-2)&&u().setPage(g=>g+1)}function d(){let v=this.children.selected;F(v&&v.href),a(v.href)}return l(De,{get when(){return u().pages().length},get children(){return[l(Li,W({y:360,x:150},o)),l(z,{clipping:!0,get style(){return he.itemsContainer},get children(){return l(Z,{plinko:!0,announce:"All Trending - Week",animate:!0,get y(){return t()},get style(){return he.Column},get children(){return l(Sn,{get each(){return u().pages()},children:(v,b)=>l(hn,{get autofocus(){return c(b())},items:v,onFocus:h,onEnter:d})})}})}})]}})},Ml=()=>{const r=pt(),t=Yr(()=>0);function e(){let c=this.children.selected;F(c&&c.id),r("/"+c.id)}const n=[{title:"Flex Row",id:"flex",description:"Flex Row Implementation"},{title:"Flex Column",id:"flexcolumn",description:"Flex Column Implementation"},{title:"Flex Row Vertical Align",id:"flexsize",description:"Flex Row Vertical Align Implementation"},{title:"Flex Column Vertical Align",id:"flexcolumnsize",description:"Flex Column Vertical Align Implementation"},{title:"Buttons",id:"buttons",description:"Demo a few buttons"},{title:"Text",id:"text",description:"Text layout with flexbox"}];function i(c){const u={width:370,height:320,borderRadius:6,scale:1,color:405488895,focus:{scale:1.1,color:4294967295}},[h,d]=Y(4294967295);return l(z,W(c,{onFocus:()=>d(255),onBlur:()=>d(4294967295),animate:!0,style:u,get children(){return l(z,{x:30,get children(){return[l(N,{y:30,fontSize:84,get color(){return h()},get children(){return c.index}}),l(N,{y:140,fontSize:42,width:340,height:42,contain:"both",get color(){return h()},get children(){return c.title}}),l(N,{y:200,fontSize:28,width:330,contain:"width",get color(){return h()},get children(){return c.description}})]}})}}))}const[o,s]=Y(140);function a(c){s(c.selected*-400+140)}return l(z,{colorTop:1147903743,colorBottom:743406847,get children(){return[l(z,{x:120,get children(){return[l(z,{src:"/assets/solidjs.png",width:101,height:90,y:40}),l(N,{fontSize:90,x:110,y:40,children:"Examples"}),l(z,{y:140,height:1,width:1800,color:3906468351})]}}),l(V,{onSelectedChanged:a,onEnter:e,animationSettings:{delay:20,duration:300},animate:!0,get x(){return o()},y:300,width:4400,get style(){return he.Row},justifyContent:"flexStart",gap:40,get children(){return l(Sn,{each:n,children:(c,u)=>l(i,W({get autofocus(){return t(u())},get index(){return u()}},c))})}})]}})},zl=()=>{const r={width:900,height:500,y:350,x:150,gap:25,display:"flex",flexDirection:"column",justifyContent:"flexStart",color:D("00000000")},t={width:900,height:36,gap:6,display:"flex",flexDirection:"row",justifyContent:"flexStart",color:D("00000000")},e={fontSize:42},n={width:r.width,fontSize:26,contain:"width"},i={fontSize:26};return zt(()=>{je("0x000000ff")}),l(z,{autofocus:!0,style:r,get children(){return[l(N,{style:e,children:"Title of the Page"}),l(N,{style:n,children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer vel tempor tellus. Sed eu leo purus. Vestibulum sollicitudin eget tellus a varius. Phasellus est turpis, volutpat sed blandit sit amet, rutrum sit amet mauris. In dignissim elit orci, a sollicitudin ipsum faucibus et. Quisque vel quam rutrum, faucibus augue sed, scelerisque nunc."}),l(z,{style:t,get children(){return[l(N,{style:i,children:"Subline Text"}),l(z,{width:28,height:28,src:"/assets/rt-popcorn.png"}),l(N,{style:i,children:"More Text"})]}})]}})},Dl=()=>{function r(i,o){this.states.toggle("disabled")}const t={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:D("00000000"),gap:26,y:400};function e(i){return l(z,W(i,{forwardStates:!0,animate:!0,get style(){return dn.container},get children(){return l(N,{get style(){return dn.text},get children(){return i.children}})}}))}const n=i=>(()=>{const o=Ye("node");return cr(hi,o,()=>[10,15]),ft(o,W(i,{get style(){return{color:D("#000000be"),borderRadius:8,border:{width:2,color:D("#ffffff")}}}}),!0),Pt(o,l(N,{style:{fontSize:20},get children(){return i.children}})),o})();return[l(V,{x:100,y:200,gap:5,style:t,get children(){return[l(n,{children:"HD"}),l(n,{children:"PG13"}),l(n,{children:"NC17"}),l(N,{fontSize:30,children:"I like bananas"}),l(n,{children:"DOLBY"})]}}),l(V,{x:100,gap:40,style:t,get children(){return[l(e,{autofocus:!0,onEnter:r,children:"TV Shows"}),l(e,{states:{active:!0,disabled:!1},children:"Movies"}),l(e,{states:"active",children:"Sports"}),l(e,{states:"disabled",children:"News"})]}})]},Pl=()=>{const r={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:D("#4dabf5")},t={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function e(a){return l(z,W(a,{style:{width:200,height:100,y:5,color:392801023}}))}const[n,i]=Y(50);function o(){var a;(a=this.children.selected)==null||a.setFocus(),i(150+(this.y||0)*-1)}zt(()=>{je("#333333")});const s=50;return l(Z,{x:160,get y(){return n()},animate:!0,gap:30,height:850,get width(){return r.width},get style(){return he.Column},get children(){return[l(N,{style:t,children:"Flex Start"}),l(V,{gap:s,style:r,onFocus:o,get children(){return[l(e,{autofocus:!0}),l(e,{}),l(e,{}),l(e,{}),l(e,{})]}}),l(N,{style:t,children:"Flex Start - Margin Left"}),l(V,{gap:s,style:r,onFocus:o,get children(){return[l(e,{marginLeft:100}),l(e,{}),l(e,{marginLeft:100}),l(e,{}),l(e,{})]}}),l(N,{style:t,children:"Flex End"}),l(V,{gap:s,justifyContent:"flexEnd",style:r,onFocus:o,get children(){return[l(e,{}),l(e,{}),l(e,{}),l(e,{}),l(e,{})]}}),l(N,{style:t,children:"Flex End - Margin Right"}),l(V,{gap:s,justifyContent:"flexEnd",style:r,onFocus:o,get children(){return[l(e,{}),l(e,{marginRight:100}),l(e,{}),l(e,{}),l(e,{marginRight:100})]}}),l(N,{style:t,children:"Center - No Margin Support"}),l(V,{gap:s,justifyContent:"center",style:r,onFocus:o,get children(){return[l(e,{}),l(e,{}),l(e,{}),l(e,{}),l(e,{})]}}),l(N,{style:t,children:"Space Between - No Margin Support"}),l(V,{gap:s,justifyContent:"spaceBetween",style:r,onFocus:o,get children(){return[l(e,{}),l(e,{}),l(e,{}),l(e,{}),l(e,{})]}}),l(N,{style:t,children:"Space Evenly - No Margin Support"}),l(V,{gap:s,justifyContent:"spaceEvenly",style:r,onFocus:o,get children(){return[l(e,{}),l(e,{}),l(e,{}),l(e,{}),l(e,{})]}})]}})},Ol=()=>{const r={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:D("#4dabf5")},t={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function e(c){return l(z,W(c,{style:{width:200,height:100,y:5,color:392801023}}))}function n(){return Math.floor(Math.random()*91)+10}const[i,o]=Y(50);function s(){var c;(c=this.children.selected)==null||c.setFocus(),o(150+(this.y||0)*-1)}zt(()=>{je("#333333")});const a=50;return l(Z,{x:160,get y(){return i()},animate:!0,gap:30,height:850,get width(){return r.width},get style(){return he.Column},get children(){return[l(N,{style:t,children:"Flex Start - AlignItems: center"}),l(V,{alignItems:"center",gap:a,style:r,onFocus:s,get children(){return[l(e,{autofocus:!0,get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}})]}}),l(N,{style:t,children:"Flex Start - Margin Left - AlignItems: flexStart"}),l(V,{gap:a,alignItems:"flexStart",style:r,onFocus:s,get children(){return[l(e,{marginLeft:100,get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{marginLeft:100,get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}})]}}),l(N,{style:t,children:"Flex End - AlignItems: flexEnd"}),l(V,{gap:a,justifyContent:"flexEnd",alignItems:"flexEnd",style:r,onFocus:s,get children(){return[l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}})]}}),l(N,{style:t,children:"Flex End - Margin Right"}),l(V,{gap:a,justifyContent:"flexEnd",style:r,onFocus:s,get children(){return[l(e,{get height(){return n()}}),l(e,{marginRight:100,get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{marginRight:100,get height(){return n()}})]}}),l(N,{style:t,children:"Center - No Margin Support"}),l(V,{gap:a,justifyContent:"center",style:r,onFocus:s,get children(){return[l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}})]}}),l(N,{style:t,children:"Space Between - No Margin Support"}),l(V,{gap:a,justifyContent:"spaceBetween",style:r,onFocus:s,get children(){return[l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}})]}}),l(N,{style:t,children:"Space Evenly - No Margin Support"}),l(V,{gap:a,justifyContent:"spaceEvenly",style:r,onFocus:s,get children(){return[l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}}),l(e,{get height(){return n()}})]}})]}})},Bl=()=>{const r={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:D("00000000")},t={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:D("#4dabf5"),height:850,width:80},e={fontSize:44,y:20,x:150};function n(u){const h={width:i(),height:80,x:5,color:D("#1769aa")};return l(z,W(u,{style:h}))}function i(){return Math.floor(Math.random()*61)+10}const[o,s]=Y(50);function a(){var u;(u=this.children.selected)==null||u.setFocus(),s(150+(this.y||0)*-1)}zt(()=>{je("#333333")});const c=50;return[l(N,{style:e,children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),l(V,{gap:c,style:r,onFocus:a,get children(){return[l(Z,{gap:30,style:t,alignItems:"center",get children(){return[l(n,{autofocus:!0}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:c,style:t,onFocus:a,alignItems:"flexStart",get children(){return[l(n,{marginTop:100}),l(n,{}),l(n,{marginTop:100}),l(n,{}),l(n,{})]}}),l(Z,{gap:c,alignItems:"flexEnd",justifyContent:"flexEnd",style:t,onFocus:a,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:c,justifyContent:"flexEnd",style:t,onFocus:a,get children(){return[l(n,{}),l(n,{marginBottom:100}),l(n,{}),l(n,{}),l(n,{marginBottom:100})]}}),l(Z,{gap:c,justifyContent:"center",style:t,onFocus:a,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:c,justifyContent:"spaceBetween",style:t,onFocus:a,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:c,justifyContent:"spaceEvenly",style:t,onFocus:a,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}})]}})]},$l=()=>{const r={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:D("00000000")},t={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:D("#4dabf5"),height:850,width:60},e={fontSize:44,y:20,x:150};function n(c){const u={width:50,height:80,x:5,color:D("#1769aa")};return l(z,W(c,{style:u}))}const[i,o]=Y(50);function s(){var c;(c=this.children.selected)==null||c.setFocus(),o(150+(this.y||0)*-1)}zt(()=>{je("#333333")});const a=50;return[l(N,{style:e,children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),l(V,{gap:a,style:r,onFocus:s,get children(){return[l(Z,{gap:30,style:t,get children(){return[l(n,{autofocus:!0}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:a,style:t,onFocus:s,get children(){return[l(n,{marginTop:100}),l(n,{}),l(n,{marginTop:100}),l(n,{}),l(n,{})]}}),l(Z,{gap:a,justifyContent:"flexEnd",style:t,onFocus:s,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:a,justifyContent:"flexEnd",style:t,onFocus:s,get children(){return[l(n,{}),l(n,{marginBottom:100}),l(n,{}),l(n,{}),l(n,{marginBottom:100})]}}),l(Z,{gap:a,justifyContent:"center",style:t,onFocus:s,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:a,justifyContent:"spaceBetween",style:t,onFocus:s,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}}),l(Z,{gap:a,justifyContent:"spaceEvenly",style:t,onFocus:s,get children(){return[l(n,{}),l(n,{}),l(n,{}),l(n,{}),l(n,{})]}})]}})]},Yl=()=>{function r(o,s){this.states.toggle("disabled")}const t={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:D("00000000"),gap:26,y:400,x:100},e={width:386,height:136,color:"0x715cabff",focus:{color:"0x5a39a2ff"},disabled:{color:"0x291d43ff"}},n=["RoundedRectangle",{radius:65}];function i(o){return l(z,W(o,{forwardStates:!0,animate:!0,style:e,shader:n,get children(){return l(N,{style:ha,get children(){return o.children}})}}))}return l(V,{style:t,get children(){return[l(i,{autofocus:!0,onEnter:r,children:"Focused"}),l(i,{states:{active:!0,disabled:!1},children:"Normal"}),l(i,{states:"disabled",children:"Disabled"})]}})},jl="https://storage.googleapis.com/shaka-demo-assets/angel-one/dash.mpd";function Ul(){shaka.polyfill.installAll(),shaka.Player.isBrowserSupported()?Wl():console.error("Browser not supported!")}async function Wl(){const r=document.getElementById("video"),t=new shaka.Player;await t.attach(r),window.player=t,t.addEventListener("error",Xl);try{await t.load(jl),console.log("The video has now been loaded!")}catch(e){Fi(e)}}function Xl(r){Fi(r.detail)}function Fi(r){console.error("Error code",r.code,"object",r)}function Hl(){const r=document.getElementById("video");r.hidden=!1,r.play()}function Gl(){const r=document.getElementById("video");r.hidden=!0,r.pause()}document.addEventListener("DOMContentLoaded",Ul);const Vl=()=>{const r=ur(),t=pt(),[e]=Je(()=>({...r}),Ai),[n]=Je(()=>({...r}),Nl),[i]=Je(()=>({...r}),Fl),[o,s]=Y(0);_e(Pe(e,x=>{je(x.backgroundImage)},{defer:!0}));const a=600,c={color:D("#000000"),alpha:0,width:1900,height:890,x:10,y:a,borderRadius:30};function u(){var x;(x=this.children.selected)==null||x.setFocus(),v.y=a,b.y=a,b.alpha=0}function h(){var x;(x=this.children.selected)==null||x.setFocus(),v.y=200,b.y=160,b.alpha=.9}function d(){let x=this.children.selected;F(x&&x.href),t(x.href)}let v,b,g;return l(De,{get when(){return e()},keyed:!0,get children(){return[l(z,{onUp:()=>g.setFocus(),onEscape:()=>{Gl(),s(0)},get children(){return[l(Li,W({y:360,x:150},()=>e().heroContent)),l(ga,{autofocus:!0,ref(x){const _=g;typeof _=="function"?_(x):g=x},y:560,x:150,onDown:()=>v.setFocus(),onEnter:()=>{Hl(),s(.9)},children:"Watch Trailer"}),l(Z,{animate:!0,ref(x){const _=v;typeof _=="function"?_(x):v=x},y:a,x:140,get style(){return he.Column},zIndex:5,get children(){return l(De,{get when(){return Rt(()=>!!i())()&&n()},get children(){return[l(N,{skipFocus:!0,get style(){return he.RowTitle},children:"Recommendations"}),l(hn,{onFocus:u,onEnter:d,get items(){return i()}}),l(N,{skipFocus:!0,get style(){return he.RowTitle},children:"Cast and Crew"}),l(hn,{onFocus:h,onEnter:d,get items(){return n()}})]}})}}),l(z,{ref(x){const _=b;typeof _=="function"?_(x):b=x},animate:!0,style:c})]}}),l(z,{get alpha(){return o()},get color(){return D("#000000")},zIndex:200})]}})};function Kl({id:r}){return Ze.get("/person/".concat(r,"/combined_credits")).then(({cast:t})=>Nt(t.slice(0,7)))}function Jl({id:r}){return Ze.get("/person/".concat(r)).then(t=>({backgroundImage:kt(t.profile_path,"original"),heroContent:{title:t.title||t.name,description:t.biography},...t}))}const ql=()=>{const r=ur(),t=pt(),[e]=Je(()=>({...r}),Jl),[n]=Je(()=>({...r}),Kl);_e(Pe(e,s=>{je(s.backgroundImage)},{defer:!0}));const i={color:D("#000000"),alpha:.8,width:1540,height:440,x:130,y:180,borderRadius:30};function o(){let s=this.children.selected;F(s&&s.href),t(s.href)}return l(De,{get when(){return e()},keyed:!0,get children(){return[l(z,{x:150,y:200,get style(){return he.Column},zIndex:3,get children(){return[l(N,{get style(){return ee.typography.display2},get children(){return e().name}}),l(N,{get style(){return he.peopleBio},get children(){return e().biography}})]}}),l(z,{style:i}),l(Z,{y:670,x:140,get style(){return he.Column},get children(){return l(De,{get when(){return n()},get children(){return[l(N,{skipFocus:!0,get style(){return he.RowTitle},children:"Credits"}),l(hn,{autofocus:!0,onEnter:o,get items(){return n()}})]}})}})]}})},Ql=()=>(()=>{const r=Ye("node");return Ft(r,"style",{width:1920,height:1080,color:868483072}),r})(),Zl=new URL("AppCoreExtensions-2d11dd42.js",import.meta.url).href;Me.debug=!1;Me.fontSettings.fontFamily="Ubuntu";Me.fontSettings.color=D("#ffffff");Me.fontSettings.fontSize=100;ss(()=>l(ns,{options:{coreExtensionModule:Zl,threadXCoreWorkerUrl:void 0},get children(){return l(Ds,{root:fl,get children(){return[l(ge,{path:"",component:Nr}),l(ge,{path:"examples",component:Ml}),l(ge,{path:"browse/:filter",component:Nr}),l(ge,{path:"text",component:zl}),l(ge,{path:"buttons",component:Dl}),l(ge,{path:"flex",component:Pl}),l(ge,{path:"flexsize",component:Ol}),l(ge,{path:"flexcolumnsize",component:Bl}),l(ge,{path:"flexcolumn",component:$l}),l(ge,{path:"buttonsmaterial",component:Yl}),l(ge,{path:"entity/people/:id",component:ql}),l(ge,{path:"entity/:type/:id",component:Vl}),l(ge,{path:"*all",component:Ql})]}})}}));export{tc as __vite_legacy_guard};
//# sourceMappingURL=index-d0072a38.js.map
